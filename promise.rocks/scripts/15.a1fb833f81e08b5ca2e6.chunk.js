(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{634:function(t,e,a){"use strict";a.r(e);var s=a(0),l=a.n(s),r=a(712);const i={fields:{name:{label:"名称",tooltip:"名称名称<span style='color:crimson'>名称名称</span>",format:(t,e,a)=>['<span style="color:#',Math.floor(16777215*Math.random()).toString(16),'">',t,"</span>"].join("")},age:{label:"年龄",sortable:!0},height:{label:"体重",sortable:!0}},tabs:[{label:"tab1",fields:["name","age","height"]},{label:"tab2",fields:["name","height"]}],pageList:[5,7]};e.default=class extends l.a.Component{render(){return l.a.createElement(r.a,{data:function(t){const e=[];for(let a=t=t||~~(100*Math.random());a>0;a--)e.push({name:"id_"+Math.random(),age:~~(100*Math.random()),height:(100*Math.random()).toFixed(2)});return{total:t,rows:e}}(15),table:i,containerClass:"naked container"})}}},701:function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return r});var s=a(0),l=a.n(s);function r(t,e,a){return t.map((t,s)=>l.a.createElement("tr",{key:s},e.map((e,s)=>{var r=t["_"+e];if(null==r){r=t[e];var i=a[e].format;i&&(r=i(r,e,t)),t["_"+e]=r||""}return l.a.createElement("td",{key:s,dangerouslySetInnerHTML:{__html:r}})})))}},712:function(t,e,a){"use strict";var s=a(0),l=a.n(s);var r=class extends l.a.Component{shouldComponentUpdate(t){return this.props.selectedTab!==t.selectedTab}render(){return l.a.createElement("ul",{className:this.props.tabClass},this.props.tabNames.map(function(t,e){var a={key:e};return this.props.selectedTab===e?a.className="active":a.onClick=this.props.setTab.bind(this,e),l.a.createElement("li",a,l.a.createElement("a",{href:"javascript:void(0);"},t))},this))}};var i=class extends l.a.Component{shouldComponentUpdate(t){return this.props.selectedTab!==t.selectedTab||this.props.order!==t.order||this.props.fields.length!==t.fields.length}componentDidMount(){this.initTooltip()}initTooltip(){window.$&&$.fn.tipsy&&$(this.getDOMNode()).tipsy({gravity:"s",live:".naked-tooltip",title:function(){return this.getAttribute("data-tip")},html:!0})}render(){const t=this.props.field,e=this.props.order,a=this.props.fields,s=this.props.table.fields||this.props.labelledFields,r=this.props.table.sortable;return l.a.createElement("thead",null,l.a.createElement("tr",null,a.map(function(i,o){const n=s[i],p=t===i?e:"";if(!n)throw Error("field:"+i+" not in fields list -> ",a);const d={key:o,style:n.style,className:"naked-tooltip "+p,"data-tip":n.tooltip||n.label};return(n.sortable||r&&!1!==n.sortable)&&(d.className+=" sortable",d.onClick=this.props.sort.bind(this,i)),l.a.createElement("th",d,s[i].label)},this)))}},o=a(701);var n=class extends l.a.Component{render(){const{fields:t,fieldsConfig:e,labelledFields:a,rows:s,loadingTip:r}=this.props;return s&&s.length?l.a.createElement("tbody",null,Object(o.default)(s,t,e||a)):l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",{colSpan:t.length},r)))}},p=a(701).buildRows;var d=class extends l.a.Component{shouldComponentUpdate(t){return this.props.selectedTab!==t.selectedTab}render(){const{rows:t}=this.props;return t&&t.length?l.a.createElement("tfoot",null,p(t,this.props.fields,this.props.table.fields||this.props.labelledFields)):null}};var h={jump:function(t,e){"disabled"!==e.currentTarget.className&&this.props.jump(t,e.target.value)},setPageSize:function(t){this.props.setPageSize(t.target.value)},buildPageList:function(){return l.a.createElement("select",{onChange:this.setPageSize},this.props.pageList.map(function(t,e){return l.a.createElement("option",null,t)}))},shouldComponentUpdate:function(t){return this.props.page!==t.page||this.props.pageTotal!==t.pageTotal}};var c=class extends l.a.Component{constructor(t){super(t),Object.assign(this,h)}getPageInfo(){return this.props.page+"/"+this.props.pageTotal}render(){return l.a.createElement("div",{style:{textAlign:"right"}},l.a.createElement("ul",{className:"nt-pagination"},l.a.createElement("li",{onClick:this.jump.bind(this,"prev"),className:1===this.props.page?"disabled":null},l.a.createElement("a",{href:"javascript:void 0"},"上一页")),l.a.createElement("li",null,this.getPageInfo()),l.a.createElement("li",{onClick:this.jump.bind(this,"next"),className:this.props.page===this.props.pageTotal?"disabled":null},l.a.createElement("a",{href:"javascript:void 0"},"下一页 "))))}};a(715);function b(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}class u extends l.a.Component{constructor(t){super(t),["setTab","sort","jump","setPageSize"].forEach(t=>this[t]=this[t].bind(this)),this.state=this._getInitialState()}_getInitialState(){const{table:t,data:e}=this.props,a=this.props.tabNames||t.tabs.map(t=>t.label),s=t.pageList||[10];return this.handleFormSubmit(),{data:e,selectedTab:this.props.selectedTab,page:1,rows:t.pageList[0],pageTotal:Math.ceil(e.total/t.pageList[0]),order:this.props.order,field:this.props.field,tabClass:t.tabClass||this.props.tabClass,showTabs:a&&a.length>1,loadData:t.loadData||this.props.loadData,tabNames:a,pageList:s}}static getDerivedStateFromProps(t,e){const{table:a,data:s}=t;let l=a.fields,{fields:r}=a.tabs[t.selectedTab]||{};return!r&&s.rows.length&&(l=(r=Object.keys(s.rows[0])).map(t=>({[t]:{label:t}}))),Object.assign({},e,{data:s,fields:r||[],labelledFields:l||[],pageTotal:Math.ceil(s.total/e.pageList[0])})}componentDidMount(){this.ajax()}render(){const{showTabs:t,tabClass:e,tabNames:a,fields:s,labelledFields:r,pageList:i,pageTotal:o}=this.state,{table:n}=this.props;return l.a.createElement("div",{className:this.props.containerClass},t&&l.a.createElement(this.props.Tabs,{tabClass:e,tabNames:a,selectedTab:this.state.selectedTab,setTab:this.setTab,table:n}),l.a.createElement("table",{className:this.props.tableClass},l.a.createElement(this.props.THead,{fields:s,table:this.props.table,labelledFields:r,field:this.state.field,order:this.state.order,sort:this.sort,selectedTab:this.state.selectedTab}),l.a.createElement(this.props.TBody,{fields:s,fieldsConfig:this.props.table.fields,labelledFields:r,rows:this.getRows()}),l.a.createElement(this.props.TFoot,{fields:s,fieldsConfig:this.props.table.fields,labelledFields:r,rows:this.state.data.footer,selectedTab:this.state.selectedTab})),this.props.showPagination&&l.a.createElement(this.props.Pagination,{pageList:i,total:this.state.data.total,page:this.state.page,pageTotal:o,jump:this.jump,setPageSize:this.setPageSize}))}handleFormSubmit(){this.props.form&&this.props.form.addEventListener("submit",t=>{t.preventDefault(),this.ajax(1)})}sort(t,e){var a=this.state.data.rows;a&&(this.state.field=t,this.state.order="desc"===this.state.order?"asc":"desc",this.props.fetchByPage?this.ajax():(this.doSort(a,t,this.state.order),this.setState({data:{rows:a,total:a.length,footer:this.state.data.footer}})))}sortOnLoad(t){if(t&&t.length){const{order:e,field:a}=this.state;if(!e||!a)return;this.doSort(t,a,e)}}doSort(t,e,a){t.sort((t,a)=>{const s=t[e],l=a[e];return s===l?0:s>l?1:-1}),"desc"===a&&t.reverse()}jump(t,e){let{page:a,pageTotal:s}=this.state;switch(t){case"end":a=s;break;case"prev":a--;break;case"next":a++;break;case"jump":a=+e||1;break;default:a=1}a>s?a=s:a<1&&(a=1),a!==this.state.page&&this.ajax(a)}setPageSize(t){this.props.fetchByPage?this.ajax(1,t):this.setState({rows:t,page:1,pageTotal:Math.ceil(this.state.data.total/t||1)})}setTab(t){const e=this.props.table.tabs[t].fields;this.setState({selectedTab:t,fields:e})}getParams(t,e){return{page:t||this.state.page,rows:e||this.state.rows,field:this.state.field,order:this.state.order}}ajax(t,e){if(!this.props.fetchByPage&&t)return void this.setState({page:t});const a=this.getParams(t,e);this.state.loadData&&this.state.loadData(a,t=>{const e={};t.total<1&&(e.loadingTip="没有数据可展示"),e.data=t,this.sortOnLoad(t.rows),this.state.fields.length||t.rows.length&&(e.fields=Object.keys(t.rows[0]),e.labelledFields=e.fields.reduce((t,e)=>(t[e]={label:e},t),{})),this.setState(function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},s=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),s.forEach(function(e){b(t,e,a[e])})}return t}({page:this.props.fetchByPage?a.page:1,pageTotal:Math.ceil(t.total/this.state.rows||1)},e))})}getRows(){const t=this.state.page,e=this.state.rows,a=this.state.data.rows;return this.props.fetchByPage?a:a.slice((t-1)*e,t*e)}}b(u,"defaultProps",{Tabs:r,THead:i,TBody:n,TFoot:d,Pagination:c,containerClass:"naked",tabClass:"nt-nav",tableClass:"nt-table",loadingTip:"Loading ...",tabNames:null,selectedTab:0,form:null,fetchByPage:!1,showPagination:!0,data:{total:0,rows:[]},order:null,field:null,loadData:null});e.a=u},715:function(t,e,a){}}]);
//# sourceMappingURL=15.a1fb833f81e08b5ca2e6.chunk.js.map
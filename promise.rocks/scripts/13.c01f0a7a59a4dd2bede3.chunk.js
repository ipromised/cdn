(window.webpackJsonp=window.webpackJsonp||[]).push([[13,29],{609:function(t,e,s){"use strict";s.r(e);var i=s(0),a=s.n(i);s(697);function n(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function r(t){let e=t.getBoundingClientRect();return{top:e.top+(document.documentElement.scrollTop||document.body.scrollTop),left:e.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}function o(t,e,s){let i,a;return t<=e?(a=t,0===(i=e-t)&&(a-=i=.01*s)):(a=e,0===(i=t-e)&&(i=.01*s)),[i,a]}function h(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function l(t,e){var s=document.createElementNS("http://www.w3.org/2000/svg",t);for(var i in e){var a=e[i];if("inside"===i)h(a).appendChild(s);else if("around"===i){var n=h(a);n.parentNode.insertBefore(s,n),s.appendChild(n)}else"styles"===i?"object"==typeof a&&Object.keys(a).map(t=>{s.style[t]=a[t]}):("className"===i&&(i="class"),"innerHTML"===i?s.textContent=a:s.setAttribute(i,a))}return s}function _(t,e,s,i){return l("stop",{inside:t,style:`stop-color: ${s}`,offset:e,"stop-opacity":i})}function p(t,e,s=""){return l("g",{className:e,inside:t,transform:s})}function c(t,e="",s="none",i="none"){return l("path",{className:e,d:t,styles:{stroke:s,fill:i}})}function u(t,e,s=!1){let i="path-fill-gradient-"+e,a=function(t,e){return l("linearGradient",{inside:t,id:e,x1:0,x2:0,y1:0,y2:1})}(t,i),n=[1,.6,.2];return s&&(n=[.4,.2,0]),_(a,"0%",e,n[0]),_(a,"50%",e,n[1]),_(a,"100%",e,n[2]),i}function d(t,e,s,i,a="none",n={}){let r={className:t,x:e,y:s,width:i,height:i,fill:a};return Object.keys(n).map(t=>{r[t]=n[t]}),l("rect",r)}function m(t,e,s,i,a,n){let r=l("line",{x1:0,x2:0,y1:0,y2:t}),o=l("text",{className:i,x:0,y:e,dy:".71em",innerHTML:s}),h=l("g",{className:`tick ${a}`,transform:`translate(${n}, 0)`});return h.appendChild(r),h.appendChild(o),h}function f(t,e,s,i,a,n,r,o=!1,h=""){let _=l("line",{className:"dashed"===h?"dashed":"",x1:t,x2:e,y1:0,y2:0}),p=l("text",{className:a,x:s,y:0,dy:".32em",innerHTML:i+""}),c=l("g",{className:`tick ${n}`,transform:`translate(0, ${r})`,"stroke-opacity":1});return o&&(_.style.stroke="rgba(27, 31, 35, 0.6)"),c.appendChild(_),c.appendChild(p),c}n.create=((t,e)=>{var s=document.createElement(t);for(var i in e){var a=e[i];if("inside"===i)n(a).appendChild(s);else if("around"===i){var r=n(a);r.parentNode.insertBefore(s,r),s.appendChild(r)}else"styles"===i?"object"==typeof a&&Object.keys(a).map(t=>{s.style[t]=a[t]}):i in s?s[i]=a:s.setAttribute(i,a)}return s}),n.bind=((t,e)=>{if(t)for(var s in e){var i=e[s];s.split(/\s+/).forEach(function(e){t.addEventListener(e,i)})}}),n.unbind=((t,e)=>{if(t)for(var s in e){var i=e[s];s.split(/\s+/).forEach(function(e){t.removeEventListener(e,i)})}}),n.fire=((t,e,s)=>{var i=document.createEvent("HTMLEvents");for(var a in i.initEvent(e,!0,!0),s)i[a]=s[a];return t.dispatchEvent(i)});var g,y=((g=function(t,e,s){this.totalHeight=t,this.zeroLine=e,this.avgUnitWidth=s}).prototype={bar:function(t,e,s,i,a,n,r){let h=this.avgUnitWidth-s.spaceWidth,_=h/r,p=t-h/2+_*n,[c,u]=o(e,this.zeroLine,this.totalHeight);return l("rect",{className:"bar mini",style:`fill: ${i}`,"data-point-index":a,x:p,y:u,width:_,height:c})},dot:function(t,e,s,i,a){return l("circle",{style:`fill: ${i}`,"data-point-index":a,cx:t,cy:e,r:s.radius})}},g);var v,x=((v=function(t,e,s,i){this.totalHeight=t,this.totalWidth=e,this.avgUnitWidth=i,this.zeroLine=s}).prototype={bar:function(t,e,s,i,a){let n=e-this.avgUnitWidth/4,r=this.avgUnitWidth/2/a,[h,l]=o(s,this.zeroLine,this.totalHeight);return[t,{width:r,height:h,x:e=n+r*i,y:l},350,"easein"]},dot:function(t,e,s){return[t,{cx:e,cy:s},350,"easein"]},path:function(t,e){let s=[];const i=[{unit:t.path,object:t,key:"path"},{d:"M"+e},350,"easein"];if(s.push(i),t.regionPath){let i=`0,${this.zeroLine}L`,a=`L${this.totalWidth}, ${this.zeroLine}`;const n=[{unit:t.regionPath,object:t,key:"regionPath"},{d:"M"+i+e+a},350,"easein"];s.push(n)}return s}},v);const w={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function b(t,e){t.style.transform=e,t.style.webkitTransform=e,t.style.msTransform=e,t.style.mozTransform=e,t.style.oTransform=e}function k(t,e){let s=[],i=[];e.map(t=>{let e,a,n=t[0],r=n.unit.parentNode;t[0]=n.unit,[e,a]=function(t,e,s,i="linear",a,n={}){let r=t.cloneNode(!0),o=t.cloneNode(!0);for(var h in e){let _;_="transform"===h?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");let p=n[h]||t.getAttribute(h),c=e[h],u={attributeName:h,from:p,to:c,begin:"0s",dur:s/1e3+"s",values:p+";"+c,keySplines:w[i],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var l in a&&(u.type=a),u)_.setAttribute(l,u[l]);r.appendChild(_),a?o.setAttribute(h,`translate(${c})`):o.setAttribute(h,c)}return[r,o]}(...t),s.push(a),i.push([e,r]),r.replaceChild(e,n.unit),n.array?n.array[n.index]=a:n.object[n.key]=a});let a=t.cloneNode(!0);return i.map((t,i)=>{t[1].replaceChild(s[i],t[0]),e[i][0]=s[i]}),a}function C(t){if(0===t)return[0,0];if(isNaN(t))return{mantissa:-6755399441055744,exponent:972};var e=t>0?1:-1;if(!isFinite(t))return{mantissa:4503599627370496*e,exponent:972};t=Math.abs(t);var s=Math.floor(Math.log10(t));return[e*(t/Math.pow(10,s)),s]}function L(t,e=0){let[s,i]=C(t),a=e?e/Math.pow(10,i):0,n=function(t,e=0){let s=Math.ceil(t),i=Math.floor(e),a=s-i,n=a,r=1;a>5&&(a%2!=0&&(a=++s-i),n=a/2,r=2),a<=2&&(r=a/(n=4)),0===a&&(n=5,r=1);let o=[];for(var h=0;h<=n;h++)o.push(i+r*h);return o}(s=s.toFixed(6),a);return n=n.map(t=>t*Math.pow(10,i))}function A(t,e){return e.filter(e=>e<t).length}function $(t){return parseFloat(t.toFixed(2))}function M(t,e){if(t.length!==e.length)return!1;let s=!0;return t.map((t,i)=>{e[i]!==t&&(s=!1)}),s}function E(t,e){return(t+"").length*e}class N{constructor({parent:t=null,colors:e=[]}){this.parent=t,this.colors=e,this.title_name="",this.title_value="",this.list_values=[],this.title_value_first=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}setup(){this.make_tooltip()}refresh(){this.fill(),this.calc_position()}make_tooltip(){this.container=n.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:'<span class="title"></span>\n\t\t\t\t<ul class="data-point-list"></ul>\n\t\t\t\t<div class="svg-pointer"></div>'}),this.hide_tip(),this.title=this.container.querySelector(".title"),this.data_point_list=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",()=>{this.hide_tip()})}fill(){let t;t=this.title_value_first?`<strong>${this.title_value}</strong>${this.title_name}`:`${this.title_name}<strong>${this.title_value}</strong>`,this.title.innerHTML=t,this.data_point_list.innerHTML="",this.list_values.map((t,e)=>{const s=this.colors[e]||"black";let i=n.create("li",{styles:{"border-top":`3px solid ${s}`},innerHTML:`<strong style="display: block;">${0===t.value||t.value?t.value:""}</strong>\n\t\t\t\t\t${t.title?t.title:""}`});this.data_point_list.appendChild(i)})}calc_position(){let t=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight,this.left=this.x-t/2;let e=this.parent.offsetWidth-t,s=this.container.querySelector(".svg-pointer");if(this.left<0)s.style.left=`calc(50% - ${-1*this.left}px)`,this.left=0;else if(this.left>e){let t=`calc(50% + ${this.left-e}px)`;s.style.left=t,this.left=e}else s.style.left="50%"}set_values(t,e,s="",i="",a=[],n=0){this.title_name=s,this.title_value=i,this.list_values=a,this.x=t,this.y=e,this.title_value_first=n,this.refresh()}hide_tip(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}show_tip(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}const T={"light-blue":"#7cd6fd",blue:"#5e64ff",violet:"#743ee2",red:"#ff5858",orange:"#ffa00a",yellow:"#feef72",green:"#28a745","light-green":"#98d85b",purple:"#b554ff",magenta:"#ffa3ef",black:"#36114C",grey:"#bdd3e6","light-grey":"#f0f4f7","dark-grey":"#b8c2cc"},S=["light-blue","blue","violet","red","orange","yellow","green","light-green","purple","magenta"];function z(t){return t>255?255:t<0?0:t}const j=t=>T[t]||t,P=["line","scatter","bar","percentage","heatmap","pie"],O={bar:["line","scatter","percentage","pie"],line:["scatter","bar","percentage","pie"],pie:["line","scatter","percentage","bar"],scatter:["line","bar","percentage","pie"],percentage:["bar","line","scatter","pie"],heatmap:[]},D={bar:["line","scatter"],line:["scatter","bar"],pie:["percentage"],scatter:["line","bar"],percentage:["pie"],heatmap:[]};class F{constructor({height:t=240,title:e="",subtitle:s="",colors:i=[],summary:a=[],is_navigable:n=0,has_legend:r=0,type:o="",parent:h,data:l}){this.refresh=this.refresh.bind(this),this.raw_chart_args=arguments[0],this.parent="string"==typeof h?document.querySelector(h):h,this.title=e,this.subtitle=s,this.data=l,this.specific_values=l.specific_values||[],this.summary=a,this.is_navigable=n,this.is_navigable&&(this.current_index=0),this.has_legend=r,this.setColors(i,o),this.set_margins(t)}get_different_chart(t){if(t===this.type)return;P.includes(t)||console.error(`'${t}' is not a valid chart type.`),O[this.type].includes(t)||console.error(`'${this.type}' chart cannot be converted to a '${t}' chart.`);const e=D[this.type].includes(t);return new X({parent:this.raw_chart_args.parent,title:this.title,data:this.raw_chart_args.data,type:t,height:this.raw_chart_args.height,colors:e?this.colors:void 0})}setColors(t,e){this.colors=t;const s="percentage"===e||"pie"===e?this.data.labels:this.data.datasets;(!this.colors||s&&this.colors.length<s.length)&&(this.colors=S),this.colors=this.colors.map(t=>j(t))}set_margins(t){this.base_height=t,this.height=t-40,this.translate_x=60,this.translate_y=10}setup(){this.parent?this.validate_and_prepare_data()&&(this.bind_window_events(),this.refresh(!0)):console.error("No parent element to render on was provided.")}validate_and_prepare_data(){return!0}bind_window_events(){window.addEventListener("resize",this.refresh),window.addEventListener("orientationchange",this.refresh)}destroy(){window.removeEventListener("resize",this.refresh),window.removeEventListener("orientationchange",this.refresh)}refresh(t=!1){this.setup_base_values(),this.set_width(),this.setup_container(),this.setup_components(),this.setup_values(),this.setup_utils(),this.make_graph_components(t),this.make_tooltip(),this.summary.length>0?this.show_custom_summary():this.show_summary(),this.is_navigable&&this.setup_navigation(t)}set_width(){let t=0;var e,s,i;this.specific_values.map(e=>{let s=E(e.title+"",8);s>t&&(t=s-40)}),this.base_width=(e=this.parent,s=window.getComputedStyle(e),i=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),e.clientWidth-i-t),this.width=this.base_width-2*this.translate_x}setup_base_values(){}setup_container(){this.container=n.create("div",{className:"chart-container",innerHTML:`<h6 class="title">${this.title}</h6>\n\t\t\t\t<h6 class="sub-title uppercase">${this.subtitle}</h6>\n\t\t\t\t<div class="frappe-chart graphics"></div>\n\t\t\t\t<div class="graph-stats-container"></div>`}),this.parent.innerHTML="",this.parent.appendChild(this.container),this.chart_wrapper=this.container.querySelector(".frappe-chart"),this.stats_wrapper=this.container.querySelector(".graph-stats-container"),this.make_chart_area(),this.make_draw_area()}make_chart_area(){var t,e,s,i;return this.svg=(t=this.chart_wrapper,e="chart",s=this.base_width,i=this.base_height,l("svg",{className:e,inside:t,width:s,height:i})),this.svg_defs=l("defs",{inside:this.svg}),this.svg}make_draw_area(){this.draw_area=p(this.svg,this.type+"-chart",`translate(${this.translate_x}, ${this.translate_y})`)}setup_components(){}make_tooltip(){this.tip=new N({parent:this.chart_wrapper,colors:this.colors}),this.bind_tooltip()}show_summary(){}show_custom_summary(){this.summary.map(t=>{let e=n.create("div",{className:"stats",innerHTML:`<span class="indicator">\n\t\t\t\t\t<i style="background:${t.color}"></i>\n\t\t\t\t\t${t.title}: ${t.value}\n\t\t\t\t</span>`});this.stats_wrapper.appendChild(e)})}setup_navigation(t=!1){var e,s;this.make_overlay(),t&&(this.bind_overlay(),document.addEventListener("keydown",t=>{e=this.chart_wrapper,(s=e.getBoundingClientRect()).top>=0&&s.left>=0&&s.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&s.right<=(window.innerWidth||document.documentElement.clientWidth)&&("37"==(t=t||window.event).keyCode?this.on_left_arrow():"39"==t.keyCode?this.on_right_arrow():"38"==t.keyCode?this.on_up_arrow():"40"==t.keyCode?this.on_down_arrow():"13"==t.keyCode&&this.on_enter_key())}))}make_overlay(){}bind_overlay(){}bind_units(){}on_left_arrow(){}on_right_arrow(){}on_up_arrow(){}on_down_arrow(){}on_enter_key(){}get_data_point(t=this.current_index){let e={index:t},s=this.y[0];return["svg_units","y_tops","values"].map(i=>{let a=i.slice(0,i.length-1);e[a]=s[i][t]}),e.label=this.x[t],e}update_current_data_point(t){(t=parseInt(t))<0&&(t=0),t>=this.x.length&&(t=this.x.length-1),t!==this.current_index&&(this.current_index=t,n.fire(this.parent,"data-select",this.get_data_point()))}setup_utils(){}makeDrawAreaComponent(t,e=""){return p(this.draw_area,t,e)}}class H extends F{constructor(t){super(t),this.x=this.data.labels||[],this.y=this.data.datasets||[],this.is_series=t.is_series,this.format_tooltip_y=t.format_tooltip_y,this.format_tooltip_x=t.format_tooltip_x,this.zero_line=this.height}validate_and_prepare_data(){return!0}setup_values(){this.data.datasets.map(t=>{t.values=t.values.map(t=>isNaN(t)?0:t)}),this.setup_x(),this.setup_y()}setup_x(){this.set_avg_unit_width_and_x_offset(),this.x_axis_positions&&(this.x_old_axis_positions=this.x_axis_positions.slice()),this.x_axis_positions=this.x.map((t,e)=>$(this.x_offset+e*this.avg_unit_width)),this.x_old_axis_positions||(this.x_old_axis_positions=this.x_axis_positions.slice())}setup_y(){this.y_axis_values&&(this.y_old_axis_values=this.y_axis_values.slice());let t=this.get_all_y_values();this.y_sums&&this.y_sums.length>0&&(t=t.concat(this.y_sums)),this.y_axis_values=function(t,e=!1){let s=Math.max(...t),i=Math.min(...t),a=0,n=[];function r(t,e){let s=L(t),i=s[1]-s[0],a=0;for(var n=1;a<e;n++)a+=i,s.unshift(-1*a);return s}if(s>=0&&i>=0)a=C(s)[1],n=e?L(s,i):L(s);else if(s>0&&i<0){let t=Math.abs(i);s>=t?(a=C(s)[1],n=r(s,t)):(a=C(t)[1],n=r(t,s).map(t=>-1*t))}else if(s<=0&&i<=0){let t=Math.abs(i),r=Math.abs(s);a=C(t)[1],n=(n=e?L(t,r):L(t)).reverse().map(t=>-1*t)}return n}(t,"line"===this.type),this.y_old_axis_values||(this.y_old_axis_values=this.y_axis_values.slice());const e=this.y_axis_values,s=e[e.length-1]-e[0];this.multiplier&&(this.old_multiplier=this.multiplier),this.multiplier=this.height/s,this.old_multiplier||(this.old_multiplier=this.multiplier);const i=e[1]-e[0],a=i*this.multiplier;let n;if(e.indexOf(0)>=0)n=e.indexOf(0);else if(e[0]>0){n=-1*e[0]/i}else{n=-1*e[e.length-1]/i+(e.length-1)}this.zero_line&&(this.old_zero_line=this.zero_line),this.zero_line=this.height-n*a,this.old_zero_line||(this.old_zero_line=this.zero_line)}setup_components(){super.setup_components(),this.setup_marker_components(),this.setup_aggregation_components(),this.setup_graph_components()}setup_marker_components(){this.y_axis_group=this.makeDrawAreaComponent("y axis"),this.x_axis_group=this.makeDrawAreaComponent("x axis"),this.specific_y_group=this.makeDrawAreaComponent("specific axis")}setup_aggregation_components(){this.sum_group=this.makeDrawAreaComponent("data-points"),this.average_group=this.makeDrawAreaComponent("chart-area")}setup_graph_components(){this.svg_units_groups=[],this.y.map((t,e)=>{this.svg_units_groups[e]=this.makeDrawAreaComponent("data-points data-points-"+e)})}make_graph_components(t=!1){this.make_y_axis(),this.make_x_axis(),this.draw_graph(t),this.make_y_specifics()}make_x_axis(t=!1){let e,s,i,a="";if("span"===this.x_axis_mode?(e=-7,s=this.height+15,i=this.height+25):"tick"===this.x_axis_mode&&(e=this.height,s=6,i=9,a="x-axis-label"),this.x_axis_group.setAttribute("transform",`translate(0,${e})`),t)return void this.make_anim_x_axis(s,i,a);let n=1.5*this.avg_unit_width,r=n/8;this.x_axis_group.textContent="",this.x.map((t,e)=>{let o=E(t,8)+2;if(o>n)if(this.is_series){let t=1;for(;o/t*2>n;)t++;if(e%t!=0)return}else t=t.slice(0,r-3)+" ...";this.x_axis_group.appendChild(m(s,i,t,"x-value-text",a,this.x_axis_positions[e]))})}make_y_axis(t=!1){if(t)return this.make_anim_y_axis(),void this.make_anim_y_specifics();let[e,s,i,a]=this.get_y_axis_line_props();this.y_axis_group.textContent="",this.y_axis_values.map((t,n)=>{this.y_axis_group.appendChild(f(a,e,s,t,"y-value-text",i,this.zero_line-t*this.multiplier,0===t&&0!==n))})}get_y_axis_line_props(t=!1){if(t)return[this.width,this.width+5,"specific-value",0];let e,s="",i=0;return"span"===this.y_axis_mode?(e=this.width+6,i=-6):"tick"===this.y_axis_mode&&(e=-6,s="y-axis-label"),[e,-9,s,i]}draw_graph(t=!1){!this.raw_chart_args.hasOwnProperty("init")||this.raw_chart_args.init?t?this.draw_new_graph_and_animate():this.y.map((t,e)=>{t.svg_units=[],this.make_path&&this.make_path(t,e,this.x_axis_positions,t.y_tops,this.colors[e]),this.make_new_units(t,e)}):this.y.map((t,e)=>{t.svg_units=[],this.make_path&&this.make_path(t,e,this.x_axis_positions,t.y_tops,this.colors[e]),this.make_new_units(t,e),this.calc_y_dependencies()})}draw_new_graph_and_animate(){let t=[];this.y.map((e,s)=>{e.y_tops=new Array(e.values.length).fill(this.zero_line),t.push({values:e.values}),e.svg_units=[],this.make_path&&this.make_path(e,s,this.x_axis_positions,e.y_tops,this.colors[s]),this.make_new_units(e,s)}),setTimeout(()=>{this.update_values(t)},350)}setup_navigation(t){t?setTimeout(()=>{super.setup_navigation(t)},500):super.setup_navigation(t)}make_new_units(t,e){this.make_new_units_for_dataset(this.x_axis_positions,t.y_tops,this.colors[e],e,this.y.length)}make_new_units_for_dataset(t,e,s,i,a,n,r,o){n||(n=this.svg_units_groups[i]),r||(r=this.y[i].svg_units),o||(o=this.unit_args),n.textContent="",r.length=0;let h=new y(this.height,this.zero_line,this.avg_unit_width);e.map((e,l)=>{let _=h[o.type](t[l],e,o.args,s,l,i,a);n.appendChild(_),r.push(_)}),this.is_navigable&&this.bind_units(r)}make_y_specifics(){this.specific_y_group.textContent="",this.specific_values.map(t=>{this.specific_y_group.appendChild(f(0,this.width,this.width+5,t.title.toUpperCase(),"specific-value","specific-value",this.zero_line-t.value*this.multiplier,!1,t.line_type))})}bind_tooltip(){this.chart_wrapper.addEventListener("mousemove",t=>{let e=r(this.chart_wrapper),s=t.pageX-e.left-this.translate_x;t.pageY-e.top-this.translate_y<this.height+2*this.translate_y?this.map_tooltip_x_position_and_show(s):this.tip.hide_tip()})}map_tooltip_x_position_and_show(t){if(!this.y_min_tops)return;let e=this.x;this.format_tooltip_x&&this.format_tooltip_x(this.x[0])&&(e=this.x.map(t=>this.format_tooltip_x(t)));let s=this.format_tooltip_y&&this.format_tooltip_y(this.y[0].values[0]);for(var i=this.x_axis_positions.length-1;i>=0;i--){let a=this.x_axis_positions[i];if(t>a-this.avg_unit_width/2){let t=a+this.translate_x,n=this.y_min_tops[i]+this.translate_y,r=e[i],o=this.y.map((t,e)=>({title:t.title,value:s?this.format_tooltip_y(t.values[i]):t.values[i],color:this.colors[e]}));this.tip.set_values(t,n,r,"",o),this.tip.show_tip();break}}}show_sums(){this.updating=!0,this.y_sums=new Array(this.x_axis_positions.length).fill(0),this.y.map(t=>{t.values.map((t,e)=>{this.y_sums[e]+=t})}),this.update_values(),this.sum_units=[],this.make_new_units_for_dataset(this.x_axis_positions,this.y_sums.map(t=>$(this.zero_line-t*this.multiplier)),"#f0f4f7",0,1,this.sum_group,this.sum_units),this.updating=!1}hide_sums(){this.updating||(this.y_sums=[],this.sum_group.textContent="",this.sum_units=[],this.update_values())}show_averages(){this.old_specific_values=this.specific_values.slice(),this.y.map((t,e)=>{let s=0;t.values.map(t=>{s+=t});let i=s/t.values.length;this.specific_values.push({title:"AVG "+(e+1),line_type:"dashed",value:i,auto:1})}),this.update_values()}hide_averages(){this.old_specific_values=this.specific_values.slice();let t=[];this.specific_values.map((e,s)=>{e.auto&&t.unshift(s)}),t.map(t=>{this.specific_values.splice(t,1)}),this.update_values()}update_values(t,e){e||(e=this.x),this.elements_to_animate=[],this.updating=!0,this.old_x_values=this.x.slice(),this.old_y_axis_tops=this.y.map(t=>t.y_tops.slice()),this.old_y_values=this.y.map(t=>t.values),this.no_of_extra_pts=e.length-this.x.length,t&&this.y.map((e,s)=>{e.values=t[s].values}),e&&(this.x=e),this.setup_x(),this.setup_y(),this.calc_y_dependencies(),this.animator=new x(this.height,this.width,this.zero_line,this.avg_unit_width),M(this.x_old_axis_positions,this.x_axis_positions)||(this.make_x_axis(!0),setTimeout(()=>{this.updating||this.make_x_axis()},350)),(!M(this.y_old_axis_values,this.y_axis_values)||this.old_specific_values&&!M(this.old_specific_values,this.specific_values))&&(this.make_y_axis(!0),setTimeout(()=>{this.updating||(this.make_y_axis(),this.make_y_specifics())},350)),this.animate_graphs(),this.run_animation(),this.updating=!1}add_data_point(t,e,s=this.x.length){let i=this.y.map(t=>({values:t.values}));i.map((e,i)=>{e.values.splice(s,0,t[i])});let a=this.x.slice();a.splice(s,0,e),this.update_values(i,a)}remove_data_point(t=this.x.length-1){if(this.x.length<3)return;let e=this.y.map(t=>({values:t.values}));e.map(e=>{e.values.splice(t,1)});let s=this.x.slice();s.splice(t,1),this.update_values(e,s)}run_animation(){let t=k(this.svg,this.elements_to_animate);this.svg.parentNode==this.chart_wrapper&&(this.chart_wrapper.removeChild(this.svg),this.chart_wrapper.appendChild(t)),setTimeout(()=>{t.parentNode==this.chart_wrapper&&(this.chart_wrapper.removeChild(t),this.chart_wrapper.appendChild(this.svg))},250)}animate_graphs(){this.y.map((t,e)=>{let[s,i,a,n]=this.calc_old_and_new_postions(t,e);this.no_of_extra_pts>=0&&(this.make_path&&this.make_path(t,e,s,i,this.colors[e]),this.make_new_units_for_dataset(s,i,this.colors[e],e,this.y.length)),t.path&&this.animate_path(t,e,s,i,a,n),this.animate_units(t,e,s,i,a,n)}),setTimeout(()=>{this.y.map((t,e)=>{this.make_path&&this.make_path(t,e,this.x_axis_positions,t.y_tops,this.colors[e]),this.make_new_units(t,e)})},400)}animate_path(t,e,s,i,a,n){const r=n.map((t,e)=>a[e]+","+t).join("L");this.elements_to_animate=this.elements_to_animate.concat(this.animator.path(t,r))}animate_units(t,e,s,i,a,n){let r=this.unit_args.type;t.svg_units.map((s,i)=>{void 0!==a[i]&&void 0!==n[i]&&this.elements_to_animate.push(this.animator[r]({unit:s,array:t.svg_units,index:i},a[i],n[i],e,this.y.length))})}calc_old_and_new_postions(t,e){let s=this.x_old_axis_positions.slice(),i=this.x_axis_positions.slice(),a=this.old_y_axis_tops[e].slice(),n=t.y_tops.slice();const r=s[s.length-1],o=a[a.length-1],h=i[i.length-1],l=n[n.length-1];if(this.no_of_extra_pts>=0){let t=new Array(Math.abs(this.no_of_extra_pts)).fill(r),e=new Array(Math.abs(this.no_of_extra_pts)).fill(o);s=s.concat(t),a=a.concat(e)}else{let t=new Array(Math.abs(this.no_of_extra_pts)).fill(h),e=new Array(Math.abs(this.no_of_extra_pts)).fill(l);i=i.concat(t),n=n.concat(e)}return[s,a,i,n]}make_anim_x_axis(t,e,s){const i=this.x_old_axis_positions,a=this.x_axis_positions,n=this.old_x_values,r=this.x,o=i[i.length-1];this.x_axis_group.textContent="",this.make_new_axis_anim_lines(i,a,n,r,o,(i,a,n)=>{"string"==typeof n&&(n=parseInt(n.substring(0,n.length-1)));const r=m(t,e,i,"x-value-text",s,a);this.x_axis_group.appendChild(r),this.elements_to_animate&&this.elements_to_animate.push([{unit:r,array:[0],index:0},{transform:`${n}, 0`},350,"easein","translate",{transform:`${a}, 0`}])})}make_anim_y_axis(){const t=this.y_old_axis_values.map(t=>this.zero_line-t*this.multiplier),e=this.y_axis_values.map(t=>this.zero_line-t*this.multiplier),s=this.y_old_axis_values,i=this.y_axis_values,a=t[t.length-1];this.y_axis_group.textContent="",this.make_new_axis_anim_lines(t,e,s,i,a,this.add_and_animate_y_line.bind(this),this.y_axis_group)}make_anim_y_specifics(){this.specific_y_group.textContent="",this.specific_values.map(t=>{this.add_and_animate_y_line(t.title,this.old_zero_line-t.value*this.old_multiplier,this.zero_line-t.value*this.multiplier,0,this.specific_y_group,t.line_type,!0)})}make_new_axis_anim_lines(t,e,s,i,a,n,r){let o,h,l=i.length-s.length;if(l>0)o=e.slice(0,t.length),h=i.slice(0,s.length);else{const t=new Array(Math.abs(l)).fill("");h=i.concat(t);const s=new Array(Math.abs(l)).fill(a+"F");o=e.concat(s)}if(h.map((e,s)=>{n(e,t[s],o[s],s,r)}),l>0){const o=i.slice(s.length),h=e.slice(t.length);o.map((t,e)=>{n(t,a,h[e],e,r)})}}add_and_animate_y_line(t,e,s,i,a,n,r=!1){let o=!1;"string"==typeof s&&(s=parseInt(s.substring(0,s.length-1)),o=!0);let h={transform:`0, ${s}`},l={transform:`0, ${e}`};o&&(h["stroke-opacity"]=0);let[_,p,c,u]=this.get_y_axis_line_props(r),d=r?"specific-value":"y-value-text";const m=f(u,_,p,t=r?(t+"").toUpperCase():t,d,c,e,0===t&&0!==i,n);a.appendChild(m),this.elements_to_animate&&this.elements_to_animate.push([{unit:m,array:[0],index:0},h,350,"easein","translate",l])}set_avg_unit_width_and_x_offset(){this.avg_unit_width=this.width/(this.x.length-1),this.x_offset=0}get_all_y_values(){let t=[];return this.y.map(e=>{t=t.concat(e.values)}),t.concat(this.specific_values.map(t=>t.value))}calc_y_dependencies(){this.y_min_tops=new Array(this.x_axis_positions.length).fill(9999),this.y.map(t=>{t.y_tops=t.values.map(t=>$(this.zero_line-t*this.multiplier)),t.y_tops.map((t,e)=>{t<this.y_min_tops[e]&&(this.y_min_tops[e]=t)})})}}class W extends H{constructor(t){super(t),this.x_axis_mode=t.x_axis_mode||"span",this.y_axis_mode=t.y_axis_mode||"span",t.hasOwnProperty("show_dots")?this.show_dots=t.show_dots:this.show_dots=1,this.region_fill=t.region_fill,Object.getPrototypeOf(this)===W.prototype&&(this.dot_radius=t.dot_radius||4,this.heatline=t.heatline,this.type="line",this.setup())}setup_graph_components(){this.setup_path_groups(),super.setup_graph_components()}setup_path_groups(){this.paths_groups=[],this.y.map((t,e)=>{this.paths_groups[e]=p(this.draw_area,"path-group path-group-"+e)})}setup_values(){super.setup_values(),this.unit_args={type:"dot",args:{radius:this.dot_radius}}}make_new_units_for_dataset(t,e,s,i,a,n,r,o){this.show_dots&&super.make_new_units_for_dataset(t,e,s,i,a,n,r,o)}make_paths(){this.y.map((t,e)=>{this.make_path(t,e,this.x_axis_positions,t.y_tops,t.color||this.colors[e])})}make_path(t,e,s,i,a){let n=i.map((t,e)=>s[e]+","+t).join("L");if(this.paths_groups[e].textContent="",t.path=c("M"+n,"line-graph-path",a),this.paths_groups[e].appendChild(t.path),this.heatline){let e=u(this.svg_defs,a);t.path.style.stroke=`url(#${e})`}this.region_fill&&this.fill_region_for_dataset(t,e,a,n)}fill_region_for_dataset(t,e,s,i){let a=u(this.svg_defs,s,!0),n="M"+`0,${this.zero_line}L`+i+`L${this.width},${this.zero_line}`;t.regionPath=c(n,"region-fill","none",`url(#${a})`),this.paths_groups[e].appendChild(t.regionPath)}}const I=Math.PI/180,B=360;class q extends F{constructor(t){super(t),this.type="pie",this.elements_to_animate=null,this.hoverRadio=t.hoverRadio||.1,this.max_slices=10,this.max_legend_points=6,this.isAnimate=!1,this.startAngle=t.startAngle||0,this.clockWise=t.clockWise||!1,this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.setup()}setup_values(){this.centerX=this.width/2,this.centerY=this.height/2,this.radius=this.height>this.width?this.centerX:this.centerY,this.slice_totals=[];let t=this.data.labels.map((t,e)=>{let s=0;return this.data.datasets.map(t=>{s+=t.values[e]}),[s,t]}).filter(t=>t[0]>0),e=t;if(t.length>this.max_slices){t.sort((t,e)=>e[0]-t[0]),e=t.slice(0,this.max_slices-1);let s=0;t.slice(this.max_slices-1).map(t=>{s+=t[0]}),e.push([s,"Rest"]),this.colors[this.max_slices-1]="grey"}this.labels=[],e.map(t=>{this.slice_totals.push(t[0]),this.labels.push(t[1])}),this.legend_totals=this.slice_totals.slice(0,this.max_legend_points)}static getPositionByAngle(t,e){return{x:Math.sin(t*I)*e,y:Math.cos(t*I)*e}}makeArcPath(t,e){const{centerX:s,centerY:i,radius:a,clockWise:n}=this;return`M${s} ${i} L${s+t.x} ${i+t.y} A ${a} ${a} 0 0 ${n?1:0} ${s+e.x} ${i+e.y} z`}make_graph_components(t){const{radius:e,clockWise:s}=this;this.grand_total=this.slice_totals.reduce((t,e)=>t+e,0);const i=this.slicesProperties||[];this.slices=[],this.elements_to_animate=[],this.slicesProperties=[];let a=180-this.startAngle;this.slice_totals.map((n,r)=>{const o=a,h=n/this.grand_total*B,l=s?-h:h,_=a+=l,p=q.getPositionByAngle(o,e),u=q.getPositionByAngle(_,e),d=t&&i[r];let m,f;t?(m=d?d.startPosition:p,f=d?d.endPosition:p):(m=p,f=u);const g=this.makeArcPath(m,f);let y=c(g,"pie-path","none",this.colors[r]);y.style.transition="transform .3s;",this.draw_area.appendChild(y),this.slices.push(y),this.slicesProperties.push({startPosition:p,endPosition:u,value:n,total:this.grand_total,startAngle:o,endAngle:_,angle:l}),t&&this.elements_to_animate.push([{unit:y,array:this.slices,index:this.slices.length-1},{d:this.makeArcPath(p,u)},650,"easein",null,{d:g}])}),t&&this.run_animation()}run_animation(){if(!this.elements_to_animate||0===this.elements_to_animate.length)return;let t=k(this.svg,this.elements_to_animate);this.svg.parentNode==this.chart_wrapper&&(this.chart_wrapper.removeChild(this.svg),this.chart_wrapper.appendChild(t)),setTimeout(()=>{t.parentNode==this.chart_wrapper&&(this.chart_wrapper.removeChild(t),this.chart_wrapper.appendChild(this.svg))},650)}calTranslateByAngle(t){const{radius:e,hoverRadio:s}=this,i=q.getPositionByAngle(t.startAngle+t.angle/2,e);return`translate3d(${i.x*s}px,${i.y*s}px,0)`}hoverSlice(t,e,s,i){if(!t)return;const a=this.colors[e];if(s){b(t,this.calTranslateByAngle(this.slicesProperties[e])),t.style.fill=function(t,e){let s=j(t),i=!1;"#"==s[0]&&(s=s.slice(1),i=!0);let a=parseInt(s,16),n=z((a>>16)+e),r=z((a>>8&255)+e),o=z((255&a)+e);return(i?"#":"")+(o|r<<8|n<<16).toString(16)}(a,50);let s=r(this.svg),n=i.pageX-s.left+10,o=i.pageY-s.top-10,h=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[e]:this.labels[e])+": ",l=(100*this.slice_totals[e]/this.grand_total).toFixed(1);this.tip.set_values(n,o,h,l+"%"),this.tip.show_tip()}else b(t,"translate3d(0,0,0)"),this.tip.hide_tip(),t.style.fill=a}mouseMove(t){const e=t.target;let s=this.curActiveSliceIndex,i=this.curActiveSlice;for(let a=0;a<this.slices.length;a++)if(e===this.slices[a]){this.hoverSlice(i,s,!1),this.curActiveSlice=e,this.curActiveSliceIndex=a,this.hoverSlice(e,a,!0,t);break}}mouseLeave(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}bind_tooltip(){this.draw_area.addEventListener("mousemove",this.mouseMove),this.draw_area.addEventListener("mouseleave",this.mouseLeave)}show_summary(){let t=this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels:this.labels;this.legend_totals.map((e,s)=>{const i=this.colors[s];if(e){n.create("div",{className:"stats",inside:this.stats_wrapper}).innerHTML=`<span class="indicator">\n\t\t\t\t\t<i style="background-color:${i};"></i>\n\t\t\t\t\t<span class="text-muted">${t[s]}:</span>\n\t\t\t\t\t${e}\n\t\t\t\t</span>`}})}}function R(t){let e=new Date(t);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e}function G(t){let e=t.getDate(),s=t.getMonth()+1;return[(e>9?"":"0")+e,(s>9?"":"0")+s,t.getFullYear()].join("-")}function Y(t,e){return Math.ceil(function(t,e){return(R(e)-R(t))/864e5}(t,e)/7)}function U(t,e){t.setDate(t.getDate()+e)}const J={line:W,bar:class extends H{constructor(t){super(t),this.type="bar",this.x_axis_mode=t.x_axis_mode||"tick",this.y_axis_mode=t.y_axis_mode||"span",this.setup()}setup_values(){super.setup_values(),this.x_offset=this.avg_unit_width,this.unit_args={type:"bar",args:{spaceWidth:this.avg_unit_width/2}}}make_overlay(){let t=this.x.length-1,e=this.y[0].svg_units[t];this.update_current_data_point(t),this.overlay&&this.overlay.parentNode.removeChild(this.overlay),this.overlay=e.cloneNode(),this.overlay.style.fill="#000000",this.overlay.style.opacity="0.4",this.draw_area.appendChild(this.overlay)}bind_overlay(){this.parent.addEventListener("data-select",t=>{this.update_overlay(t.svg_unit)})}bind_units(t){t.map(t=>{t.addEventListener("click",()=>{let e=t.getAttribute("data-point-index");this.update_current_data_point(e)})})}update_overlay(t){let e=[];Object.keys(t.attributes).map(s=>{e.push(t.attributes[s])}),e.filter(t=>t.specified).map(t=>{this.overlay.setAttribute(t.name,t.nodeValue)}),this.overlay.style.fill="#000000",this.overlay.style.opacity="0.4"}on_left_arrow(){this.update_current_data_point(this.current_index-1)}on_right_arrow(){this.update_current_data_point(this.current_index+1)}set_avg_unit_width_and_x_offset(){this.avg_unit_width=this.width/(this.x.length+1),this.x_offset=this.avg_unit_width}},scatter:class extends W{constructor(t){super(t),this.type="scatter",t.dot_radius?this.dot_radius=t.dot_radius:this.dot_radius=8,this.setup()}setup_graph_components(){this.setup_path_groups(),super.setup_graph_components()}setup_path_groups(){}setup_values(){super.setup_values(),this.unit_args={type:"dot",args:{radius:this.dot_radius}}}make_paths(){}make_path(){}},percentage:class extends F{constructor(t){super(t),this.type="percentage",this.max_slices=10,this.max_legend_points=6,this.setup()}make_chart_area(){this.chart_wrapper.className+=" graph-focus-margin",this.chart_wrapper.style.marginTop="45px",this.stats_wrapper.className+=" graph-focus-margin",this.stats_wrapper.style.marginBottom="30px",this.stats_wrapper.style.paddingTop="0px"}make_draw_area(){this.chart_div=n.create("div",{className:"div",inside:this.chart_wrapper}),this.chart=n.create("div",{className:"progress-chart",inside:this.chart_div})}setup_components(){this.percentage_bar=n.create("div",{className:"progress",inside:this.chart})}setup_values(){this.slice_totals=[];let t=this.data.labels.map((t,e)=>{let s=0;return this.data.datasets.map(t=>{s+=t.values[e]}),[s,t]}).filter(t=>t[0]>0),e=t;if(t.length>this.max_slices){t.sort((t,e)=>e[0]-t[0]),e=t.slice(0,this.max_slices-1);let s=0;t.slice(this.max_slices-1).map(t=>{s+=t[0]}),e.push([s,"Rest"]),this.colors[this.max_slices-1]="grey"}this.labels=[],e.map(t=>{this.slice_totals.push(t[0]),this.labels.push(t[1])}),this.legend_totals=this.slice_totals.slice(0,this.max_legend_points)}make_graph_components(){this.grand_total=this.slice_totals.reduce((t,e)=>t+e,0),this.slices=[],this.slice_totals.map((t,e)=>{let s=n.create("div",{className:"progress-bar",inside:this.percentage_bar,styles:{background:this.colors[e],width:100*t/this.grand_total+"%"}});this.slices.push(s)})}bind_tooltip(){this.slices.map((t,e)=>{t.addEventListener("mouseenter",()=>{let s=r(this.chart_wrapper),i=r(t),a=i.left-s.left+t.offsetWidth/2,n=i.top-s.top-6,o=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[e]:this.labels[e])+": ",h=(100*this.slice_totals[e]/this.grand_total).toFixed(1);this.tip.set_values(a,n,o,h+"%"),this.tip.show_tip()})})}show_summary(){let t=this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels:this.labels;this.legend_totals.map((e,s)=>{e&&(n.create("div",{className:"stats",inside:this.stats_wrapper}).innerHTML=`<span class="indicator">\n\t\t\t\t\t<i style="background: ${this.colors[s]}"></i>\n\t\t\t\t\t<span class="text-muted">${t[s]}:</span>\n\t\t\t\t\t${e}\n\t\t\t\t</span>`)})}},heatmap:class extends F{constructor({start:t="",domain:e="",subdomain:s="",data:i={},discrete_domains:a=0,count_label:n="",legend_colors:r=[]}){super(arguments[0]),this.type="heatmap",this.domain=e,this.subdomain=s,this.data=i,this.discrete_domains=a,this.count_label=n;let o=new Date;this.start=t||U(o,365),r=r.slice(0,5),this.legend_colors=this.validate_colors(r)?r:["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],this.distribution_size=5,this.translate_x=0,this.setup()}validate_colors(t){if(t.length<5)return 0;let e=1;return t.forEach(function(t){(function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)})(t)||(e=0,console.warn('"'+t+'" is not a valid color.'))},this),e}setup_base_values(){this.today=new Date,this.start||(this.start=new Date,this.start.setFullYear(this.start.getFullYear()-1)),this.first_week_start=new Date(this.start.toDateString()),this.last_week_start=new Date(this.today.toDateString()),7!==this.first_week_start.getDay()&&U(this.first_week_start,-1*this.first_week_start.getDay()),7!==this.last_week_start.getDay()&&U(this.last_week_start,-1*this.last_week_start.getDay()),this.no_of_cols=Y(this.first_week_start+"",this.last_week_start+"")+1}set_width(){this.base_width=12*(this.no_of_cols+3),this.discrete_domains&&(this.base_width+=144)}setup_components(){this.domain_label_group=this.makeDrawAreaComponent("domain-label-group chart-label"),this.data_groups=this.makeDrawAreaComponent("data-groups","translate(0, 20)")}setup_values(){this.domain_label_group.textContent="",this.data_groups.textContent="";let t=Object.keys(this.data).map(t=>this.data[t]);this.distribution=function(t,e){let s=Math.max(...t),i=1/(e-1),a=[];for(var n=0;n<e;n++){let t=s*(i*n);a.push(t)}return a}(t,this.distribution_size),this.month_names=["January","February","March","April","May","June","July","August","September","October","November","December"],this.render_all_weeks_and_store_x_values(this.no_of_cols)}render_all_weeks_and_store_x_values(t){let e=new Date(this.first_week_start);this.week_col=0,this.current_month=e.getMonth(),this.months=[this.current_month+""],this.month_weeks={},this.month_start_points=[],this.month_weeks[this.current_month]=0,this.month_start_points.push(13);for(var s=0;s<t;s++){let t,s=0,i=new Date(e);[t,s]=this.get_week_squares_group(i,this.week_col),this.data_groups.appendChild(t),this.week_col+=1+parseInt(this.discrete_domains&&s),this.month_weeks[this.current_month]++,s&&(this.current_month=(this.current_month+1)%12,this.months.push(this.current_month+""),this.month_weeks[this.current_month]=1),U(e,7)}this.render_month_labels()}get_week_squares_group(t,e){const s=this.today.getTime();let i=0,a=0,n=p(this.data_groups,"data-group");for(var r=0,o=0;o<7;o+=1,r+=12){let o=0,h=0,l=t.getTime()/1e3,_=Math.floor(l-l%86400).toFixed(1);this.data[_]&&(o=this.data[_]),this.data[Math.round(_)]&&(o=this.data[Math.round(_)]),o&&(h=A(o,this.distribution));let p=13+12*(e+a),c={"data-date":G(t),"data-value":o,"data-day":t.getDay()},u=d("day",p,r,10,this.legend_colors[h],c);n.appendChild(u);let m=new Date(t);if(U(m,1),m.getTime()>s)break;m.getMonth()-t.getMonth()&&(i=1,this.discrete_domains&&(a=1),this.month_start_points.push(13+12*(e+a))),t=m}return[n,i]}render_month_labels(){this.months.shift(),this.month_start_points.shift(),this.months.pop(),this.month_start_points.pop(),this.month_start_points.map((t,e)=>{let s=this.month_names[this.months[e]].substring(0,3),i=l("text",{className:"y-value-text",x:t+12,y:10,dy:".32em",innerHTML:s});this.domain_label_group.appendChild(i)})}make_graph_components(){Array.prototype.slice.call(this.container.querySelectorAll(".graph-stats-container, .sub-title, .title")).map(t=>{t.style.display="None"}),this.chart_wrapper.style.marginTop="0px",this.chart_wrapper.style.paddingTop="0px"}bind_tooltip(){Array.prototype.slice.call(document.querySelectorAll(".data-group .day")).map(t=>{t.addEventListener("mouseenter",t=>{let e=t.target.getAttribute("data-value"),s=t.target.getAttribute("data-date").split("-"),i=this.month_names[parseInt(s[1])-1].substring(0,3),a=this.chart_wrapper.getBoundingClientRect(),n=t.target.getBoundingClientRect(),r=parseInt(t.target.getAttribute("width")),o=n.left-a.left+(r+2)/2,h=n.top-a.top-(r+2)/2,l=e+" "+this.count_label,_=" on "+i+" "+s[0]+", "+s[2];this.tip.set_values(o,h,_,l,[],1),this.tip.show_tip()})})}update(t){this.data=t,this.setup_values(),this.bind_tooltip()}},pie:q};class X{constructor(t){return function(t="line",e){return J[t]?new J[t](e):new W(e)}(t.type,arguments[0])}}function V(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}e.default=class extends a.a.Component{constructor(t){super(t);const{caption:e,fields:s,data:i,colors:a}=t,n=i.reduce((t,e)=>(t.labels.push(e.date),s.forEach(({prop:s,propTitle:i,propFormat:a})=>{(t.datasets[i]=t.datasets[i]||[]).push(a(e[s]))}),t),{labels:[],datasets:{}});this.state={title:e,colors:a,data:{labels:n.labels,datasets:Object.entries(n.datasets).reduce((t,[e,s])=>(t.push({title:e,values:s}),t),[])}}}componentDidMount(){this._chart=new X(function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{},i=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable}))),i.forEach(function(e){V(t,e,s[e])})}return t}({parent:this.$chart},this.state,{type:"bar",height:250,format_tooltip_x:t=>(t+"").toUpperCase(),format_tooltip_y:t=>t+""}))}componentWillUnmount(){this._chart.destroy()}render(){return a.a.createElement("div",{ref:t=>this.$chart=t})}}},613:function(t,e,s){"use strict";s.r(e);var i=s(0),a=s.n(i),n=(s(653),s(650)),r=s(609);const o={"万":1,"亿":1e4};function h(t){return(o[t.slice(-1)]||1)*t.replace(/[^\d.]/g,"")}function l(t){return+t}e.default=class extends a.a.Component{constructor(t){super(t),this.state={}}componentDidMount(){this.fetchStock()}async fetchStock(){const{symbol:t,market:e}=this.props.stock,s=await Object(n.a)(`http://emweb.securities.eastmoney.com/PC_HSF10/FinanceAnalysis/MainTargetAjax?code=${e}${t}&type=1`),{Result:i}=await s.json();this.setState({stock:i.reverse()})}renderChart({caption:t,fields:e,colors:s}){const{stock:i}=this.state;return i&&i.length?a.a.createElement(r.default,{caption:t,fields:e,data:i,colors:s}):null}render(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{ref:t=>this.$chart=t}),this.renderChart({caption:"净资产收益率(%)",fields:[{prop:"jqjzcsyl",propTitle:"收益率",propFormat:l}],colors:["violet"]}),this.renderChart({caption:"归属净利润(万元)",fields:[{prop:"gsjlr",propTitle:"归属净利润",propFormat:h},{prop:"kfjlr",propTitle:"扣非净利润",propFormat:h}]}),this.renderChart({caption:"收入同比增长率(%)",fields:[{prop:"yyzsrtbzz",propTitle:"营业总收入同比增长率",propFormat:l},{prop:"gsjlrtbzz",propTitle:"归属净利润同比增长率",propFormat:l}]}))}}},650:function(t,e,s){"use strict";s.d(e,"d",function(){return a}),s.d(e,"a",function(){return n}),s.d(e,"b",function(){return r}),s.d(e,"c",function(){return o}),s.d(e,"e",function(){return h});const i=new TextDecoder("gbk");function a(t,e){return fetch("https://promise.rocks/go-api"+t,e)}function n(t){return fetch("https://promise.rocks/go-api/play/cors?"+t)}async function r(t,e=5){const s=`http://data.eastmoney.com/notices/getdata.ashx?StockCode=${t}&CodeType=1&PageIndex=1&PageSize=${e}&jsObj=a`,a=await n(s),r=await a.arrayBuffer(),o=new DataView(r),h=i.decode(o);return JSON.parse(h.slice(7,-1))}function o(){return sessionStorage.token}function h(t){sessionStorage.token=t}},653:function(t,e){!function(e){"use strict";var s,i=Object.prototype,a=i.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",h=n.toStringTag||"@@toStringTag",l="object"==typeof t,_=e.regeneratorRuntime;if(_)l&&(t.exports=_);else{(_=e.regeneratorRuntime=l?t.exports:{}).wrap=x;var p="suspendedStart",c="suspendedYield",u="executing",d="completed",m={},f={};f[r]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(T([])));y&&y!==i&&a.call(y,r)&&(f=y);var v=C.prototype=b.prototype=Object.create(f);k.prototype=v.constructor=C,C.constructor=k,C[h]=k.displayName="GeneratorFunction",_.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===k||"GeneratorFunction"===(e.displayName||e.name))},_.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,C):(t.__proto__=C,h in t||(t[h]="GeneratorFunction")),t.prototype=Object.create(v),t},_.awrap=function(t){return{__await:t}},L(A.prototype),A.prototype[o]=function(){return this},_.AsyncIterator=A,_.async=function(t,e,s,i){var a=new A(x(t,e,s,i));return _.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},L(v),v[h]="Generator",v[r]=function(){return this},v.toString=function(){return"[object Generator]"},_.keys=function(t){var e=[];for(var s in t)e.push(s);return e.reverse(),function s(){for(;e.length;){var i=e.pop();if(i in t)return s.value=i,s.done=!1,s}return s.done=!0,s}},_.values=T,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=s)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,a){return o.type="throw",o.arg=t,e.next=i,a&&(e.method="next",e.arg=s),!!a}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],o=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var h=a.call(r,"catchLoc"),l=a.call(r,"finallyLoc");if(h&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(h){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(t,e){for(var s=this.tryEntries.length-1;s>=0;--s){var i=this.tryEntries[s];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var r=n?n.completion:{};return r.type=t,r.arg=e,n?(this.method="next",this.next=n.finallyLoc,m):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var s=this.tryEntries[e];if(s.finallyLoc===t)return this.complete(s.completion,s.afterLoc),E(s),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var s=this.tryEntries[e];if(s.tryLoc===t){var i=s.completion;if("throw"===i.type){var a=i.arg;E(s)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:T(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=s),m}}}function x(t,e,s,i){var a=e&&e.prototype instanceof b?e:b,n=Object.create(a.prototype),r=new N(i||[]);return n._invoke=function(t,e,s){var i=p;return function(a,n){if(i===u)throw new Error("Generator is already running");if(i===d){if("throw"===a)throw n;return S()}for(s.method=a,s.arg=n;;){var r=s.delegate;if(r){var o=$(r,s);if(o){if(o===m)continue;return o}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(i===p)throw i=d,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);i=u;var h=w(t,e,s);if("normal"===h.type){if(i=s.done?d:c,h.arg===m)continue;return{value:h.arg,done:s.done}}"throw"===h.type&&(i=d,s.method="throw",s.arg=h.arg)}}}(t,s,r),n}function w(t,e,s){try{return{type:"normal",arg:t.call(e,s)}}catch(t){return{type:"throw",arg:t}}}function b(){}function k(){}function C(){}function L(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function A(t){var e;this._invoke=function(s,i){function n(){return new Promise(function(e,n){!function e(s,i,n,r){var o=w(t[s],t,i);if("throw"!==o.type){var h=o.arg,l=h.value;return l&&"object"==typeof l&&a.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,n,r)},function(t){e("throw",t,n,r)}):Promise.resolve(l).then(function(t){h.value=t,n(h)},r)}r(o.arg)}(s,i,e,n)})}return e=e?e.then(n,n):n()}}function $(t,e){var i=t.iterator[e.method];if(i===s){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=s,$(t,e),"throw"===e.method))return m;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=w(i,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,m;var n=a.arg;return n?n.done?(e[t.resultName]=n.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=s),e.delegate=null,m):n:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function T(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(a.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=s,e.done=!0,e};return n.next=n}}return{next:S}}function S(){return{value:s,done:!0}}}(function(){return this}()||Function("return this")())},697:function(t,e,s){}}]);
//# sourceMappingURL=13.c01f0a7a59a4dd2bede3.chunk.js.map
{"version":3,"sources":["webpack:///./app/lib/chart/js/utils/dom.js","webpack:///./app/lib/chart/js/utils/draw-utils.js","webpack:///./app/lib/chart/js/utils/draw.js","webpack:///./app/lib/chart/js/utils/animate.js","webpack:///./app/lib/chart/js/utils/animation.js","webpack:///./app/lib/chart/js/utils/intervals.js","webpack:///./app/lib/chart/js/utils/helpers.js","webpack:///./app/lib/chart/js/objects/SvgTip.js","webpack:///./app/lib/chart/js/utils/colors.js","webpack:///./app/lib/chart/js/charts/BaseChart.js","webpack:///./app/lib/chart/js/charts/AxisChart.js","webpack:///./app/lib/chart/js/charts/LineChart.js","webpack:///./app/lib/chart/js/charts/PieChart.js","webpack:///./app/lib/chart/js/utils/date-utils.js","webpack:///./app/lib/chart/js/charts.js","webpack:///./app/lib/chart/js/charts/BarChart.js","webpack:///./app/lib/chart/js/charts/ScatterChart.js","webpack:///./app/lib/chart/js/charts/PercentageChart.js","webpack:///./app/lib/chart/js/charts/Heatmap.js","webpack:///./app/components/containers/dynamic/stock/StockChart.js"],"names":["$","expr","con","document","querySelector","offset","element","rect","getBoundingClientRect","top","documentElement","scrollTop","body","left","scrollLeft","getBarHeightAndYAttr","yTop","zeroLine","totalHeight","height","y","createSVG","tag","o","createElementNS","i","val","appendChild","ref","parentNode","insertBefore","Object","keys","map","prop","style","setAttribute","setGradientStop","gradElem","color","opacity","makeSVGGroup","parent","className","transform","inside","makePath","pathStr","stroke","fill","d","styles","makeGradient","svgDefElem","lighter","gradientId","gradientDef","id","x1","x2","y1","y2","renderVerticalGradient","opacities","makeHeatSquare","x","size","data","args","width","key","makeXLine","textStartAt","point","labelClass","axisLineClass","xPos","line","text","dy","innerHTML","xLine","makeYLine","startAt","textEndAt","yPos","darker","lineType","yLine","create","createElement","bind","event","callback","split","forEach","addEventListener","unbind","removeEventListener","fire","target","type","properties","evt","createEvent","j","initEvent","dispatchEvent","UnitRenderer","avgUnitWidth","this","prototype","bar","index","datasetIndex","noOfDatasets","totalWidth","spaceWidth","currentX","dot","cx","cy","r","radius","Animator","barObj","start","dotObj","path","pathComponents","animPath","unit","object","push","regionPath","regStartPt","regEndPt","animRegion","EASING","ease","linear","easein","easeout","easeinout","webkitTransform","msTransform","mozTransform","oTransform","runSVGAnimation","svgContainer","elements","newElements","animElements","animElement","newElement","obj","props","dur","easingType","oldValues","cloneNode","attributeName","animateElement","currentValue","getAttribute","value","animAttr","from","to","begin","values","keySplines","keyTimes","calcMode","animateSVG","replaceChild","array","animSvg","normalize","isNaN","mantissa","exponent","sig","isFinite","Math","abs","exp","floor","log10","pow","getIntervals","maxValue","minValue","normalMaxValue","normalMinValue","intervals","max","min","upperBound","ceil","lowerBound","range","noOfParts","partSize","getRangeIntervals","toFixed","getMaxCheckpoint","distribution","filter","length","floatTwo","parseFloat","arraysEqual","arr1","arr2","areEqual","getStringWidth","string","charWidth","SvgTip","constructor","colors","title_name","title_value","list_values","title_value_first","setup","make_tooltip","refresh","calc_position","container","hide_tip","title","data_point_list","set","li","offsetWidth","offsetHeight","max_left","pointer","pointer_offset","set_values","show_tip","PRESET_COLOR_MAP","DEFAULT_COLORS","limitColor","getColor","ALL_CHART_TYPES","COMPATIBLE_CHARTS","pie","scatter","percentage","heatmap","COLOR_COMPATIBLE_CHARTS","BaseChart","subtitle","summary","is_navigable","has_legend","raw_chart_args","arguments","specific_values","current_index","setColors","set_margins","get_different_chart","includes","console","error","use_color","Chart","undefined","list","labels","datasets","base_height","translate_x","translate_y","validate_and_prepare_data","bind_window_events","window","destroy","init","setup_base_values","set_width","setup_container","setup_components","setup_values","setup_utils","make_graph_components","show_custom_summary","show_summary","setup_navigation","special_values_width","padding","str_width","base_width","getComputedStyle","paddingLeft","paddingRight","clientWidth","chart_wrapper","stats_wrapper","make_chart_area","make_draw_area","svg","svg_defs","draw_area","tip","bind_tooltip","stats","make_overlay","bind_overlay","e","el","bottom","innerHeight","clientHeight","right","innerWidth","isElementInViewport","keyCode","on_left_arrow","on_right_arrow","on_up_arrow","on_down_arrow","on_enter_key","bind_units","get_data_point","data_point","data_key","slice","label","update_current_data_point","parseInt","makeDrawAreaComponent","AxisChart","super","is_series","format_tooltip_y","format_tooltip_x","zero_line","setup_x","setup_y","set_avg_unit_width_and_x_offset","x_axis_positions","x_old_axis_positions","x_offset","avg_unit_width","y_axis_values","y_old_axis_values","get_all_y_values","y_sums","concat","withMinimum","getPositiveFirstIntervals","absMinValue","intervalSize","unshift","pseudoMaxValue","pseudoMinValue","reverse","calcIntervals","y_pts","value_range","multiplier","old_multiplier","interval","interval_height","zero_index","indexOf","old_zero_line","setup_marker_components","setup_aggregation_components","setup_graph_components","y_axis_group","x_axis_group","specific_y_group","sum_group","average_group","svg_units_groups","make_y_axis","make_x_axis","draw_graph","make_y_specifics","animate","start_at","text_start_at","axis_line_class","x_axis_mode","make_anim_x_axis","allowed_space","allowed_letters","textContent","space_taken","skips","make_anim_y_axis","make_anim_y_specifics","text_end_at","get_y_axis_line_props","specific","y_axis_mode","hasOwnProperty","draw_new_graph_and_animate","svg_units","make_path","y_tops","make_new_units","calc_y_dependencies","Array","setTimeout","update_values","make_new_units_for_dataset","x_values","y_values","dataset_index","no_of_datasets","units_group","units_array","unit_args","unit_renderer","data_unit","toUpperCase","line_type","relX","pageX","pageY","map_tooltip_x_position_and_show","y_min_tops","titles","y_format","x_val","show_sums","updating","sum_units","hide_sums","show_averages","old_specific_values","sum","average","auto","hide_averages","indices_to_remove","splice","new_y","new_x","elements_to_animate","old_x_values","old_y_axis_tops","old_y_values","no_of_extra_pts","animator","animate_graphs","run_animation","add_data_point","y_point","x_point","data_set","remove_data_point","anim_svg","removeChild","old_x","old_y","calc_old_and_new_postions","animate_path","animate_units","newPathStr","join","last_old_x_pos","last_old_y_pos","last_new_x_pos","last_new_y_pos","filler_x","filler_y","old_pos","new_pos","old_vals","new_vals","last_line_pos","make_new_axis_anim_lines","substring","x_line","add_and_animate_y_line","add_and_animate_line","group","superimposed_positions","superimposed_values","no_of_extras","filler_vals","filler_pos","extra_values","extra_positions","filler","new_props","old_props","axis_label_class","y_line","all_values","y_top","LineChart","show_dots","region_fill","getPrototypeOf","dot_radius","heatline","setup_path_groups","paths_groups","make_paths","x_positions","y_positions","points_str","gradient_id","fill_region_for_dataset","ANGLE_RATIO","PI","FULL_ANGLE","PieChart","hoverRadio","max_slices","max_legend_points","isAnimate","startAngle","clockWise","mouseMove","mouseLeave","centerX","centerY","slice_totals","all_totals","total","totals","sort","a","b","others","sum_of_others","legend_totals","angle","sin","cos","makeArcPath","startPosition","endPosition","grand_total","reduce","prevSlicesProperties","slicesProperties","slices","curAngle","originDiffAngle","diffAngle","endAngle","getPositionByAngle","prevProperty","curStart","curEnd","curPath","transition","calTranslateByAngle","property","position","hoverSlice","flag","amt","col","usePound","num","toString","lightenDarkenColor","g_off","formatted_labels","percent","prevIndex","curActiveSliceIndex","prevAcitve","curActiveSlice","treatAsUtc","dateStr","result","Date","setMinutes","getMinutes","getTimezoneOffset","getDdMmYyyy","date","dd","getDate","mm","getMonth","getFullYear","getWeeksBetween","startDateStr","endDateStr","getDaysBetween","addDays","numberOfDays","setDate","chartTypes","overlay","update_overlay","svg_unit","attributes","attr","specified","name","nodeValue","marginTop","marginBottom","paddingTop","chart_div","chart","percentage_bar","background","p_off","domain","subdomain","discrete_domains","count_label","legend_colors","today","validate_colors","distribution_size","valid","test","isValidColor","warn","setFullYear","first_week_start","toDateString","last_week_start","getDay","no_of_cols","domain_label_group","data_groups","data_values","distributionSize","dataMaxValue","distributionStep","checkpoint","calcDistribution","month_names","render_all_weeks_and_store_x_values","no_of_weeks","current_week_sunday","week_col","current_month","months","month_weeks","month_start_points","data_group","month_change","day","get_week_squares_group","render_month_labels","current_date","today_time","getTime","week_col_change","square_side","data_value","color_index","current_timestamp","timestamp","round","dataAttr","heatSquare","next_date","shift","pop","content","makeText","call","querySelectorAll","display","count","date_parts","month","update","chartType","options","getChartByType","Comp","React","Component","caption","fields","polished","p","v","propTitle","propFormat","state","entries","componentDidMount","_chart","$chart","componentWillUnmount","render"],"mappings":"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","file":"scripts/1.ac886dbba220ce1176da.chunk.js","sourcesContent":["export function $(expr, con) {\n\treturn typeof expr === \"string\"? (con || document).querySelector(expr) : expr || null;\n}\n\nexport function findNodeIndex(node)\n{\n\tvar i = 0;\n\twhile (node.previousSibling) {\n\t\tnode = node.previousSibling;\n\t\ti++;\n\t}\n\treturn i;\n}\n\n$.create = (tag, o) => {\n\tvar element = document.createElement(tag);\n\n\tfor (var i in o) {\n\t\tvar val = o[i];\n\n\t\tif (i === \"inside\") {\n\t\t\t$(val).appendChild(element);\n\t\t}\n\t\telse if (i === \"around\") {\n\t\t\tvar ref = $(val);\n\t\t\tref.parentNode.insertBefore(element, ref);\n\t\t\telement.appendChild(ref);\n\n\t\t} else if (i === \"styles\") {\n\t\t\tif(typeof val === \"object\") {\n\t\t\t\tObject.keys(val).map(prop => {\n\t\t\t\t\telement.style[prop] = val[prop];\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (i in element ) {\n\t\t\telement[i] = val;\n\t\t}\n\t\telse {\n\t\t\telement.setAttribute(i, val);\n\t\t}\n\t}\n\n\treturn element;\n};\n\nexport function offset(element) {\n\tlet rect = element.getBoundingClientRect();\n\treturn {\n\t\t// https://stackoverflow.com/a/7436602/6495043\n\t\t// rect.top varies with scroll, so we add whatever has been\n\t\t// scrolled to it to get absolute distance from actual page top\n\t\ttop: rect.top + (document.documentElement.scrollTop || document.body.scrollTop),\n\t\tleft: rect.left + (document.documentElement.scrollLeft || document.body.scrollLeft)\n\t};\n}\n\nexport function isElementInViewport(el) {\n\t// Although straightforward: https://stackoverflow.com/a/7557433/6495043\n\tvar rect = el.getBoundingClientRect();\n\n\treturn (\n\t\trect.top >= 0 &&\n        rect.left >= 0 &&\n        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) && /*or $(window).height() */\n        rect.right <= (window.innerWidth || document.documentElement.clientWidth) /*or $(window).width() */\n\t);\n}\n\nexport function getElementContentWidth(element) {\n\tvar styles = window.getComputedStyle(element);\n\tvar padding = parseFloat(styles.paddingLeft) +\n\t\tparseFloat(styles.paddingRight);\n\n\treturn element.clientWidth - padding;\n}\n\n$.bind = (element, o) => {\n\tif (element) {\n\t\tfor (var event in o) {\n\t\t\tvar callback = o[event];\n\n\t\t\tevent.split(/\\s+/).forEach(function (event) {\n\t\t\t\telement.addEventListener(event, callback);\n\t\t\t});\n\t\t}\n\t}\n};\n\n$.unbind = (element, o) => {\n\tif (element) {\n\t\tfor (var event in o) {\n\t\t\tvar callback = o[event];\n\n\t\t\tevent.split(/\\s+/).forEach(function(event) {\n\t\t\t\telement.removeEventListener(event, callback);\n\t\t\t});\n\t\t}\n\t}\n};\n\n$.fire = (target, type, properties) => {\n\tvar evt = document.createEvent(\"HTMLEvents\");\n\n\tevt.initEvent(type, true, true );\n\n\tfor (var j in properties) {\n\t\tevt[j] = properties[j];\n\t}\n\n\treturn target.dispatchEvent(evt);\n};\n","export function getBarHeightAndYAttr(yTop, zeroLine, totalHeight) {\n\tlet height, y;\n\tif (yTop <= zeroLine) {\n\t\theight = zeroLine - yTop;\n\t\ty = yTop;\n\n\t\t// In case of invisible bars\n\t\tif(height === 0) {\n\t\t\theight = totalHeight * 0.01;\n\t\t\ty -= height;\n\t\t}\n\t} else {\n\t\theight = yTop - zeroLine;\n\t\ty = zeroLine;\n\n\t\t// In case of invisible bars\n\t\tif(height === 0) {\n\t\t\theight = totalHeight * 0.01;\n\t\t}\n\t}\n\n\treturn [height, y];\n}\n","import { getBarHeightAndYAttr } from './draw-utils';\n\n// Constants used\n\nfunction $(expr, con) {\n\treturn typeof expr === \"string\"? (con || document).querySelector(expr) : expr || null;\n}\n\nfunction createSVG(tag, o) {\n\tvar element = document.createElementNS(\"http://www.w3.org/2000/svg\", tag);\n\n\tfor (var i in o) {\n\t\tvar val = o[i];\n\n\t\tif (i === \"inside\") {\n\t\t\t$(val).appendChild(element);\n\t\t}\n\t\telse if (i === \"around\") {\n\t\t\tvar ref = $(val);\n\t\t\tref.parentNode.insertBefore(element, ref);\n\t\t\telement.appendChild(ref);\n\n\t\t} else if (i === \"styles\") {\n\t\t\tif(typeof val === \"object\") {\n\t\t\t\tObject.keys(val).map(prop => {\n\t\t\t\t\telement.style[prop] = val[prop];\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif(i === \"className\") { i = \"class\"; }\n\t\t\tif(i === \"innerHTML\") {\n\t\t\t\telement['textContent'] = val;\n\t\t\t} else {\n\t\t\t\telement.setAttribute(i, val);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn element;\n}\n\nfunction renderVerticalGradient(svgDefElem, gradientId) {\n\treturn createSVG('linearGradient', {\n\t\tinside: svgDefElem,\n\t\tid: gradientId,\n\t\tx1: 0,\n\t\tx2: 0,\n\t\ty1: 0,\n\t\ty2: 1\n\t});\n}\n\nfunction setGradientStop(gradElem, offset, color, opacity) {\n\treturn createSVG('stop', {\n\t\t'inside': gradElem,\n\t\t'style': `stop-color: ${color}`,\n\t\t'offset': offset,\n\t\t'stop-opacity': opacity\n\t});\n}\n\nexport function makeSVGContainer(parent, className, width, height) {\n\treturn createSVG('svg', {\n\t\tclassName: className,\n\t\tinside: parent,\n\t\twidth: width,\n\t\theight: height\n\t});\n}\n\nexport function makeSVGDefs(svgContainer) {\n\treturn createSVG('defs', {\n\t\tinside: svgContainer,\n\t});\n}\n\nexport function makeSVGGroup(parent, className, transform='') {\n\treturn createSVG('g', {\n\t\tclassName: className,\n\t\tinside: parent,\n\t\ttransform: transform\n\t});\n}\n\nexport function makePath(pathStr, className='', stroke='none', fill='none') {\n\treturn createSVG('path', {\n\t\tclassName: className,\n\t\td: pathStr,\n\t\tstyles: {\n\t\t\tstroke: stroke,\n\t\t\tfill: fill\n\t\t}\n\t});\n}\n\nexport function makeGradient(svgDefElem, color, lighter = false) {\n\tlet gradientId ='path-fill-gradient' + '-' + color;\n\tlet gradientDef = renderVerticalGradient(svgDefElem, gradientId);\n\tlet opacities = [1, 0.6, 0.2];\n\tif(lighter) {\n\t\topacities = [0.4, 0.2, 0];\n\t}\n\n\tsetGradientStop(gradientDef, \"0%\", color, opacities[0]);\n\tsetGradientStop(gradientDef, \"50%\", color, opacities[1]);\n\tsetGradientStop(gradientDef, \"100%\", color, opacities[2]);\n\n\treturn gradientId;\n}\n\nexport function makeHeatSquare(className, x, y, size, fill='none', data={}) {\n\tlet args = {\n\t\tclassName: className,\n\t\tx: x,\n\t\ty: y,\n\t\twidth: size,\n\t\theight: size,\n\t\tfill: fill\n\t};\n\n\tObject.keys(data).map(key => {\n\t\targs[key] = data[key];\n\t});\n\n\treturn createSVG(\"rect\", args);\n}\n\nexport function makeText(className, x, y, content) {\n\treturn createSVG('text', {\n\t\tclassName: className,\n\t\tx: x,\n\t\ty: y,\n\t\tdy: '.32em',\n\t\tinnerHTML: content\n\t});\n}\n\nexport function makeXLine(height, textStartAt, point, labelClass, axisLineClass, xPos) {\n\tlet line = createSVG('line', {\n\t\tx1: 0,\n\t\tx2: 0,\n\t\ty1: 0,\n\t\ty2: height\n\t});\n\n\tlet text = createSVG('text', {\n\t\tclassName: labelClass,\n\t\tx: 0,\n\t\ty: textStartAt,\n\t\tdy: '.71em',\n\t\tinnerHTML: point\n\t});\n\n\tlet xLine = createSVG('g', {\n\t\tclassName: `tick ${axisLineClass}`,\n\t\ttransform: `translate(${ xPos }, 0)`\n\t});\n\n\txLine.appendChild(line);\n\txLine.appendChild(text);\n\n\treturn xLine;\n}\n\nexport function makeYLine(startAt, width, textEndAt, point, labelClass, axisLineClass, yPos, darker=false, lineType=\"\") {\n\tlet line = createSVG('line', {\n\t\tclassName: lineType === \"dashed\" ? \"dashed\": \"\",\n\t\tx1: startAt,\n\t\tx2: width,\n\t\ty1: 0,\n\t\ty2: 0\n\t});\n\n\tlet text = createSVG('text', {\n\t\tclassName: labelClass,\n\t\tx: textEndAt,\n\t\ty: 0,\n\t\tdy: '.32em',\n\t\tinnerHTML: point+\"\"\n\t});\n\n\tlet yLine = createSVG('g', {\n\t\tclassName: `tick ${axisLineClass}`,\n\t\ttransform: `translate(0, ${yPos})`,\n\t\t'stroke-opacity': 1\n\t});\n\n\tif(darker) {\n\t\tline.style.stroke = \"rgba(27, 31, 35, 0.6)\";\n\t}\n\n\tyLine.appendChild(line);\n\tyLine.appendChild(text);\n\n\treturn yLine;\n}\n\nexport var UnitRenderer = (function() {\n\tvar UnitRenderer = function(totalHeight, zeroLine, avgUnitWidth) {\n\t\tthis.totalHeight = totalHeight;\n\t\tthis.zeroLine = zeroLine;\n\t\tthis.avgUnitWidth = avgUnitWidth;\n\t};\n\n\tUnitRenderer.prototype = {\n\t\tbar: function (x, yTop, args, color, index, datasetIndex, noOfDatasets) {\n\t\t\tlet totalWidth = this.avgUnitWidth - args.spaceWidth;\n\t\t\tlet startX = x - totalWidth/2;\n\n\t\t\tlet width = totalWidth / noOfDatasets;\n\t\t\tlet currentX = startX + width * datasetIndex;\n\n\t\t\tlet [height, y] = getBarHeightAndYAttr(yTop, this.zeroLine, this.totalHeight);\n\n\t\t\treturn createSVG('rect', {\n\t\t\t\tclassName: `bar mini`,\n\t\t\t\tstyle: `fill: ${color}`,\n\t\t\t\t'data-point-index': index,\n\t\t\t\tx: currentX,\n\t\t\t\ty: y,\n\t\t\t\twidth: width,\n\t\t\t\theight: height\n\t\t\t});\n\t\t},\n\n\t\tdot: function(x, y, args, color, index) {\n\t\t\treturn createSVG('circle', {\n\t\t\t\tstyle: `fill: ${color}`,\n\t\t\t\t'data-point-index': index,\n\t\t\t\tcx: x,\n\t\t\t\tcy: y,\n\t\t\t\tr: args.radius\n\t\t\t});\n\t\t}\n\t};\n\n\treturn UnitRenderer;\n})();\n","import { getBarHeightAndYAttr } from './draw-utils';\n\nexport function getAnimXLine() {}\n\nexport function getAnimYLine() {}\n\nexport var Animator = (function() {\n\tvar Animator = function(totalHeight, totalWidth, zeroLine, avgUnitWidth) {\n\t\t// constants\n\t\tthis.totalHeight = totalHeight;\n\t\tthis.totalWidth = totalWidth;\n\n\t\t// changeables\n\t\tthis.avgUnitWidth = avgUnitWidth;\n\t\tthis.zeroLine = zeroLine;\n\t};\n\n\tAnimator.prototype = {\n\t\tbar: function(barObj, x, yTop, index, noOfDatasets) {\n\t\t\tlet start = x - this.avgUnitWidth/4;\n\t\t\tlet width = (this.avgUnitWidth/2)/noOfDatasets;\n\t\t\tlet [height, y] = getBarHeightAndYAttr(yTop, this.zeroLine, this.totalHeight);\n\n\t\t\tx = start + (width * index);\n\n\t\t\treturn [barObj, {width: width, height: height, x: x, y: y}, 350, \"easein\"];\n\t\t\t// bar.animate({height: args.newHeight, y: yTop}, 350, mina.easein);\n\t\t},\n\n\t\tdot: function(dotObj, x, yTop) {\n\t\t\treturn [dotObj, {cx: x, cy: yTop}, 350, \"easein\"];\n\t\t\t// dot.animate({cy: yTop}, 350, mina.easein);\n\t\t},\n\n\t\tpath: function(d, pathStr) {\n\t\t\tlet pathComponents = [];\n\t\t\tconst animPath = [{unit: d.path, object: d, key: 'path'}, {d:\"M\"+pathStr}, 350, \"easein\"];\n\t\t\tpathComponents.push(animPath);\n\n\t\t\tif(d.regionPath) {\n\t\t\t\tlet regStartPt = `0,${this.zeroLine}L`;\n\t\t\t\tlet regEndPt = `L${this.totalWidth}, ${this.zeroLine}`;\n\n\t\t\t\tconst animRegion = [\n\t\t\t\t\t{unit: d.regionPath, object: d, key: 'regionPath'},\n\t\t\t\t\t{d:\"M\" + regStartPt + pathStr + regEndPt},\n\t\t\t\t\t350,\n\t\t\t\t\t\"easein\"\n\t\t\t\t];\n\t\t\t\tpathComponents.push(animRegion);\n\t\t\t}\n\n\t\t\treturn pathComponents;\n\t\t},\n\t};\n\n\treturn Animator;\n})();\n","// Leveraging SMIL Animations\n\nconst EASING = {\n\tease: \"0.25 0.1 0.25 1\",\n\tlinear: \"0 0 1 1\",\n\t// easein: \"0.42 0 1 1\",\n\teasein: \"0.1 0.8 0.2 1\",\n\teaseout: \"0 0 0.58 1\",\n\teaseinout: \"0.42 0 0.58 1\"\n};\n\nfunction animateSVG(element, props, dur, easingType=\"linear\", type=undefined, oldValues={}) {\n\n\tlet animElement = element.cloneNode(true);\n\tlet newElement = element.cloneNode(true);\n\n\tfor(var attributeName in props) {\n\t\tlet animateElement;\n\t\tif(attributeName === 'transform') {\n\t\t\tanimateElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"animateTransform\");\n\t\t} else {\n\t\t\tanimateElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"animate\");\n\t\t}\n\t\tlet currentValue = oldValues[attributeName] || element.getAttribute(attributeName);\n\t\tlet value = props[attributeName];\n\n\t\tlet animAttr = {\n\t\t\tattributeName: attributeName,\n\t\t\tfrom: currentValue,\n\t\t\tto: value,\n\t\t\tbegin: \"0s\",\n\t\t\tdur: dur/1000 + \"s\",\n\t\t\tvalues: currentValue + \";\" + value,\n\t\t\tkeySplines: EASING[easingType],\n\t\t\tkeyTimes: \"0;1\",\n\t\t\tcalcMode: \"spline\",\n\t\t\tfill: 'freeze'\n\t\t};\n\n\t\tif(type) {\n\t\t\tanimAttr[\"type\"] = type;\n\t\t}\n\n\t\tfor (var i in animAttr) {\n\t\t\tanimateElement.setAttribute(i, animAttr[i]);\n\t\t}\n\n\t\tanimElement.appendChild(animateElement);\n\n\t\tif(type) {\n\t\t\tnewElement.setAttribute(attributeName, `translate(${value})`);\n\t\t} else {\n\t\t\tnewElement.setAttribute(attributeName, value);\n\t\t}\n\t}\n\n\treturn [animElement, newElement];\n}\n\nexport function transform(element, style) { // eslint-disable-line no-unused-vars\n\telement.style.transform = style;\n\telement.style.webkitTransform = style;\n\telement.style.msTransform = style;\n\telement.style.mozTransform = style;\n\telement.style.oTransform = style;\n}\n\nexport function runSVGAnimation(svgContainer, elements) {\n\tlet newElements = [];\n\tlet animElements = [];\n\n\telements.map(element => {\n\t\tlet obj = element[0];\n\t\tlet parent = obj.unit.parentNode;\n\n\t\tlet animElement, newElement;\n\n\t\telement[0] = obj.unit;\n\t\t[animElement, newElement] = animateSVG(...element);\n\n\t\tnewElements.push(newElement);\n\t\tanimElements.push([animElement, parent]);\n\n\t\tparent.replaceChild(animElement, obj.unit);\n\n\t\tif(obj.array) {\n\t\t\tobj.array[obj.index] = newElement;\n\t\t} else {\n\t\t\tobj.object[obj.key] = newElement;\n\t\t}\n\t});\n\n\tlet animSvg = svgContainer.cloneNode(true);\n\n\tanimElements.map((animElement, i) => {\n\t\tanimElement[1].replaceChild(newElements[i], animElement[0]);\n\t\telements[i][0] = newElements[i];\n\t});\n\n\treturn animSvg;\n}\n","function normalize(x) {\n\t// Calculates mantissa and exponent of a number\n\t// Returns normalized number and exponent\n\t// https://stackoverflow.com/q/9383593/6495043\n\n\tif(x===0) {\n\t\treturn [0, 0];\n\t}\n\tif(isNaN(x)) {\n\t\treturn {mantissa: -6755399441055744, exponent: 972};\n\t}\n\tvar sig = x > 0 ? 1 : -1;\n\tif(!isFinite(x)) {\n\t\treturn {mantissa: sig * 4503599627370496, exponent: 972};\n\t}\n\n\tx = Math.abs(x);\n\tvar exp = Math.floor(Math.log10(x));\n\tvar man = x/Math.pow(10, exp);\n\n\treturn [sig * man, exp];\n}\n\nfunction getRangeIntervals(max, min=0) {\n\tlet upperBound = Math.ceil(max);\n\tlet lowerBound = Math.floor(min);\n\tlet range = upperBound - lowerBound;\n\n\tlet noOfParts = range;\n\tlet partSize = 1;\n\n\t// To avoid too many partitions\n\tif(range > 5) {\n\t\tif(range % 2 !== 0) {\n\t\t\tupperBound++;\n\t\t\t// Recalc range\n\t\t\trange = upperBound - lowerBound;\n\t\t}\n\t\tnoOfParts = range/2;\n\t\tpartSize = 2;\n\t}\n\n\t// Special case: 1 and 2\n\tif(range <= 2) {\n\t\tnoOfParts = 4;\n\t\tpartSize = range/noOfParts;\n\t}\n\n\t// Special case: 0\n\tif(range === 0) {\n\t\tnoOfParts = 5;\n\t\tpartSize = 1;\n\t}\n\n\tlet intervals = [];\n\tfor(var i = 0; i <= noOfParts; i++){\n\t\tintervals.push(lowerBound + partSize * i);\n\t}\n\treturn intervals;\n}\n\nfunction getIntervals(maxValue, minValue=0) {\n\tlet [normalMaxValue, exponent] = normalize(maxValue);\n\tlet normalMinValue = minValue ? minValue/Math.pow(10, exponent): 0;\n\n\t// Allow only 7 significant digits\n\tnormalMaxValue = normalMaxValue.toFixed(6);\n\n\tlet intervals = getRangeIntervals(normalMaxValue, normalMinValue);\n\tintervals = intervals.map(value => value * Math.pow(10, exponent));\n\treturn intervals;\n}\n\nexport function calcIntervals(values, withMinimum=false) {\n\t//*** Where the magic happens ***\n\n\t// Calculates best-fit y intervals from given values\n\t// and returns the interval array\n\n\tlet maxValue = Math.max(...values);\n\tlet minValue = Math.min(...values);\n\n\t// Exponent to be used for pretty print\n\tlet exponent = 0, intervals = []; // eslint-disable-line no-unused-vars\n\n\tfunction getPositiveFirstIntervals(maxValue, absMinValue) {\n\t\tlet intervals = getIntervals(maxValue);\n\n\t\tlet intervalSize = intervals[1] - intervals[0];\n\n\t\t// Then unshift the negative values\n\t\tlet value = 0;\n\t\tfor(var i = 1; value < absMinValue; i++) {\n\t\t\tvalue += intervalSize;\n\t\t\tintervals.unshift((-1) * value);\n\t\t}\n\t\treturn intervals;\n\t}\n\n\t// CASE I: Both non-negative\n\n\tif(maxValue >= 0 && minValue >= 0) {\n\t\texponent = normalize(maxValue)[1];\n\t\tif(!withMinimum) {\n\t\t\tintervals = getIntervals(maxValue);\n\t\t} else {\n\t\t\tintervals = getIntervals(maxValue, minValue);\n\t\t}\n\t}\n\n\t// CASE II: Only minValue negative\n\n\telse if(maxValue > 0 && minValue < 0) {\n\t\t// `withMinimum` irrelevant in this case,\n\t\t// We'll be handling both sides of zero separately\n\t\t// (both starting from zero)\n\t\t// Because ceil() and floor() behave differently\n\t\t// in those two regions\n\n\t\tlet absMinValue = Math.abs(minValue);\n\n\t\tif(maxValue >= absMinValue) {\n\t\t\texponent = normalize(maxValue)[1];\n\t\t\tintervals = getPositiveFirstIntervals(maxValue, absMinValue);\n\t\t} else {\n\t\t\t// Mirror: maxValue => absMinValue, then change sign\n\t\t\texponent = normalize(absMinValue)[1];\n\t\t\tlet posIntervals = getPositiveFirstIntervals(absMinValue, maxValue);\n\t\t\tintervals = posIntervals.map(d => d * (-1));\n\t\t}\n\n\t}\n\n\t// CASE III: Both non-positive\n\n\telse if(maxValue <= 0 && minValue <= 0) {\n\t\t// Mirrored Case I:\n\t\t// Work with positives, then reverse the sign and array\n\n\t\tlet pseudoMaxValue = Math.abs(minValue);\n\t\tlet pseudoMinValue = Math.abs(maxValue);\n\n\t\texponent = normalize(pseudoMaxValue)[1];\n\t\tif(!withMinimum) {\n\t\t\tintervals = getIntervals(pseudoMaxValue);\n\t\t} else {\n\t\t\tintervals = getIntervals(pseudoMaxValue, pseudoMinValue);\n\t\t}\n\n\t\tintervals = intervals.reverse().map(d => d * (-1));\n\t}\n\n\treturn intervals;\n}\n\nexport function calcDistribution(values, distributionSize) {\n\t// Assume non-negative values,\n\t// implying distribution minimum at zero\n\n\tlet dataMaxValue = Math.max(...values);\n\n\tlet distributionStep = 1 / (distributionSize - 1);\n\tlet distribution = [];\n\n\tfor(var i = 0; i < distributionSize; i++) {\n\t\tlet checkpoint = dataMaxValue * (distributionStep * i);\n\t\tdistribution.push(checkpoint);\n\t}\n\n\treturn distribution;\n}\n\nexport function getMaxCheckpoint(value, distribution) {\n\treturn distribution.filter(d => d < value).length;\n}\n","/**\n * Returns the value of a number upto 2 decimal places.\n * @param {Number} d Any number\n */\nexport function floatTwo(d) {\n\treturn parseFloat(d.toFixed(2));\n}\n\n/**\n * Returns whether or not two given arrays are equal.\n * @param {Array} arr1 First array\n * @param {Array} arr2 Second array\n */\nexport function arraysEqual(arr1, arr2) {\n\tif(arr1.length !== arr2.length) return false;\n\tlet areEqual = true;\n\tarr1.map((d, i) => {\n\t\tif(arr2[i] !== d) areEqual = false;\n\t});\n\treturn areEqual;\n}\n\n/**\n * Shuffles array in place. ES6 version\n * @param {Array} array An array containing the items.\n */\nexport function shuffle(array) {\n\t// Awesomeness: https://bost.ocks.org/mike/shuffle/\n\t// https://stackoverflow.com/a/2450976/6495043\n\t// https://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array?noredirect=1&lq=1\n\n\tfor (let i = array.length - 1; i > 0; i--) {\n\t\tlet j = Math.floor(Math.random() * (i + 1));\n\t\t[array[i], array[j]] = [array[j], array[i]];\n\t}\n\n\treturn array;\n}\n\n/**\n * Returns pixel width of string.\n * @param {String} string\n * @param {Number} charWidth Width of single char in pixels\n */\nexport function getStringWidth(string, charWidth) {\n\treturn (string+\"\").length * charWidth;\n}\n","import { $ } from '../utils/dom';\n\nexport default class SvgTip {\n\tconstructor({\n\t\tparent = null,\n\t\tcolors = []\n\t}) {\n\t\tthis.parent = parent;\n\t\tthis.colors = colors;\n\t\tthis.title_name = '';\n\t\tthis.title_value = '';\n\t\tthis.list_values = [];\n\t\tthis.title_value_first = 0;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\n\t\tthis.top = 0;\n\t\tthis.left = 0;\n\n\t\tthis.setup();\n\t}\n\n\tsetup() {\n\t\tthis.make_tooltip();\n\t}\n\n\trefresh() {\n\t\tthis.fill();\n\t\tthis.calc_position();\n\t\t// this.show_tip();\n\t}\n\n\tmake_tooltip() {\n\t\tthis.container = $.create('div', {\n\t\t\tinside: this.parent,\n\t\t\tclassName: 'graph-svg-tip comparison',\n\t\t\tinnerHTML: `<span class=\"title\"></span>\n\t\t\t\t<ul class=\"data-point-list\"></ul>\n\t\t\t\t<div class=\"svg-pointer\"></div>`\n\t\t});\n\t\tthis.hide_tip();\n\n\t\tthis.title = this.container.querySelector('.title');\n\t\tthis.data_point_list = this.container.querySelector('.data-point-list');\n\n\t\tthis.parent.addEventListener('mouseleave', () => {\n\t\t\tthis.hide_tip();\n\t\t});\n\t}\n\n\tfill() {\n\t\tlet title;\n\t\tif(this.title_value_first) {\n\t\t\ttitle = `<strong>${this.title_value}</strong>${this.title_name}`;\n\t\t} else {\n\t\t\ttitle = `${this.title_name}<strong>${this.title_value}</strong>`;\n\t\t}\n\t\tthis.title.innerHTML = title;\n\t\tthis.data_point_list.innerHTML = '';\n\n\t\tthis.list_values.map((set, i) => {\n\t\t\tconst color = this.colors[i] || 'black';\n\n\t\t\tlet li = $.create('li', {\n\t\t\t\tstyles: {\n\t\t\t\t\t'border-top': `3px solid ${color}`\n\t\t\t\t},\n\t\t\t\tinnerHTML: `<strong style=\"display: block;\">${ set.value === 0 || set.value ? set.value : '' }</strong>\n\t\t\t\t\t${set.title ? set.title : '' }`\n\t\t\t});\n\n\t\t\tthis.data_point_list.appendChild(li);\n\t\t});\n\t}\n\n\tcalc_position() {\n\t\tlet width = this.container.offsetWidth;\n\n\t\tthis.top = this.y - this.container.offsetHeight;\n\t\tthis.left = this.x - width/2;\n\t\tlet max_left = this.parent.offsetWidth - width;\n\n\t\tlet pointer = this.container.querySelector('.svg-pointer');\n\n\t\tif(this.left < 0) {\n\t\t\tpointer.style.left = `calc(50% - ${-1 * this.left}px)`;\n\t\t\tthis.left = 0;\n\t\t} else if(this.left > max_left) {\n\t\t\tlet delta = this.left - max_left;\n\t\t\tlet pointer_offset = `calc(50% + ${delta}px)`;\n\t\t\tpointer.style.left = pointer_offset;\n\n\t\t\tthis.left = max_left;\n\t\t} else {\n\t\t\tpointer.style.left = `50%`;\n\t\t}\n\t}\n\n\tset_values(x, y, title_name = '', title_value = '', list_values = [], title_value_first = 0) {\n\t\tthis.title_name = title_name;\n\t\tthis.title_value = title_value;\n\t\tthis.list_values = list_values;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.title_value_first = title_value_first;\n\t\tthis.refresh();\n\t}\n\n\thide_tip() {\n\t\tthis.container.style.top = '0px';\n\t\tthis.container.style.left = '0px';\n\t\tthis.container.style.opacity = '0';\n\t}\n\n\tshow_tip() {\n\t\tthis.container.style.top = this.top + 'px';\n\t\tthis.container.style.left = this.left + 'px';\n\t\tthis.container.style.opacity = '1';\n\t}\n}\n","const PRESET_COLOR_MAP = {\n\t'light-blue': '#7cd6fd',\n\t'blue': '#5e64ff',\n\t'violet': '#743ee2',\n\t'red': '#ff5858',\n\t'orange': '#ffa00a',\n\t'yellow': '#feef72',\n\t'green': '#28a745',\n\t'light-green': '#98d85b',\n\t'purple': '#b554ff',\n\t'magenta': '#ffa3ef',\n\t'black': '#36114C',\n\t'grey': '#bdd3e6',\n\t'light-grey': '#f0f4f7',\n\t'dark-grey': '#b8c2cc'\n};\n\nexport const DEFAULT_COLORS = ['light-blue', 'blue', 'violet', 'red', 'orange',\n\t'yellow', 'green', 'light-green', 'purple', 'magenta'];\n\nfunction limitColor(r){\n\tif (r > 255) return 255;\n\telse if (r < 0) return 0;\n\treturn r;\n}\n\nexport function lightenDarkenColor(color, amt) {\n\tlet col = getColor(color);\n\tlet usePound = false;\n\tif (col[0] == \"#\") {\n\t\tcol = col.slice(1);\n\t\tusePound = true;\n\t}\n\tlet num = parseInt(col,16);\n\tlet r = limitColor((num >> 16) + amt);\n\tlet b = limitColor(((num >> 8) & 0x00FF) + amt);\n\tlet g = limitColor((num & 0x0000FF) + amt);\n\treturn (usePound?\"#\":\"\") + (g | (b << 8) | (r << 16)).toString(16);\n}\n\nexport function isValidColor(string) {\n\t// https://stackoverflow.com/a/8027444/6495043\n\treturn /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(string);\n}\n\nexport const getColor = (color) => {\n\treturn PRESET_COLOR_MAP[color] || color;\n};\n","import SvgTip from '../objects/SvgTip';\nimport { $, isElementInViewport, getElementContentWidth } from '../utils/dom';\nimport { makeSVGContainer, makeSVGDefs, makeSVGGroup } from '../utils/draw';\nimport { getStringWidth } from '../utils/helpers';\nimport { getColor, DEFAULT_COLORS } from '../utils/colors';\nimport Chart from '../charts';\n\nconst ALL_CHART_TYPES = ['line', 'scatter', 'bar', 'percentage', 'heatmap', 'pie'];\n\nconst COMPATIBLE_CHARTS = {\n\tbar: ['line', 'scatter', 'percentage', 'pie'],\n\tline: ['scatter', 'bar', 'percentage', 'pie'],\n\tpie: ['line', 'scatter', 'percentage', 'bar'],\n\tscatter: ['line', 'bar', 'percentage', 'pie'],\n\tpercentage: ['bar', 'line', 'scatter', 'pie'],\n\theatmap: []\n};\n\n// TODO: Needs structure as per only labels/datasets\nconst COLOR_COMPATIBLE_CHARTS = {\n\tbar: ['line', 'scatter'],\n\tline: ['scatter', 'bar'],\n\tpie: ['percentage'],\n\tscatter: ['line', 'bar'],\n\tpercentage: ['pie'],\n\theatmap: []\n};\n\nexport default class BaseChart {\n\tconstructor({\n\t\theight = 240,\n\n\t\ttitle = '',\n\t\tsubtitle = '',\n\t\tcolors = [],\n\t\tsummary = [],\n\n\t\tis_navigable = 0,\n\t\thas_legend = 0,\n\n\t\ttype = '',\n\n\t\tparent,\n\t\tdata\n\t}) {\n    this.refresh = this.refresh.bind(this);\n\t\tthis.raw_chart_args = arguments[0];\n\n\t\tthis.parent = typeof parent === 'string' ? document.querySelector(parent) : parent;\n\t\tthis.title = title;\n\t\tthis.subtitle = subtitle;\n\n\t\tthis.data = data;\n\n\t\tthis.specific_values = data.specific_values || [];\n\t\tthis.summary = summary;\n\n\t\tthis.is_navigable = is_navigable;\n\t\tif(this.is_navigable) {\n\t\t\tthis.current_index = 0;\n\t\t}\n\t\tthis.has_legend = has_legend;\n\n\t\tthis.setColors(colors, type);\n\t\tthis.set_margins(height);\n\t}\n\n\tget_different_chart(type) {\n\t\tif(type === this.type) return;\n\n\t\tif(!ALL_CHART_TYPES.includes(type)) {\n\t\t\tconsole.error(`'${type}' is not a valid chart type.`);\n\t\t}\n\n\t\tif(!COMPATIBLE_CHARTS[this.type].includes(type)) {\n\t\t\tconsole.error(`'${this.type}' chart cannot be converted to a '${type}' chart.`);\n\t\t}\n\n\t\t// whether the new chart can use the existing colors\n\t\tconst use_color = COLOR_COMPATIBLE_CHARTS[this.type].includes(type);\n\n\t\t// Okay, this is anticlimactic\n\t\t// this function will need to actually be 'change_chart_type(type)'\n\t\t// that will update only the required elements, but for now ...\n\t\treturn new Chart({\n\t\t\tparent: this.raw_chart_args.parent,\n\t\t\ttitle: this.title,\n\t\t\tdata: this.raw_chart_args.data,\n\t\t\ttype: type,\n\t\t\theight: this.raw_chart_args.height,\n\t\t\tcolors: use_color ? this.colors : undefined\n\t\t});\n\t}\n\n\tsetColors(colors, type) {\n\t\tthis.colors = colors;\n\n\t\t// TODO: Needs structure as per only labels/datasets\n\t\tconst list = type === 'percentage' || type === 'pie'\n\t\t\t? this.data.labels\n\t\t\t: this.data.datasets;\n\n\t\tif(!this.colors || (list && this.colors.length < list.length)) {\n\t\t\tthis.colors = DEFAULT_COLORS;\n\t\t}\n\n\t\tthis.colors = this.colors.map(color => getColor(color));\n\t}\n\n\tset_margins(height) {\n\t\tthis.base_height = height;\n\t\tthis.height = height - 40;\n\t\tthis.translate_x = 60;\n\t\tthis.translate_y = 10;\n\t}\n\n\tsetup() {\n\t\tif(!this.parent) {\n\t\t\tconsole.error(\"No parent element to render on was provided.\");\n\t\t\treturn;\n\t\t}\n\t\tif(this.validate_and_prepare_data()) {\n\t\t\tthis.bind_window_events();\n\t\t\tthis.refresh(true);\n\t\t}\n\t}\n\n\tvalidate_and_prepare_data() {\n\t\treturn true;\n\t}\n\n\tbind_window_events() {\n\t\twindow.addEventListener('resize', this.refresh);\n\t\twindow.addEventListener('orientationchange', this.refresh);\n\t}\n\n  destroy() {\n    window.removeEventListener('resize', this.refresh);\n    window.removeEventListener('orientationchange', this.refresh);\n  }\n\n\trefresh(init=false) {\n\t\tthis.setup_base_values();\n\t\tthis.set_width();\n\n\t\tthis.setup_container();\n\t\tthis.setup_components();\n\n\t\tthis.setup_values();\n\t\tthis.setup_utils();\n\n\t\tthis.make_graph_components(init);\n\t\tthis.make_tooltip();\n\n\t\tif(this.summary.length > 0) {\n\t\t\tthis.show_custom_summary();\n\t\t} else {\n\t\t\tthis.show_summary();\n\t\t}\n\n\t\tif(this.is_navigable) {\n\t\t\tthis.setup_navigation(init);\n\t\t}\n\t}\n\n\tset_width() {\n\t\tlet special_values_width = 0;\n\t\tlet char_width = 8;\n\t\tthis.specific_values.map(val => {\n\t\t\tlet str_width = getStringWidth((val.title + \"\"), char_width);\n\t\t\tif(str_width > special_values_width) {\n\t\t\t\tspecial_values_width = str_width - 40;\n\t\t\t}\n\t\t});\n\t\tthis.base_width = getElementContentWidth(this.parent) - special_values_width;\n\t\tthis.width = this.base_width - this.translate_x * 2;\n\t}\n\n\tsetup_base_values() {}\n\n\tsetup_container() {\n\t\tthis.container = $.create('div', {\n\t\t\tclassName: 'chart-container',\n\t\t\tinnerHTML: `<h6 class=\"title\">${this.title}</h6>\n\t\t\t\t<h6 class=\"sub-title uppercase\">${this.subtitle}</h6>\n\t\t\t\t<div class=\"frappe-chart graphics\"></div>\n\t\t\t\t<div class=\"graph-stats-container\"></div>`\n\t\t});\n\n\t\t// Chart needs a dedicated parent element\n\t\tthis.parent.innerHTML = '';\n\t\tthis.parent.appendChild(this.container);\n\n\t\tthis.chart_wrapper = this.container.querySelector('.frappe-chart');\n\t\tthis.stats_wrapper = this.container.querySelector('.graph-stats-container');\n\n\t\tthis.make_chart_area();\n\t\tthis.make_draw_area();\n\t}\n\n\tmake_chart_area() {\n\t\tthis.svg = makeSVGContainer(\n\t\t\tthis.chart_wrapper,\n\t\t\t'chart',\n\t\t\tthis.base_width,\n\t\t\tthis.base_height\n\t\t);\n\t\tthis.svg_defs = makeSVGDefs(this.svg);\n\t\treturn this.svg;\n\t}\n\n\tmake_draw_area() {\n\t\tthis.draw_area = makeSVGGroup(\n\t\t\tthis.svg,\n\t\t\tthis.type + '-chart',\n\t\t\t`translate(${this.translate_x}, ${this.translate_y})`\n\t\t);\n\t}\n\n\tsetup_components() { }\n\n\tmake_tooltip() {\n\t\tthis.tip = new SvgTip({\n\t\t\tparent: this.chart_wrapper,\n\t\t\tcolors: this.colors\n\t\t});\n\t\tthis.bind_tooltip();\n\t}\n\n\n\tshow_summary() {}\n\tshow_custom_summary() {\n\t\tthis.summary.map(d => {\n\t\t\tlet stats = $.create('div', {\n\t\t\t\tclassName: 'stats',\n\t\t\t\tinnerHTML: `<span class=\"indicator\">\n\t\t\t\t\t<i style=\"background:${d.color}\"></i>\n\t\t\t\t\t${d.title}: ${d.value}\n\t\t\t\t</span>`\n\t\t\t});\n\t\t\tthis.stats_wrapper.appendChild(stats);\n\t\t});\n\t}\n\n\tsetup_navigation(init=false) {\n\t\tthis.make_overlay();\n\n\t\tif(init) {\n\t\t\tthis.bind_overlay();\n\n\t\t\tdocument.addEventListener('keydown', (e) => {\n\t\t\t\tif(isElementInViewport(this.chart_wrapper)) {\n\t\t\t\t\te = e || window.event;\n\n\t\t\t\t\tif (e.keyCode == '37') {\n\t\t\t\t\t\tthis.on_left_arrow();\n\t\t\t\t\t} else if (e.keyCode == '39') {\n\t\t\t\t\t\tthis.on_right_arrow();\n\t\t\t\t\t} else if (e.keyCode == '38') {\n\t\t\t\t\t\tthis.on_up_arrow();\n\t\t\t\t\t} else if (e.keyCode == '40') {\n\t\t\t\t\t\tthis.on_down_arrow();\n\t\t\t\t\t} else if (e.keyCode == '13') {\n\t\t\t\t\t\tthis.on_enter_key();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tmake_overlay() {}\n\tbind_overlay() {}\n\tbind_units() {}\n\n\ton_left_arrow() {}\n\ton_right_arrow() {}\n\ton_up_arrow() {}\n\ton_down_arrow() {}\n\ton_enter_key() {}\n\n\tget_data_point(index=this.current_index) {\n\t\t// check for length\n\t\tlet data_point = {\n\t\t\tindex: index\n\t\t};\n\t\tlet y = this.y[0];\n\t\t['svg_units', 'y_tops', 'values'].map(key => {\n\t\t\tlet data_key = key.slice(0, key.length-1);\n\t\t\tdata_point[data_key] = y[key][index];\n\t\t});\n\t\tdata_point.label = this.x[index];\n\t\treturn data_point;\n\t}\n\n\tupdate_current_data_point(index) {\n\t\tindex = parseInt(index);\n\t\tif(index < 0) index = 0;\n\t\tif(index >= this.x.length) index = this.x.length - 1;\n\t\tif(index === this.current_index) return;\n\t\tthis.current_index = index;\n\t\t$.fire(this.parent, \"data-select\", this.get_data_point());\n\t}\n\n\t// Objects\n\tsetup_utils() { }\n\n\tmakeDrawAreaComponent(className, transform='') {\n\t\treturn makeSVGGroup(this.draw_area, className, transform);\n\t}\n}\n","import { offset } from '../utils/dom';\nimport { UnitRenderer, makeXLine, makeYLine } from '../utils/draw';\nimport { Animator } from '../utils/animate';\nimport { runSVGAnimation } from '../utils/animation';\nimport { calcIntervals } from '../utils/intervals';\nimport { floatTwo, arraysEqual, getStringWidth } from '../utils/helpers';\nimport BaseChart from './BaseChart';\n\nexport default class AxisChart extends BaseChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\n\t\tthis.x = this.data.labels || [];\n\t\tthis.y = this.data.datasets || [];\n\n\t\tthis.is_series = args.is_series;\n\n\t\tthis.format_tooltip_y = args.format_tooltip_y;\n\t\tthis.format_tooltip_x = args.format_tooltip_x;\n\n\t\tthis.zero_line = this.height;\n\n\t\t// this.old_values = {};\n\t}\n\n\tvalidate_and_prepare_data() {\n\t\treturn true;\n\t}\n\n\tsetup_values() {\n\t\tthis.data.datasets.map(d => {\n\t\t\td.values = d.values.map(val => (!isNaN(val) ? val : 0));\n\t\t});\n\t\tthis.setup_x();\n\t\tthis.setup_y();\n\t}\n\n\tsetup_x() {\n\t\tthis.set_avg_unit_width_and_x_offset();\n\n\t\tif(this.x_axis_positions) {\n\t\t\tthis.x_old_axis_positions =  this.x_axis_positions.slice();\n\t\t}\n\t\tthis.x_axis_positions = this.x.map((d, i) =>\n\t\t\tfloatTwo(this.x_offset + i * this.avg_unit_width));\n\n\t\tif(!this.x_old_axis_positions) {\n\t\t\tthis.x_old_axis_positions = this.x_axis_positions.slice();\n\t\t}\n\t}\n\n\tsetup_y() {\n\t\tif(this.y_axis_values) {\n\t\t\tthis.y_old_axis_values =  this.y_axis_values.slice();\n\t\t}\n\n\t\tlet values = this.get_all_y_values();\n\n\t\tif(this.y_sums && this.y_sums.length > 0) {\n\t\t\tvalues = values.concat(this.y_sums);\n\t\t}\n\n\t\tthis.y_axis_values = calcIntervals(values, this.type === 'line');\n\n\t\tif(!this.y_old_axis_values) {\n\t\t\tthis.y_old_axis_values = this.y_axis_values.slice();\n\t\t}\n\n\t\tconst y_pts = this.y_axis_values;\n\t\tconst value_range = y_pts[y_pts.length-1] - y_pts[0];\n\n\t\tif(this.multiplier) this.old_multiplier = this.multiplier;\n\t\tthis.multiplier = this.height / value_range;\n\t\tif(!this.old_multiplier) this.old_multiplier = this.multiplier;\n\n\t\tconst interval = y_pts[1] - y_pts[0];\n\t\tconst interval_height = interval * this.multiplier;\n\n\t\tlet zero_index;\n\n\t\tif(y_pts.indexOf(0) >= 0) {\n\t\t\t// the range has a given zero\n\t\t\t// zero-line on the chart\n\t\t\tzero_index = y_pts.indexOf(0);\n\t\t} else if(y_pts[0] > 0) {\n\t\t\t// Minimum value is positive\n\t\t\t// zero-line is off the chart: below\n\t\t\tlet min = y_pts[0];\n\t\t\tzero_index = (-1) * min / interval;\n\t\t} else {\n\t\t\t// Maximum value is negative\n\t\t\t// zero-line is off the chart: above\n\t\t\tlet max = y_pts[y_pts.length - 1];\n\t\t\tzero_index = (-1) * max / interval + (y_pts.length - 1);\n\t\t}\n\n\t\tif(this.zero_line) this.old_zero_line = this.zero_line;\n\t\tthis.zero_line = this.height - (zero_index * interval_height);\n\t\tif(!this.old_zero_line) this.old_zero_line = this.zero_line;\n\t}\n\n\tsetup_components() {\n\t\tsuper.setup_components();\n\t\tthis.setup_marker_components();\n\t\tthis.setup_aggregation_components();\n\t\tthis.setup_graph_components();\n\t}\n\n\tsetup_marker_components() {\n\t\tthis.y_axis_group = this.makeDrawAreaComponent('y axis');\n\t\tthis.x_axis_group = this.makeDrawAreaComponent('x axis');\n\t\tthis.specific_y_group = this.makeDrawAreaComponent('specific axis');\n\t}\n\n\tsetup_aggregation_components() {\n\t\tthis.sum_group = this.makeDrawAreaComponent('data-points');\n\t\tthis.average_group = this.makeDrawAreaComponent('chart-area');\n\t}\n\n\tsetup_graph_components() {\n\t\tthis.svg_units_groups = [];\n\t\tthis.y.map((d, i) => {\n\t\t\tthis.svg_units_groups[i] = this.makeDrawAreaComponent(\n\t\t\t\t'data-points data-points-' + i);\n\t\t});\n\t}\n\n\tmake_graph_components(init=false) {\n\t\tthis.make_y_axis();\n\t\tthis.make_x_axis();\n\t\tthis.draw_graph(init);\n\t\tthis.make_y_specifics();\n\t}\n\n\t// make VERTICAL lines for x values\n\tmake_x_axis(animate=false) {\n\t\tlet char_width = 8;\n\t\tlet start_at, height, text_start_at, axis_line_class = '';\n\t\tif(this.x_axis_mode === 'span') {\t\t// long spanning lines\n\t\t\tstart_at = -7;\n\t\t\theight = this.height + 15;\n\t\t\ttext_start_at = this.height + 25;\n\t\t} else if(this.x_axis_mode === 'tick'){\t// short label lines\n\t\t\tstart_at = this.height;\n\t\t\theight = 6;\n\t\t\ttext_start_at = 9;\n\t\t\taxis_line_class = 'x-axis-label';\n\t\t}\n\n\t\tthis.x_axis_group.setAttribute('transform', `translate(0,${start_at})`);\n\n\t\tif(animate) {\n\t\t\tthis.make_anim_x_axis(height, text_start_at, axis_line_class);\n\t\t\treturn;\n\t\t}\n\n\t\tlet allowed_space = this.avg_unit_width * 1.5;\n\t\tlet allowed_letters = allowed_space / 8;\n\n\t\tthis.x_axis_group.textContent = '';\n\t\tthis.x.map((point, i) => {\n\t\t\tlet space_taken = getStringWidth(point, char_width) + 2;\n\t\t\tif(space_taken > allowed_space) {\n\t\t\t\tif(this.is_series) {\n\t\t\t\t\t// Skip some axis lines if X axis is a series\n\t\t\t\t\tlet skips = 1;\n\t\t\t\t\twhile((space_taken/skips)*2 > allowed_space) {\n\t\t\t\t\t\tskips++;\n\t\t\t\t\t}\n\t\t\t\t\tif(i % skips !== 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpoint = point.slice(0, allowed_letters-3) + \" ...\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.x_axis_group.appendChild(\n\t\t\t\tmakeXLine(\n\t\t\t\t\theight,\n\t\t\t\t\ttext_start_at,\n\t\t\t\t\tpoint,\n\t\t\t\t\t'x-value-text',\n\t\t\t\t\taxis_line_class,\n\t\t\t\t\tthis.x_axis_positions[i]\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\n\t// make HORIZONTAL lines for y values\n\tmake_y_axis(animate=false) {\n\t\tif(animate) {\n\t\t\tthis.make_anim_y_axis();\n\t\t\tthis.make_anim_y_specifics();\n\t\t\treturn;\n\t\t}\n\n\t\tlet [width, text_end_at, axis_line_class, start_at] = this.get_y_axis_line_props();\n\n\t\tthis.y_axis_group.textContent = '';\n\t\tthis.y_axis_values.map((value, i) => {\n\t\t\tthis.y_axis_group.appendChild(\n\t\t\t\tmakeYLine(\n\t\t\t\t\tstart_at,\n\t\t\t\t\twidth,\n\t\t\t\t\ttext_end_at,\n\t\t\t\t\tvalue,\n\t\t\t\t\t'y-value-text',\n\t\t\t\t\taxis_line_class,\n\t\t\t\t\tthis.zero_line - value * this.multiplier,\n\t\t\t\t\t(value === 0 && i !== 0) // Non-first Zero line\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\n\tget_y_axis_line_props(specific=false) {\n\t\tif(specific) {\n\t\t\treturn[this.width, this.width + 5, 'specific-value', 0];\n\t\t}\n\t\tlet width, text_end_at = -9, axis_line_class = '', start_at = 0;\n\t\tif(this.y_axis_mode === 'span') {\t\t// long spanning lines\n\t\t\twidth = this.width + 6;\n\t\t\tstart_at = -6;\n\t\t} else if(this.y_axis_mode === 'tick'){\t// short label lines\n\t\t\twidth = -6;\n\t\t\taxis_line_class = 'y-axis-label';\n\t\t}\n\n\t\treturn [width, text_end_at, axis_line_class, start_at];\n\t}\n\n\tdraw_graph(init=false) {\n\t\tif(this.raw_chart_args.hasOwnProperty(\"init\") && !this.raw_chart_args.init) {\n\t\t\tthis.y.map((d, i) => {\n\t\t\t\td.svg_units = [];\n\t\t\t\tthis.make_path && this.make_path(d, i, this.x_axis_positions, d.y_tops, this.colors[i]);\n\t\t\t\tthis.make_new_units(d, i);\n\t\t\t\tthis.calc_y_dependencies();\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif(init) {\n\t\t\tthis.draw_new_graph_and_animate();\n\t\t\treturn;\n\t\t}\n\t\tthis.y.map((d, i) => {\n\t\t\td.svg_units = [];\n\t\t\tthis.make_path && this.make_path(d, i, this.x_axis_positions, d.y_tops, this.colors[i]);\n\t\t\tthis.make_new_units(d, i);\n\t\t});\n\t}\n\n\tdraw_new_graph_and_animate() {\n\t\tlet data = [];\n\t\tthis.y.map((d, i) => {\n\t\t\t// Anim: Don't draw initial values, store them and update later\n\t\t\td.y_tops = new Array(d.values.length).fill(this.zero_line); // no value\n\t\t\tdata.push({values: d.values});\n\t\t\td.svg_units = [];\n\n\t\t\tthis.make_path && this.make_path(d, i, this.x_axis_positions, d.y_tops, this.colors[i]);\n\t\t\tthis.make_new_units(d, i);\n\t\t});\n\n\t\tsetTimeout(() => {\n\t\t\tthis.update_values(data);\n\t\t}, 350);\n\t}\n\n\tsetup_navigation(init) {\n\t\tif(init) {\n\t\t\t// Hack: defer nav till initial update_values\n\t\t\tsetTimeout(() => {\n\t\t\t\tsuper.setup_navigation(init);\n\t\t\t}, 500);\n\t\t} else {\n\t\t\tsuper.setup_navigation(init);\n\t\t}\n\t}\n\n\tmake_new_units(d, i) {\n\t\tthis.make_new_units_for_dataset(\n\t\t\tthis.x_axis_positions,\n\t\t\td.y_tops,\n\t\t\tthis.colors[i],\n\t\t\ti,\n\t\t\tthis.y.length\n\t\t);\n\t}\n\n\tmake_new_units_for_dataset(x_values, y_values, color, dataset_index,\n\t\tno_of_datasets, units_group, units_array, unit) {\n\n\t\tif(!units_group) units_group = this.svg_units_groups[dataset_index];\n\t\tif(!units_array) units_array = this.y[dataset_index].svg_units;\n\t\tif(!unit) unit = this.unit_args;\n\n\t\tunits_group.textContent = '';\n\t\tunits_array.length = 0;\n\n\t\tlet unit_renderer = new UnitRenderer(this.height, this.zero_line, this.avg_unit_width);\n\n\t\ty_values.map((y, i) => {\n\t\t\tlet data_unit = unit_renderer[unit.type](\n\t\t\t\tx_values[i],\n\t\t\t\ty,\n\t\t\t\tunit.args,\n\t\t\t\tcolor,\n\t\t\t\ti,\n\t\t\t\tdataset_index,\n\t\t\t\tno_of_datasets\n\t\t\t);\n\t\t\tunits_group.appendChild(data_unit);\n\t\t\tunits_array.push(data_unit);\n\t\t});\n\n\t\tif(this.is_navigable) {\n\t\t\tthis.bind_units(units_array);\n\t\t}\n\t}\n\n\tmake_y_specifics() {\n\t\tthis.specific_y_group.textContent = '';\n\t\tthis.specific_values.map(d => {\n\t\t\tthis.specific_y_group.appendChild(\n\t\t\t\tmakeYLine(\n\t\t\t\t\t0,\n\t\t\t\t\tthis.width,\n\t\t\t\t\tthis.width + 5,\n\t\t\t\t\td.title.toUpperCase(),\n\t\t\t\t\t'specific-value',\n\t\t\t\t\t'specific-value',\n\t\t\t\t\tthis.zero_line - d.value * this.multiplier,\n\t\t\t\t\tfalse,\n\t\t\t\t\td.line_type\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\n\tbind_tooltip() {\n\t\t// TODO: could be in tooltip itself, as it is a given functionality for its parent\n\t\tthis.chart_wrapper.addEventListener('mousemove', (e) => {\n\t\t\tlet o = offset(this.chart_wrapper);\n\t\t\tlet relX = e.pageX - o.left - this.translate_x;\n\t\t\tlet relY = e.pageY - o.top - this.translate_y;\n\n\t\t\tif(relY < this.height + this.translate_y * 2) {\n\t\t\t\tthis.map_tooltip_x_position_and_show(relX);\n\t\t\t} else {\n\t\t\t\tthis.tip.hide_tip();\n\t\t\t}\n\t\t});\n\t}\n\n\tmap_tooltip_x_position_and_show(relX) {\n\t\tif(!this.y_min_tops) return;\n\n\t\tlet titles = this.x;\n\t\tif(this.format_tooltip_x && this.format_tooltip_x(this.x[0])) {\n\t\t\ttitles = this.x.map(d=>this.format_tooltip_x(d));\n\t\t}\n\n\t\tlet y_format = this.format_tooltip_y && this.format_tooltip_y(this.y[0].values[0]);\n\n\t\tfor(var i=this.x_axis_positions.length - 1; i >= 0 ; i--) {\n\t\t\tlet x_val = this.x_axis_positions[i];\n\t\t\t// let delta = i === 0 ? this.avg_unit_width : x_val - this.x_axis_positions[i-1];\n\t\t\tif(relX > x_val - this.avg_unit_width/2) {\n\t\t\t\tlet x = x_val + this.translate_x;\n\t\t\t\tlet y = this.y_min_tops[i] + this.translate_y;\n\n\t\t\t\tlet title = titles[i];\n\t\t\t\tlet values = this.y.map((set, j) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttitle: set.title,\n\t\t\t\t\t\tvalue: y_format ? this.format_tooltip_y(set.values[i]) : set.values[i],\n\t\t\t\t\t\tcolor: this.colors[j],\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\tthis.tip.set_values(x, y, title, '', values);\n\t\t\t\tthis.tip.show_tip();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// API\n\tshow_sums() {\n\t\tthis.updating = true;\n\n\t\tthis.y_sums = new Array(this.x_axis_positions.length).fill(0);\n\t\tthis.y.map(d => {\n\t\t\td.values.map( (value, i) => {\n\t\t\t\tthis.y_sums[i] += value;\n\t\t\t});\n\t\t});\n\n\t\t// Remake y axis, animate\n\t\tthis.update_values();\n\n\t\t// Then make sum units, don't animate\n\t\tthis.sum_units = [];\n\n\t\tthis.make_new_units_for_dataset(\n\t\t\tthis.x_axis_positions,\n\t\t\tthis.y_sums.map( val => floatTwo(this.zero_line - val * this.multiplier)),\n\t\t\t'#f0f4f7',\n\t\t\t0,\n\t\t\t1,\n\t\t\tthis.sum_group,\n\t\t\tthis.sum_units\n\t\t);\n\n\t\t// this.make_path && this.make_path(d, i, old_x, old_y, this.colors[i]);\n\n\t\tthis.updating = false;\n\t}\n\n\thide_sums() {\n\t\tif(this.updating) return;\n\t\tthis.y_sums = [];\n\t\tthis.sum_group.textContent = '';\n\t\tthis.sum_units = [];\n\t\tthis.update_values();\n\t}\n\n\tshow_averages() {\n\t\tthis.old_specific_values = this.specific_values.slice();\n\t\tthis.y.map((d, i) => {\n\t\t\tlet sum = 0;\n\t\t\td.values.map(e => {sum+=e;});\n\t\t\tlet average = sum/d.values.length;\n\n\t\t\tthis.specific_values.push({\n\t\t\t\ttitle: \"AVG\" + \" \" + (i+1),\n\t\t\t\tline_type: \"dashed\",\n\t\t\t\tvalue: average,\n\t\t\t\tauto: 1\n\t\t\t});\n\t\t});\n\n\t\tthis.update_values();\n\t}\n\n\thide_averages() {\n\t\tthis.old_specific_values = this.specific_values.slice();\n\n\t\tlet indices_to_remove = [];\n\t\tthis.specific_values.map((d, i) => {\n\t\t\tif(d.auto) indices_to_remove.unshift(i);\n\t\t});\n\n\t\tindices_to_remove.map(index => {\n\t\t\tthis.specific_values.splice(index, 1);\n\t\t});\n\n\t\tthis.update_values();\n\t}\n\n\tupdate_values(new_y, new_x) {\n\t\tif(!new_x) {\n\t\t\tnew_x = this.x;\n\t\t}\n\t\tthis.elements_to_animate = [];\n\t\tthis.updating = true;\n\n\t\tthis.old_x_values = this.x.slice();\n\t\tthis.old_y_axis_tops = this.y.map(d => d.y_tops.slice());\n\n\t\tthis.old_y_values = this.y.map(d => d.values);\n\n\t\tthis.no_of_extra_pts = new_x.length - this.x.length;\n\n\t\t// Just update values prop, setup_x/y() will do the rest\n\t\tif(new_y) this.y.map((d, i) => {d.values = new_y[i].values;});\n\t\tif(new_x) this.x = new_x;\n\n\t\tthis.setup_x();\n\t\tthis.setup_y();\n\n\t\t// Change in data, so calculate dependencies\n\t\tthis.calc_y_dependencies();\n\n\t\t// Got the values? Now begin drawing\n\t\tthis.animator = new Animator(this.height, this.width, this.zero_line, this.avg_unit_width);\n\n\t\t// Animate only if positions have changed\n\t\tif(!arraysEqual(this.x_old_axis_positions, this.x_axis_positions)) {\n\t\t\tthis.make_x_axis(true);\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(!this.updating) this.make_x_axis();\n\t\t\t}, 350);\n\t\t}\n\n\t\tif(!arraysEqual(this.y_old_axis_values, this.y_axis_values) ||\n\t\t\t(this.old_specific_values &&\n\t\t\t!arraysEqual(this.old_specific_values, this.specific_values))) {\n\n\t\t\tthis.make_y_axis(true);\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(!this.updating) {\n\t\t\t\t\tthis.make_y_axis();\n\t\t\t\t\tthis.make_y_specifics();\n\t\t\t\t}\n\t\t\t}, 350);\n\t\t}\n\n\t\tthis.animate_graphs();\n\n\t\t// Trigger animation with the animatable elements in this.elements_to_animate\n\t\tthis.run_animation();\n\n\t\tthis.updating = false;\n\t}\n\n\tadd_data_point(y_point, x_point, index=this.x.length) {\n\t\tlet new_y = this.y.map(data_set => { return {values:data_set.values}; });\n\t\tnew_y.map((d, i) => { d.values.splice(index, 0, y_point[i]); });\n\t\tlet new_x = this.x.slice();\n\t\tnew_x.splice(index, 0, x_point);\n\n\t\tthis.update_values(new_y, new_x);\n\t}\n\n\tremove_data_point(index = this.x.length-1) {\n\t\tif(this.x.length < 3) return;\n\n\t\tlet new_y = this.y.map(data_set => { return {values:data_set.values}; });\n\t\tnew_y.map((d) => { d.values.splice(index, 1); });\n\t\tlet new_x = this.x.slice();\n\t\tnew_x.splice(index, 1);\n\n\t\tthis.update_values(new_y, new_x);\n\t}\n\n\trun_animation() {\n\t\tlet anim_svg = runSVGAnimation(this.svg, this.elements_to_animate);\n\n\t\tif(this.svg.parentNode == this.chart_wrapper) {\n\t\t\tthis.chart_wrapper.removeChild(this.svg);\n\t\t\tthis.chart_wrapper.appendChild(anim_svg);\n\n\t\t}\n\n\t\t// Replace the new svg (data has long been replaced)\n\t\tsetTimeout(() => {\n\t\t\tif(anim_svg.parentNode == this.chart_wrapper) {\n\t\t\t\tthis.chart_wrapper.removeChild(anim_svg);\n\t\t\t\tthis.chart_wrapper.appendChild(this.svg);\n\t\t\t}\n\t\t}, 250);\n\t}\n\n\tanimate_graphs() {\n\t\tthis.y.map((d, i) => {\n\t\t\t// Pre-prep, equilize no of positions between old and new\n\t\t\tlet [old_x, old_y, new_x, new_y] = this.calc_old_and_new_postions(d, i);\n\t\t\tif(this.no_of_extra_pts >= 0) {\n\t\t\t\tthis.make_path && this.make_path(d, i, old_x, old_y, this.colors[i]);\n\t\t\t\tthis.make_new_units_for_dataset(old_x, old_y, this.colors[i], i, this.y.length);\n\t\t\t}\n\t\t\td.path && this.animate_path(d, i, old_x, old_y, new_x, new_y);\n\t\t\tthis.animate_units(d, i, old_x, old_y, new_x, new_y);\n\t\t});\n\n\t\t// TODO: replace with real units\n\t\tsetTimeout(() => {\n\t\t\tthis.y.map((d, i) => {\n\t\t\t\tthis.make_path && this.make_path(d, i, this.x_axis_positions, d.y_tops, this.colors[i]);\n\t\t\t\tthis.make_new_units(d, i);\n\t\t\t});\n\t\t}, 400);\n\t}\n\n\tanimate_path(d, i, old_x, old_y, new_x, new_y) {\n\t\tconst newPointsList = new_y.map((y, i) => (new_x[i] + ',' + y));\n\t\tconst newPathStr = newPointsList.join(\"L\");\n\t\tthis.elements_to_animate = this.elements_to_animate\n\t\t\t.concat(this.animator['path'](d, newPathStr));\n\t}\n\n\tanimate_units(d, index, old_x, old_y, new_x, new_y) {\n\t\tlet type = this.unit_args.type;\n\n\t\td.svg_units.map((unit, i) => {\n\t\t\tif(new_x[i] === undefined || new_y[i] === undefined) return;\n\t\t\tthis.elements_to_animate.push(this.animator[type](\n\t\t\t\t{unit:unit, array:d.svg_units, index: i}, // unit, with info to replace where it came from in the data\n\t\t\t\tnew_x[i],\n\t\t\t\tnew_y[i],\n\t\t\t\tindex,\n\t\t\t\tthis.y.length\n\t\t\t));\n\t\t});\n\t}\n\n\tcalc_old_and_new_postions(d, i) {\n\t\tlet old_x = this.x_old_axis_positions.slice();\n\t\tlet new_x = this.x_axis_positions.slice();\n\n\t\tlet old_y = this.old_y_axis_tops[i].slice();\n\t\tlet new_y = d.y_tops.slice();\n\n\t\tconst last_old_x_pos = old_x[old_x.length - 1];\n\t\tconst last_old_y_pos = old_y[old_y.length - 1];\n\n\t\tconst last_new_x_pos = new_x[new_x.length - 1];\n\t\tconst last_new_y_pos = new_y[new_y.length - 1];\n\n\t\tif(this.no_of_extra_pts >= 0) {\n\t\t\t// First substitute current path with a squiggled one\n\t\t\t// (that looks the same but has more points at end),\n\t\t\t// then animate to stretch it later to new points\n\t\t\t// (new points already have more points)\n\n\t\t\t// Hence, the extra end points will correspond to current(old) positions\n\t\t\tlet filler_x = new Array(Math.abs(this.no_of_extra_pts)).fill(last_old_x_pos);\n\t\t\tlet filler_y = new Array(Math.abs(this.no_of_extra_pts)).fill(last_old_y_pos);\n\n\t\t\told_x = old_x.concat(filler_x);\n\t\t\told_y = old_y.concat(filler_y);\n\n\t\t} else {\n\t\t\t// Just modify the new points to have extra points\n\t\t\t// with the same position at end\n\t\t\tlet filler_x = new Array(Math.abs(this.no_of_extra_pts)).fill(last_new_x_pos);\n\t\t\tlet filler_y = new Array(Math.abs(this.no_of_extra_pts)).fill(last_new_y_pos);\n\n\t\t\tnew_x = new_x.concat(filler_x);\n\t\t\tnew_y = new_y.concat(filler_y);\n\t\t}\n\n\t\treturn [old_x, old_y, new_x, new_y];\n\t}\n\n\tmake_anim_x_axis(height, text_start_at, axis_line_class) {\n\t\t// Animate X AXIS to account for more or less axis lines\n\n\t\tconst old_pos = this.x_old_axis_positions;\n\t\tconst new_pos = this.x_axis_positions;\n\n\t\tconst old_vals = this.old_x_values;\n\t\tconst new_vals = this.x;\n\n\t\tconst last_line_pos = old_pos[old_pos.length - 1];\n\n\t\tlet add_and_animate_line = (value, old_pos, new_pos) => {\n\t\t\tif(typeof new_pos === 'string') {\n\t\t\t\tnew_pos = parseInt(new_pos.substring(0, new_pos.length-1));\n\t\t\t}\n\t\t\tconst x_line = makeXLine(\n\t\t\t\theight,\n\t\t\t\ttext_start_at,\n\t\t\t\tvalue, // new value\n\t\t\t\t'x-value-text',\n\t\t\t\taxis_line_class,\n\t\t\t\told_pos // old position\n\t\t\t);\n\t\t\tthis.x_axis_group.appendChild(x_line);\n\n\t\t\tthis.elements_to_animate && this.elements_to_animate.push([\n\t\t\t\t{unit: x_line, array: [0], index: 0},\n\t\t\t\t{transform: `${ new_pos }, 0`},\n\t\t\t\t350,\n\t\t\t\t\"easein\",\n\t\t\t\t\"translate\",\n\t\t\t\t{transform: `${ old_pos }, 0`}\n\t\t\t]);\n\t\t};\n\n\t\tthis.x_axis_group.textContent = '';\n\n\t\tthis.make_new_axis_anim_lines(\n\t\t\told_pos,\n\t\t\tnew_pos,\n\t\t\told_vals,\n\t\t\tnew_vals,\n\t\t\tlast_line_pos,\n\t\t\tadd_and_animate_line\n\t\t);\n\t}\n\n\tmake_anim_y_axis() {\n\t\t// Animate Y AXIS to account for more or less axis lines\n\n\t\tconst old_pos = this.y_old_axis_values.map(value =>\n\t\t\tthis.zero_line - value * this.multiplier);\n\t\tconst new_pos = this.y_axis_values.map(value =>\n\t\t\tthis.zero_line - value * this.multiplier);\n\n\t\tconst old_vals = this.y_old_axis_values;\n\t\tconst new_vals = this.y_axis_values;\n\n\t\tconst last_line_pos = old_pos[old_pos.length - 1];\n\n\t\tthis.y_axis_group.textContent = '';\n\n\t\tthis.make_new_axis_anim_lines(\n\t\t\told_pos,\n\t\t\tnew_pos,\n\t\t\told_vals,\n\t\t\tnew_vals,\n\t\t\tlast_line_pos,\n\t\t\tthis.add_and_animate_y_line.bind(this),\n\t\t\tthis.y_axis_group\n\t\t);\n\t}\n\n\tmake_anim_y_specifics() {\n\t\tthis.specific_y_group.textContent = '';\n\t\tthis.specific_values.map((d) => {\n\t\t\tthis.add_and_animate_y_line(\n\t\t\t\td.title,\n\t\t\t\tthis.old_zero_line - d.value * this.old_multiplier,\n\t\t\t\tthis.zero_line - d.value * this.multiplier,\n\t\t\t\t0,\n\t\t\t\tthis.specific_y_group,\n\t\t\t\td.line_type,\n\t\t\t\ttrue\n\t\t\t);\n\t\t});\n\t}\n\n\tmake_new_axis_anim_lines(old_pos, new_pos, old_vals, new_vals, last_line_pos, add_and_animate_line, group) {\n\t\tlet superimposed_positions, superimposed_values;\n\t\tlet no_of_extras = new_vals.length - old_vals.length;\n\t\tif(no_of_extras > 0) {\n\t\t\t// More axis are needed\n\t\t\t// First make only the superimposed (same position) ones\n\t\t\t// Add in the extras at the end later\n\t\t\tsuperimposed_positions = new_pos.slice(0, old_pos.length);\n\t\t\tsuperimposed_values = new_vals.slice(0, old_vals.length);\n\t\t} else {\n\t\t\t// Axis have to be reduced\n\t\t\t// Fake it by moving all current extra axis to the last position\n\t\t\t// You'll need filler positions and values in the new arrays\n\t\t\tconst filler_vals = new Array(Math.abs(no_of_extras)).fill(\"\");\n\t\t\tsuperimposed_values = new_vals.concat(filler_vals);\n\n\t\t\tconst filler_pos = new Array(Math.abs(no_of_extras)).fill(last_line_pos + \"F\");\n\t\t\tsuperimposed_positions = new_pos.concat(filler_pos);\n\t\t}\n\n\t\tsuperimposed_values.map((value, i) => {\n\t\t\tadd_and_animate_line(value, old_pos[i], superimposed_positions[i], i, group);\n\t\t});\n\n\t\tif(no_of_extras > 0) {\n\t\t\t// Add in extra axis in the end\n\t\t\t// and then animate to new positions\n\t\t\tconst extra_values = new_vals.slice(old_vals.length);\n\t\t\tconst extra_positions = new_pos.slice(old_pos.length);\n\n\t\t\textra_values.map((value, i) => {\n\t\t\t\tadd_and_animate_line(value, last_line_pos, extra_positions[i], i, group);\n\t\t\t});\n\t\t}\n\t}\n\n\tadd_and_animate_y_line(value, old_pos, new_pos, i, group, type, specific=false) {\n\t\tlet filler = false;\n\t\tif(typeof new_pos === 'string') {\n\t\t\tnew_pos = parseInt(new_pos.substring(0, new_pos.length-1));\n\t\t\tfiller = true;\n\t\t}\n\t\tlet new_props = {transform: `0, ${ new_pos }`};\n\t\tlet old_props = {transform: `0, ${ old_pos }`};\n\n\t\tif(filler) {\n\t\t\tnew_props['stroke-opacity'] = 0;\n\t\t\t// old_props['stroke-opacity'] = 1;\n\t\t}\n\n\t\tlet [width, text_end_at, axis_line_class, start_at] = this.get_y_axis_line_props(specific);\n\t\tlet axis_label_class = !specific ? 'y-value-text' : 'specific-value';\n\t\tvalue = !specific ? value : (value+\"\").toUpperCase();\n\t\tconst y_line = makeYLine(\n\t\t\tstart_at,\n\t\t\twidth,\n\t\t\ttext_end_at,\n\t\t\tvalue,\n\t\t\taxis_label_class,\n\t\t\taxis_line_class,\n\t\t\told_pos,  // old position\n\t\t\t(value === 0 && i !== 0), // Non-first Zero line\n\t\t\ttype\n\t\t);\n\n\t\tgroup.appendChild(y_line);\n\n\t\tthis.elements_to_animate && this.elements_to_animate.push([\n\t\t\t{unit: y_line, array: [0], index: 0},\n\t\t\tnew_props,\n\t\t\t350,\n\t\t\t\"easein\",\n\t\t\t\"translate\",\n\t\t\told_props\n\t\t]);\n\t}\n\n\tset_avg_unit_width_and_x_offset() {\n\t\t// Set the ... you get it\n\t\tthis.avg_unit_width = this.width/(this.x.length - 1);\n\t\tthis.x_offset = 0;\n\t}\n\n\tget_all_y_values() {\n\t\tlet all_values = [];\n\n\t\t// Add in all the y values in the datasets\n\t\tthis.y.map(d => {\n\t\t\tall_values = all_values.concat(d.values);\n\t\t});\n\n\t\t// Add in all the specific values\n\t\treturn all_values.concat(this.specific_values.map(d => d.value));\n\t}\n\n\tcalc_y_dependencies() {\n\t\tthis.y_min_tops = new Array(this.x_axis_positions.length).fill(9999);\n\t\tthis.y.map(d => {\n\t\t\td.y_tops = d.values.map( val => floatTwo(this.zero_line - val * this.multiplier));\n\t\t\td.y_tops.map( (y_top, i) => {\n\t\t\t\tif(y_top < this.y_min_tops[i]) {\n\t\t\t\t\tthis.y_min_tops[i] = y_top;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t// this.chart_wrapper.removeChild(this.tip.container);\n\t\t// this.make_tooltip();\n\t}\n}\n","import AxisChart from './AxisChart';\nimport { makeSVGGroup, makePath, makeGradient } from '../utils/draw';\n\nexport default class LineChart extends AxisChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\n\t\tthis.x_axis_mode = args.x_axis_mode || 'span';\n\t\tthis.y_axis_mode = args.y_axis_mode || 'span';\n\n\t\tif(args.hasOwnProperty('show_dots')) {\n\t\t\tthis.show_dots = args.show_dots;\n\t\t} else {\n\t\t\tthis.show_dots = 1;\n\t\t}\n\t\tthis.region_fill = args.region_fill;\n\n\t\tif(Object.getPrototypeOf(this) !== LineChart.prototype) {\n\t\t\treturn;\n\t\t}\n\t\tthis.dot_radius = args.dot_radius || 4;\n\t\tthis.heatline = args.heatline;\n\t\tthis.type = 'line';\n\n\t\tthis.setup();\n\t}\n\n\tsetup_graph_components() {\n\t\tthis.setup_path_groups();\n\t\tsuper.setup_graph_components();\n\t}\n\n\tsetup_path_groups() {\n\t\tthis.paths_groups = [];\n\t\tthis.y.map((d, i) => {\n\t\t\tthis.paths_groups[i] = makeSVGGroup(\n\t\t\t\tthis.draw_area,\n\t\t\t\t'path-group path-group-' + i\n\t\t\t);\n\t\t});\n\t}\n\n\tsetup_values() {\n\t\tsuper.setup_values();\n\t\tthis.unit_args = {\n\t\t\ttype: 'dot',\n\t\t\targs: { radius: this.dot_radius }\n\t\t};\n\t}\n\n\tmake_new_units_for_dataset(x_values, y_values, color, dataset_index,\n\t\tno_of_datasets, units_group, units_array, unit) {\n\t\tif(this.show_dots) {\n\t\t\tsuper.make_new_units_for_dataset(x_values, y_values, color, dataset_index,\n\t\t\t\tno_of_datasets, units_group, units_array, unit);\n\t\t}\n\t}\n\n\tmake_paths() {\n\t\tthis.y.map((d, i) => {\n\t\t\tthis.make_path(d, i, this.x_axis_positions, d.y_tops, d.color || this.colors[i]);\n\t\t});\n\t}\n\n\tmake_path(d, i, x_positions, y_positions, color) {\n\t\tlet points_list = y_positions.map((y, i) => (x_positions[i] + ',' + y));\n\t\tlet points_str = points_list.join(\"L\");\n\n\t\tthis.paths_groups[i].textContent = '';\n\n\t\td.path = makePath(\"M\"+points_str, 'line-graph-path', color);\n\t\tthis.paths_groups[i].appendChild(d.path);\n\n\t\tif(this.heatline) {\n\t\t\tlet gradient_id = makeGradient(this.svg_defs, color);\n\t\t\td.path.style.stroke = `url(#${gradient_id})`;\n\t\t}\n\n\t\tif(this.region_fill) {\n\t\t\tthis.fill_region_for_dataset(d, i, color, points_str);\n\t\t}\n\t}\n\n\tfill_region_for_dataset(d, i, color, points_str) {\n\t\tlet gradient_id = makeGradient(this.svg_defs, color, true);\n\t\tlet pathStr = \"M\" + `0,${this.zero_line}L` + points_str + `L${this.width},${this.zero_line}`;\n\n\t\td.regionPath = makePath(pathStr, `region-fill`, 'none', `url(#${gradient_id})`);\n\t\tthis.paths_groups[i].appendChild(d.regionPath);\n\t}\n}\n","import BaseChart from './BaseChart';\nimport { $, offset } from '../utils/dom';\nimport { makePath } from '../utils/draw';\nimport { lightenDarkenColor } from '../utils/colors';\nimport { runSVGAnimation, transform } from '../utils/animation';\nconst ANGLE_RATIO = Math.PI / 180;\nconst FULL_ANGLE = 360;\n\nexport default class PieChart extends BaseChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\t\tthis.type = 'pie';\n\t\tthis.elements_to_animate = null;\n\t\tthis.hoverRadio = args.hoverRadio || 0.1;\n\t\tthis.max_slices = 10;\n\t\tthis.max_legend_points = 6;\n\t\tthis.isAnimate = false;\n\t\tthis.startAngle = args.startAngle || 0;\n\t\tthis.clockWise = args.clockWise || false;\n\t\tthis.mouseMove = this.mouseMove.bind(this);\n\t\tthis.mouseLeave = this.mouseLeave.bind(this);\n\t\tthis.setup();\n\t}\n\tsetup_values() {\n\t\tthis.centerX = this.width / 2;\n\t\tthis.centerY = this.height / 2;\n\t\tthis.radius = (this.height > this.width ? this.centerX : this.centerY);\n\t\tthis.slice_totals = [];\n\t\tlet all_totals = this.data.labels.map((d, i) => {\n\t\t\tlet total = 0;\n\t\t\tthis.data.datasets.map(e => {\n\t\t\t\ttotal += e.values[i];\n\t\t\t});\n\t\t\treturn [total, d];\n\t\t}).filter(d => { return d[0] > 0; }); // keep only positive results\n\n\t\tlet totals = all_totals;\n\n\t\tif(all_totals.length > this.max_slices) {\n\t\t\tall_totals.sort((a, b) => { return b[0] - a[0]; });\n\n\t\t\ttotals = all_totals.slice(0, this.max_slices-1);\n\t\t\tlet others = all_totals.slice(this.max_slices-1);\n\n\t\t\tlet sum_of_others = 0;\n\t\t\tothers.map(d => {sum_of_others += d[0];});\n\n\t\t\ttotals.push([sum_of_others, 'Rest']);\n\n\t\t\tthis.colors[this.max_slices-1] = 'grey';\n\t\t}\n\n\t\tthis.labels = [];\n\t\ttotals.map(d => {\n\t\t\tthis.slice_totals.push(d[0]);\n\t\t\tthis.labels.push(d[1]);\n\t\t});\n\n\t\tthis.legend_totals = this.slice_totals.slice(0, this.max_legend_points);\n\t}\n\n\tstatic getPositionByAngle(angle,radius){\n\t\treturn {\n\t\t\tx:Math.sin(angle * ANGLE_RATIO) * radius,\n\t\t\ty:Math.cos(angle * ANGLE_RATIO) * radius,\n\t\t};\n\t}\n\tmakeArcPath(startPosition,endPosition){\n\t\tconst{centerX,centerY,radius,clockWise} = this;\n\t\treturn `M${centerX} ${centerY} L${centerX+startPosition.x} ${centerY+startPosition.y} A ${radius} ${radius} 0 0 ${clockWise ? 1 : 0} ${centerX+endPosition.x} ${centerY+endPosition.y} z`;\n\t}\n\tmake_graph_components(init){\n\t\tconst{radius,clockWise} = this;\n\t\tthis.grand_total = this.slice_totals.reduce((a, b) => a + b, 0);\n\t\tconst prevSlicesProperties = this.slicesProperties || [];\n\t\tthis.slices = [];\n\t\tthis.elements_to_animate = [];\n\t\tthis.slicesProperties = [];\n\t\tlet curAngle = 180 - this.startAngle;\n\t\tthis.slice_totals.map((total, i) => {\n\t\t\tconst startAngle = curAngle;\n\t\t\tconst originDiffAngle = (total / this.grand_total) * FULL_ANGLE;\n\t\t\tconst diffAngle = clockWise ? -originDiffAngle : originDiffAngle;\n\t\t\tconst endAngle = curAngle = curAngle + diffAngle;\n\t\t\tconst startPosition = PieChart.getPositionByAngle(startAngle,radius);\n\t\t\tconst endPosition = PieChart.getPositionByAngle(endAngle,radius);\n\t\t\tconst prevProperty = init && prevSlicesProperties[i];\n\t\t\tlet curStart,curEnd;\n\t\t\tif(init){\n\t\t\t\tcurStart = prevProperty?prevProperty.startPosition : startPosition;\n\t\t\t\tcurEnd = prevProperty? prevProperty.endPosition : startPosition;\n\t\t\t}else{\n\t\t\t\tcurStart = startPosition;\n\t\t\t\tcurEnd = endPosition;\n\t\t\t}\n\t\t\tconst curPath = this.makeArcPath(curStart,curEnd);\n\t\t\tlet slice = makePath(curPath, 'pie-path', 'none', this.colors[i]);\n\t\t\tslice.style.transition = 'transform .3s;';\n\t\t\tthis.draw_area.appendChild(slice);\n\n\t\t\tthis.slices.push(slice);\n\t\t\tthis.slicesProperties.push({\n\t\t\t\tstartPosition,\n\t\t\t\tendPosition,\n\t\t\t\tvalue: total,\n\t\t\t\ttotal: this.grand_total,\n\t\t\t\tstartAngle,\n\t\t\t\tendAngle,\n\t\t\t\tangle:diffAngle\n\t\t\t});\n\t\t\tif(init){\n\t\t\t\tthis.elements_to_animate.push([{unit: slice, array: this.slices, index: this.slices.length - 1},\n\t\t\t\t\t{d:this.makeArcPath(startPosition,endPosition)},\n\t\t\t\t\t650, \"easein\",null,{\n\t\t\t\t\t\td:curPath\n\t\t\t\t\t}]);\n\t\t\t}\n\n\t\t});\n\t\tif(init){\n\t\t\tthis.run_animation();\n\t\t}\n\t}\n\trun_animation() {\n\t\t// if(this.isAnimate) return ;\n\t\t// this.isAnimate = true;\n\t\tif(!this.elements_to_animate || this.elements_to_animate.length === 0) return;\n\t\tlet anim_svg = runSVGAnimation(this.svg, this.elements_to_animate);\n\n\t\tif(this.svg.parentNode == this.chart_wrapper) {\n\t\t\tthis.chart_wrapper.removeChild(this.svg);\n\t\t\tthis.chart_wrapper.appendChild(anim_svg);\n\n\t\t}\n\n\t\t// Replace the new svg (data has long been replaced)\n\t\tsetTimeout(() => {\n\t\t\t// this.isAnimate = false;\n\t\t\tif(anim_svg.parentNode == this.chart_wrapper) {\n\t\t\t\tthis.chart_wrapper.removeChild(anim_svg);\n\t\t\t\tthis.chart_wrapper.appendChild(this.svg);\n\t\t\t}\n\t\t}, 650);\n\t}\n\n\tcalTranslateByAngle(property){\n\t\tconst{radius,hoverRadio} = this;\n\t\tconst position = PieChart.getPositionByAngle(property.startAngle+(property.angle / 2),radius);\n\t\treturn `translate3d(${(position.x) * hoverRadio}px,${(position.y) * hoverRadio}px,0)`;\n\t}\n\thoverSlice(path,i,flag,e){\n\t\tif(!path) return;\n\t\tconst color = this.colors[i];\n\t\tif(flag){\n\t\t\ttransform(path,this.calTranslateByAngle(this.slicesProperties[i]));\n\t\t\tpath.style.fill = lightenDarkenColor(color,50);\n\t\t\tlet g_off = offset(this.svg);\n\t\t\tlet x = e.pageX - g_off.left + 10;\n\t\t\tlet y = e.pageY - g_off.top - 10;\n\t\t\tlet title = (this.formatted_labels && this.formatted_labels.length>0\n\t\t\t\t? this.formatted_labels[i] : this.labels[i]) + ': ';\n\t\t\tlet percent = (this.slice_totals[i]*100/this.grand_total).toFixed(1);\n\t\t\tthis.tip.set_values(x, y, title, percent + \"%\");\n\t\t\tthis.tip.show_tip();\n\t\t}else{\n\t\t\ttransform(path,'translate3d(0,0,0)');\n\t\t\tthis.tip.hide_tip();\n\t\t\tpath.style.fill = color;\n\t\t}\n\t}\n\n\tmouseMove(e){\n\t\tconst target = e.target;\n\t\tlet prevIndex = this.curActiveSliceIndex;\n\t\tlet prevAcitve = this.curActiveSlice;\n\t\tfor(let i = 0; i < this.slices.length; i++){\n\t\t\tif(target === this.slices[i]){\n\t\t\t\tthis.hoverSlice(prevAcitve,prevIndex,false);\n\t\t\t\tthis.curActiveSlice = target;\n\t\t\t\tthis.curActiveSliceIndex = i;\n\t\t\t\tthis.hoverSlice(target,i,true,e);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tmouseLeave(){\n\t\tthis.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,false);\n\t}\n\tbind_tooltip() {\n\t\tthis.draw_area.addEventListener('mousemove',this.mouseMove);\n\t\tthis.draw_area.addEventListener('mouseleave',this.mouseLeave);\n\t}\n\n\tshow_summary() {\n\t\tlet x_values = this.formatted_labels && this.formatted_labels.length > 0\n\t\t\t? this.formatted_labels : this.labels;\n\t\tthis.legend_totals.map((d, i) => {\n\t\t\tconst color = this.colors[i];\n\n\t\t\tif(d) {\n\t\t\t\tlet stats = $.create('div', {\n\t\t\t\t\tclassName: 'stats',\n\t\t\t\t\tinside: this.stats_wrapper\n\t\t\t\t});\n\t\t\t\tstats.innerHTML = `<span class=\"indicator\">\n\t\t\t\t\t<i style=\"background-color:${color};\"></i>\n\t\t\t\t\t<span class=\"text-muted\">${x_values[i]}:</span>\n\t\t\t\t\t${d}\n\t\t\t\t</span>`;\n\t\t\t}\n\t\t});\n\t}\n}\n","// Playing around with dates\n\n// https://stackoverflow.com/a/11252167/6495043\nfunction treatAsUtc(dateStr) {\n\tlet result = new Date(dateStr);\n\tresult.setMinutes(result.getMinutes() - result.getTimezoneOffset());\n\treturn result;\n}\n\nexport function getDdMmYyyy(date) {\n\tlet dd = date.getDate();\n\tlet mm = date.getMonth() + 1; // getMonth() is zero-based\n\treturn [\n\t\t(dd>9 ? '' : '0') + dd,\n\t\t(mm>9 ? '' : '0') + mm,\n\t\tdate.getFullYear()\n\t].join('-');\n}\n\nexport function getWeeksBetween(startDateStr, endDateStr) {\n\treturn Math.ceil(getDaysBetween(startDateStr, endDateStr) / 7);\n}\n\nexport function getDaysBetween(startDateStr, endDateStr) {\n\tlet millisecondsPerDay = 24 * 60 * 60 * 1000;\n\treturn (treatAsUtc(endDateStr) - treatAsUtc(startDateStr)) / millisecondsPerDay;\n}\n\n// mutates\nexport function addDays(date, numberOfDays) {\n\tdate.setDate(date.getDate() + numberOfDays);\n}\n\n// export function getMonthName() {}\n","import '../scss/charts.scss';\n\nimport BarChart from './charts/BarChart';\nimport LineChart from './charts/LineChart';\nimport ScatterChart from './charts/ScatterChart';\nimport PercentageChart from './charts/PercentageChart';\nimport PieChart from './charts/PieChart';\nimport Heatmap from './charts/Heatmap';\n\n// if (ENV !== 'production') {\n// \t// Enable LiveReload\n// \tdocument.write(\n// \t\t'<script src=\"http://' + (location.host || 'localhost').split(':')[0] +\n// \t\t':35729/livereload.js?snipver=1\"></' + 'script>'\n// \t);\n// }\n\nconst chartTypes = {\n\tline: LineChart,\n\tbar: BarChart,\n\tscatter: ScatterChart,\n\tpercentage: PercentageChart,\n\theatmap: Heatmap,\n\tpie: PieChart\n};\n\nfunction getChartByType(chartType = 'line', options) {\n\tif (!chartTypes[chartType]) {\n\t\treturn new LineChart(options);\n\t}\n\n\treturn new chartTypes[chartType](options);\n}\n\nexport default class Chart {\n\tconstructor(args) {\n\t\treturn getChartByType(args.type, arguments[0]);\n\t}\n}\n","import AxisChart from './AxisChart';\n\nexport default class BarChart extends AxisChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\n\t\tthis.type = 'bar';\n\t\tthis.x_axis_mode = args.x_axis_mode || 'tick';\n\t\tthis.y_axis_mode = args.y_axis_mode || 'span';\n\t\tthis.setup();\n\t}\n\n\tsetup_values() {\n\t\tsuper.setup_values();\n\t\tthis.x_offset = this.avg_unit_width;\n\t\tthis.unit_args = {\n\t\t\ttype: 'bar',\n\t\t\targs: {\n\t\t\t\tspaceWidth: this.avg_unit_width/2,\n\t\t\t}\n\t\t};\n\t}\n\n\tmake_overlay() {\n\t\t// Just make one out of the first element\n\t\tlet index = this.x.length - 1;\n\t\tlet unit = this.y[0].svg_units[index];\n\t\tthis.update_current_data_point(index);\n\n\t\tif(this.overlay) {\n\t\t\tthis.overlay.parentNode.removeChild(this.overlay);\n\t\t}\n\t\tthis.overlay = unit.cloneNode();\n\t\tthis.overlay.style.fill = '#000000';\n\t\tthis.overlay.style.opacity = '0.4';\n\t\tthis.draw_area.appendChild(this.overlay);\n\t}\n\n\tbind_overlay() {\n\t\t// on event, update overlay\n\t\tthis.parent.addEventListener('data-select', (e) => {\n\t\t\tthis.update_overlay(e.svg_unit);\n\t\t});\n\t}\n\n\tbind_units(units_array) {\n\t\tunits_array.map(unit => {\n\t\t\tunit.addEventListener('click', () => {\n\t\t\t\tlet index = unit.getAttribute('data-point-index');\n\t\t\t\tthis.update_current_data_point(index);\n\t\t\t});\n\t\t});\n\t}\n\n\tupdate_overlay(unit) {\n\t\tlet attributes = [];\n\t\tObject.keys(unit.attributes).map(index => {\n\t\t\tattributes.push(unit.attributes[index]);\n\t\t});\n\n\t\tattributes.filter(attr => attr.specified).map(attr => {\n\t\t\tthis.overlay.setAttribute(attr.name, attr.nodeValue);\n\t\t});\n\n\t\tthis.overlay.style.fill = '#000000';\n\t\tthis.overlay.style.opacity = '0.4';\n\t}\n\n\ton_left_arrow() {\n\t\tthis.update_current_data_point(this.current_index - 1);\n\t}\n\n\ton_right_arrow() {\n\t\tthis.update_current_data_point(this.current_index + 1);\n\t}\n\n\tset_avg_unit_width_and_x_offset() {\n\t\tthis.avg_unit_width = this.width/(this.x.length + 1);\n\t\tthis.x_offset = this.avg_unit_width;\n\t}\n}\n","import LineChart from './LineChart';\n\nexport default class ScatterChart extends LineChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\n\t\tthis.type = 'scatter';\n\n\t\tif(!args.dot_radius) {\n\t\t\tthis.dot_radius = 8;\n\t\t} else {\n\t\t\tthis.dot_radius = args.dot_radius;\n\t\t}\n\n\t\tthis.setup();\n\t}\n\n\tsetup_graph_components() {\n\t\tthis.setup_path_groups();\n\t\tsuper.setup_graph_components();\n\t}\n\n\tsetup_path_groups() {}\n\n\tsetup_values() {\n\t\tsuper.setup_values();\n\t\tthis.unit_args = {\n\t\t\ttype: 'dot',\n\t\t\targs: { radius: this.dot_radius }\n\t\t};\n\t}\n\n\tmake_paths() {}\n\tmake_path() {}\n}\n","import BaseChart from './BaseChart';\nimport { $, offset } from '../utils/dom';\n\nexport default class PercentageChart extends BaseChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\t\tthis.type = 'percentage';\n\n\t\tthis.max_slices = 10;\n\t\tthis.max_legend_points = 6;\n\n\t\tthis.setup();\n\t}\n\n\tmake_chart_area() {\n\t\tthis.chart_wrapper.className += ' ' + 'graph-focus-margin';\n\t\tthis.chart_wrapper.style.marginTop = '45px';\n\n\t\tthis.stats_wrapper.className += ' ' + 'graph-focus-margin';\n\t\tthis.stats_wrapper.style.marginBottom = '30px';\n\t\tthis.stats_wrapper.style.paddingTop = '0px';\n\t}\n\n\tmake_draw_area() {\n\t\tthis.chart_div = $.create('div', {\n\t\t\tclassName: 'div',\n\t\t\tinside: this.chart_wrapper\n\t\t});\n\n\t\tthis.chart = $.create('div', {\n\t\t\tclassName: 'progress-chart',\n\t\t\tinside: this.chart_div\n\t\t});\n\t}\n\n\tsetup_components() {\n\t\tthis.percentage_bar = $.create('div', {\n\t\t\tclassName: 'progress',\n\t\t\tinside: this.chart\n\t\t});\n\t}\n\n\tsetup_values() {\n\t\tthis.slice_totals = [];\n\t\tlet all_totals = this.data.labels.map((d, i) => {\n\t\t\tlet total = 0;\n\t\t\tthis.data.datasets.map(e => {\n\t\t\t\ttotal += e.values[i];\n\t\t\t});\n\t\t\treturn [total, d];\n\t\t}).filter(d => { return d[0] > 0; }); // keep only positive results\n\n\t\tlet totals = all_totals;\n\n\t\tif(all_totals.length > this.max_slices) {\n\t\t\tall_totals.sort((a, b) => { return b[0] - a[0]; });\n\n\t\t\ttotals = all_totals.slice(0, this.max_slices-1);\n\t\t\tlet others = all_totals.slice(this.max_slices-1);\n\n\t\t\tlet sum_of_others = 0;\n\t\t\tothers.map(d => {sum_of_others += d[0];});\n\n\t\t\ttotals.push([sum_of_others, 'Rest']);\n\n\t\t\tthis.colors[this.max_slices-1] = 'grey';\n\t\t}\n\n\t\tthis.labels = [];\n\t\ttotals.map(d => {\n\t\t\tthis.slice_totals.push(d[0]);\n\t\t\tthis.labels.push(d[1]);\n\t\t});\n\n\t\tthis.legend_totals = this.slice_totals.slice(0, this.max_legend_points);\n\t}\n\n\tmake_graph_components() {\n\t\tthis.grand_total = this.slice_totals.reduce((a, b) => a + b, 0);\n\t\tthis.slices = [];\n\t\tthis.slice_totals.map((total, i) => {\n\t\t\tlet slice = $.create('div', {\n\t\t\t\tclassName: `progress-bar`,\n\t\t\t\tinside: this.percentage_bar,\n\t\t\t\tstyles: {\n\t\t\t\t\tbackground: this.colors[i],\n\t\t\t\t\twidth: total*100/this.grand_total + \"%\"\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.slices.push(slice);\n\t\t});\n\t}\n\n\tbind_tooltip() {\n\t\tthis.slices.map((slice, i) => {\n\t\t\tslice.addEventListener('mouseenter', () => {\n\t\t\t\tlet g_off = offset(this.chart_wrapper), p_off = offset(slice);\n\n\t\t\t\tlet x = p_off.left - g_off.left + slice.offsetWidth/2;\n\t\t\t\tlet y = p_off.top - g_off.top - 6;\n\t\t\t\tlet title = (this.formatted_labels && this.formatted_labels.length>0\n\t\t\t\t\t? this.formatted_labels[i] : this.labels[i]) + ': ';\n\t\t\t\tlet percent = (this.slice_totals[i]*100/this.grand_total).toFixed(1);\n\n\t\t\t\tthis.tip.set_values(x, y, title, percent + \"%\");\n\t\t\t\tthis.tip.show_tip();\n\t\t\t});\n\t\t});\n\t}\n\n\tshow_summary() {\n\t\tlet x_values = this.formatted_labels && this.formatted_labels.length > 0\n\t\t\t? this.formatted_labels : this.labels;\n\t\tthis.legend_totals.map((d, i) => {\n\t\t\tif(d) {\n\t\t\t\tlet stats = $.create('div', {\n\t\t\t\t\tclassName: 'stats',\n\t\t\t\t\tinside: this.stats_wrapper\n\t\t\t\t});\n\t\t\t\tstats.innerHTML = `<span class=\"indicator\">\n\t\t\t\t\t<i style=\"background: ${this.colors[i]}\"></i>\n\t\t\t\t\t<span class=\"text-muted\">${x_values[i]}:</span>\n\t\t\t\t\t${d}\n\t\t\t\t</span>`;\n\t\t\t}\n\t\t});\n\t}\n}\n","import BaseChart from './BaseChart';\nimport { makeSVGGroup, makeHeatSquare, makeText } from '../utils/draw';\nimport { addDays, getDdMmYyyy, getWeeksBetween } from '../utils/date-utils';\nimport { calcDistribution, getMaxCheckpoint } from '../utils/intervals';\nimport { isValidColor } from '../utils/colors';\n\nexport default class Heatmap extends BaseChart {\n\tconstructor({\n\t\tstart = '',\n\t\tdomain = '',\n\t\tsubdomain = '',\n\t\tdata = {},\n\t\tdiscrete_domains = 0,\n\t\tcount_label = '',\n\t\tlegend_colors = []\n\t}) {\n\t\tsuper(arguments[0]);\n\n\t\tthis.type = 'heatmap';\n\n\t\tthis.domain = domain;\n\t\tthis.subdomain = subdomain;\n\t\tthis.data = data;\n\t\tthis.discrete_domains = discrete_domains;\n\t\tthis.count_label = count_label;\n\n\t\tlet today = new Date();\n\t\tthis.start = start || addDays(today, 365);\n\n\t\tlegend_colors = legend_colors.slice(0, 5);\n\t\tthis.legend_colors = this.validate_colors(legend_colors)\n\t\t\t? legend_colors\n\t\t\t: ['#ebedf0', '#c6e48b', '#7bc96f', '#239a3b', '#196127'];\n\n\t\t// Fixed 5-color theme,\n\t\t// More colors are difficult to parse visually\n\t\tthis.distribution_size = 5;\n\n\t\tthis.translate_x = 0;\n\t\tthis.setup();\n\t}\n\n\tvalidate_colors(colors) {\n\t\tif(colors.length < 5) return 0;\n\n\t\tlet valid = 1;\n\t\tcolors.forEach(function(string) {\n\t\t\tif(!isValidColor(string)) {\n\t\t\t\tvalid = 0;\n\t\t\t\tconsole.warn('\"' + string + '\" is not a valid color.');\n\t\t\t}\n\t\t}, this);\n\n\t\treturn valid;\n\t}\n\n\tsetup_base_values() {\n\t\tthis.today = new Date();\n\n\t\tif(!this.start) {\n\t\t\tthis.start = new Date();\n\t\t\tthis.start.setFullYear( this.start.getFullYear() - 1 );\n\t\t}\n\t\tthis.first_week_start = new Date(this.start.toDateString());\n\t\tthis.last_week_start = new Date(this.today.toDateString());\n\t\tif(this.first_week_start.getDay() !== 7) {\n\t\t\taddDays(this.first_week_start, (-1) * this.first_week_start.getDay());\n\t\t}\n\t\tif(this.last_week_start.getDay() !== 7) {\n\t\t\taddDays(this.last_week_start, (-1) * this.last_week_start.getDay());\n\t\t}\n\t\tthis.no_of_cols = getWeeksBetween(this.first_week_start + '', this.last_week_start + '') + 1;\n\t}\n\n\tset_width() {\n\t\tthis.base_width = (this.no_of_cols + 3) * 12 ;\n\n\t\tif(this.discrete_domains) {\n\t\t\tthis.base_width += (12 * 12);\n\t\t}\n\t}\n\n\tsetup_components() {\n\t\tthis.domain_label_group = this.makeDrawAreaComponent(\n\t\t\t'domain-label-group chart-label');\n\n\t\tthis.data_groups = this.makeDrawAreaComponent(\n\t\t\t'data-groups',\n\t\t\t`translate(0, 20)`\n\t\t);\n\t}\n\n\tsetup_values() {\n\t\tthis.domain_label_group.textContent = '';\n\t\tthis.data_groups.textContent = '';\n\n\t\tlet data_values = Object.keys(this.data).map(key => this.data[key]);\n\t\tthis.distribution = calcDistribution(data_values, this.distribution_size);\n\n\t\tthis.month_names = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\t\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n\t\t];\n\n\t\tthis.render_all_weeks_and_store_x_values(this.no_of_cols);\n\t}\n\n\trender_all_weeks_and_store_x_values(no_of_weeks) {\n\t\tlet current_week_sunday = new Date(this.first_week_start);\n\t\tthis.week_col = 0;\n\t\tthis.current_month = current_week_sunday.getMonth();\n\n\t\tthis.months = [this.current_month + ''];\n\t\tthis.month_weeks = {}, this.month_start_points = [];\n\t\tthis.month_weeks[this.current_month] = 0;\n\t\tthis.month_start_points.push(13);\n\n\t\tfor(var i = 0; i < no_of_weeks; i++) {\n\t\t\tlet data_group, month_change = 0;\n\t\t\tlet day = new Date(current_week_sunday);\n\n\t\t\t[data_group, month_change] = this.get_week_squares_group(day, this.week_col);\n\t\t\tthis.data_groups.appendChild(data_group);\n\t\t\tthis.week_col += 1 + parseInt(this.discrete_domains && month_change);\n\t\t\tthis.month_weeks[this.current_month]++;\n\t\t\tif(month_change) {\n\t\t\t\tthis.current_month = (this.current_month + 1) % 12;\n\t\t\t\tthis.months.push(this.current_month + '');\n\t\t\t\tthis.month_weeks[this.current_month] = 1;\n\t\t\t}\n\t\t\taddDays(current_week_sunday, 7);\n\t\t}\n\t\tthis.render_month_labels();\n\t}\n\n\tget_week_squares_group(current_date, index) {\n\t\tconst no_of_weekdays = 7;\n\t\tconst square_side = 10;\n\t\tconst cell_padding = 2;\n\t\tconst step = 1;\n\t\tconst today_time = this.today.getTime();\n\n\t\tlet month_change = 0;\n\t\tlet week_col_change = 0;\n\n\t\tlet data_group = makeSVGGroup(this.data_groups, 'data-group');\n\n\t\tfor(var y = 0, i = 0; i < no_of_weekdays; i += step, y += (square_side + cell_padding)) {\n\t\t\tlet data_value = 0;\n\t\t\tlet color_index = 0;\n\n\t\t\tlet current_timestamp = current_date.getTime()/1000;\n\t\t\tlet timestamp = Math.floor(current_timestamp - (current_timestamp % 86400)).toFixed(1);\n\n\t\t\tif(this.data[timestamp]) {\n\t\t\t\tdata_value = this.data[timestamp];\n\t\t\t}\n\n\t\t\tif(this.data[Math.round(timestamp)]) {\n\t\t\t\tdata_value = this.data[Math.round(timestamp)];\n\t\t\t}\n\n\t\t\tif(data_value) {\n\t\t\t\tcolor_index = getMaxCheckpoint(data_value, this.distribution);\n\t\t\t}\n\n\t\t\tlet x = 13 + (index + week_col_change) * 12;\n\n\t\t\tlet dataAttr = {\n\t\t\t\t'data-date': getDdMmYyyy(current_date),\n\t\t\t\t'data-value': data_value,\n\t\t\t\t'data-day': current_date.getDay()\n\t\t\t};\n\t\t\tlet heatSquare = makeHeatSquare('day', x, y, square_side,\n\t\t\t\tthis.legend_colors[color_index], dataAttr);\n\n\t\t\tdata_group.appendChild(heatSquare);\n\n\t\t\tlet next_date = new Date(current_date);\n\t\t\taddDays(next_date, 1);\n\t\t\tif(next_date.getTime() > today_time) break;\n\n\n\t\t\tif(next_date.getMonth() - current_date.getMonth()) {\n\t\t\t\tmonth_change = 1;\n\t\t\t\tif(this.discrete_domains) {\n\t\t\t\t\tweek_col_change = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.month_start_points.push(13 + (index + week_col_change) * 12);\n\t\t\t}\n\t\t\tcurrent_date = next_date;\n\t\t}\n\n\t\treturn [data_group, month_change];\n\t}\n\n\trender_month_labels() {\n\t\t// this.first_month_label = 1;\n\t\t// if (this.first_week_start.getDate() > 8) {\n\t\t// \tthis.first_month_label = 0;\n\t\t// }\n\t\t// this.last_month_label = 1;\n\n\t\t// let first_month = this.months.shift();\n\t\t// let first_month_start = this.month_start_points.shift();\n\t\t// render first month if\n\n\t\t// let last_month = this.months.pop();\n\t\t// let last_month_start = this.month_start_points.pop();\n\t\t// render last month if\n\n\t\tthis.months.shift();\n\t\tthis.month_start_points.shift();\n\t\tthis.months.pop();\n\t\tthis.month_start_points.pop();\n\n\t\tthis.month_start_points.map((start, i) => {\n\t\t\tlet month_name =  this.month_names[this.months[i]].substring(0, 3);\n\t\t\tlet text = makeText('y-value-text', start+12, 10, month_name);\n\t\t\tthis.domain_label_group.appendChild(text);\n\t\t});\n\t}\n\n\tmake_graph_components() {\n\t\tArray.prototype.slice.call(\n\t\t\tthis.container.querySelectorAll('.graph-stats-container, .sub-title, .title')\n\t\t).map(d => {\n\t\t\td.style.display = 'None';\n\t\t});\n\t\tthis.chart_wrapper.style.marginTop = '0px';\n\t\tthis.chart_wrapper.style.paddingTop = '0px';\n\t}\n\n\tbind_tooltip() {\n\t\tArray.prototype.slice.call(\n\t\t\tdocument.querySelectorAll(\".data-group .day\")\n\t\t).map(el => {\n\t\t\tel.addEventListener('mouseenter', (e) => {\n\t\t\t\tlet count = e.target.getAttribute('data-value');\n\t\t\t\tlet date_parts = e.target.getAttribute('data-date').split('-');\n\n\t\t\t\tlet month = this.month_names[parseInt(date_parts[1])-1].substring(0, 3);\n\n\t\t\t\tlet g_off = this.chart_wrapper.getBoundingClientRect(), p_off = e.target.getBoundingClientRect();\n\n\t\t\t\tlet width = parseInt(e.target.getAttribute('width'));\n\t\t\t\tlet x = p_off.left - g_off.left + (width+2)/2;\n\t\t\t\tlet y = p_off.top - g_off.top - (width+2)/2;\n\t\t\t\tlet value = count + ' ' + this.count_label;\n\t\t\t\tlet name = ' on ' + month + ' ' + date_parts[0] + ', ' + date_parts[2];\n\n\t\t\t\tthis.tip.set_values(x, y, name, value, [], 1);\n\t\t\t\tthis.tip.show_tip();\n\t\t\t});\n\t\t});\n\t}\n\n\tupdate(data) {\n\t\tthis.data = data;\n\t\tthis.setup_values();\n\t\tthis.bind_tooltip();\n\t}\n}\n","import React from \"react\"\n// import Chart from \"frappe-charts/dist/frappe-charts.min.esm\"\nimport Chart from 'app/lib/chart/js/charts'\n\nclass Comp extends React.Component {\n  constructor(props) {\n    super(props);\n    const {caption, fields, data, colors} = props;\n\n\n    const polished = data.reduce((p, v) => {\n\n      p.labels.push(v.date);\n      fields.forEach(({prop, propTitle, propFormat}) => {\n        const values = p.datasets[propTitle] = p.datasets[propTitle] || [];\n        values.push(propFormat(v[prop]));\n      });\n      return p;\n\n    }, {labels: [], datasets: {}});\n\n    this.state = {\n      title: caption,\n      colors,\n      data: {\n\n        labels: polished.labels,\n\n        datasets: Object.entries(polished.datasets).reduce((p, [title, values]) => {\n          p.push({\n            title,\n            values\n          });\n          return p;\n        }, [])\n      }\n    };\n  }\n\n  componentDidMount() {\n    this._chart = new Chart({\n      parent: this.$chart, // or a DOM element\n      ...this.state,\n      type: 'bar',\n      height: 250,\n\n      format_tooltip_x: d => (d + '').toUpperCase(),\n      format_tooltip_y: d => d + ''\n    });\n  }\n\n  componentWillUnmount() {\n    this._chart.destroy();\n  }\n\n\n  render() {\n    return <div ref={el => this.$chart = el}>\n\n    </div>\n  }\n}\n\n\nexport default Comp\n"],"sourceRoot":""}
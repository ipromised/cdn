(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{620:function(t,e,a){"use strict";a.r(e);var s=a(0),o=a.n(s);var r=class extends o.a.Component{shouldComponentUpdate(t){return this.props.selectedTab!==t.selectedTab}render(){return console.info("Render=> tabs"),o.a.createElement("ul",{className:this.props.tabClass},this.props.tabNames.map(function(t,e){var a={key:e};return this.props.selectedTab===e?a.className="active":a.onClick=this.props.setTab.bind(this,e),o.a.createElement("li",a,o.a.createElement("a",{href:"javascript:void(0);"},t))},this))}};var i=class extends o.a.Component{shouldComponentUpdate(t){return this.props.selectedTab!=t.selectedTab||this.props.order!=t.order}componentDidMount(){this.initTooltip()}initTooltip(){window.$&&$.fn.tipsy&&$(this.getDOMNode()).tipsy({gravity:"s",live:".naked-tooltip",title:function(){return this.getAttribute("data-tip")},html:!0})}render(){console.info("Render=> thead");var t=this.props.field,e=this.props.order,a=this.props.fields,s=this.props.table.fields,r=this.props.table.sortable;return o.a.createElement("thead",null,o.a.createElement("tr",null,a.map(function(i,l){var n=s[i],p=t===i?e:"";if(!n)throw Error("field:"+i+" not in fields list -> ",a);var d={key:l,style:n.style,className:"naked-tooltip "+p,"data-tip":n.tooltip||n.label};return(n.sortable||r&&!1!==n.sortable)&&(d.className+=" sortable",d.onClick=this.props.sort.bind(this,i)),o.a.createElement("th",d,s[i].label)},this)))}},l=a(734);var n=class extends o.a.Component{render(){console.info("Render=> tbody");const{fields:t,fieldsConfig:e,rows:a,loadingTip:s}=this.props;return a&&a.length?o.a.createElement("tbody",null,Object(l.default)(a,t,e)):o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",{colSpan:t.length},s)))}},p=a(734).buildRows;var d=class extends o.a.Component{shouldComponentUpdate(t){return this.props.selectedTab!==t.selectedTab}render(){console.info("Render=> tfoot");var t=this.props.rows;return t&&t.length?o.a.createElement("tfoot",null,p(t,this.props.fields,this.props.table.fields)):null}};var h={jump:function(t,e){"disabled"!==e.currentTarget.className&&this.props.jump(t,e.target.value)},setPageSize:function(t){this.props.setPageSize(t.target.value)},buildPageList:function(){return o.a.createElement("select",{onChange:this.setPageSize},this.props.pageList.map(function(t,e){return o.a.createElement("option",null,t)}))},shouldComponentUpdate:function(t){return this.props.page!==t.page||this.props.pageTotal!==t.pageTotal}};var c,b,u,m=class extends o.a.Component{constructor(t){super(t),Object.assign(this,h)}getPageInfo(){return this.props.page+"/"+this.props.pageTotal}render(){return console.info("Render=> pagination"),o.a.createElement("div",{style:{textAlign:"right"}},o.a.createElement("ul",{className:"nt-pagination"},o.a.createElement("li",{onClick:this.jump.bind(this,"prev"),className:1===this.props.page?"disabled":null},o.a.createElement("a",{href:"javascript:void 0"},"上一页")),o.a.createElement("li",null,this.getPageInfo()),o.a.createElement("li",{onClick:this.jump.bind(this,"next"),className:this.props.page===this.props.pageTotal?"disabled":null},o.a.createElement("a",{href:"javascript:void 0"},"下一页 "))))}};a(750);class g extends o.a.Component{constructor(t){super(t),["setTab","sort","jump","setPageSize"].forEach(t=>this[t]=this[t].bind(this)),this.state=this._getInitialState()}_getInitialState(){const{table:t,data:e}=this.props,a=this.props.tabNames||t.tabs.map(t=>t.label);return t.pageList=t.pageList||[10],this.handleFormSubmit(),{data:e,selectedTab:this.props.selectedTab,page:1,rows:t.pageList[0],pageTotal:Math.ceil(e.total/t.pageList[0]),order:this.props.order,field:this.props.field,tabClass:t.tabClass||this.props.tabClass,showTabs:a&&a.length>1,fields:t.tabs[this.props.selectedTab].fields,tabNames:a}}componentDidMount(){console.info("----component mounted"),this.ajax()}render(){const{showTabs:t,tabClass:e,tabNames:a,fields:s}=this.state,{table:r}=this.props;return console.info("Render=> table"),o.a.createElement("div",{className:this.props.containerClass},t&&o.a.createElement(this.props.Tabs,{tabClass:e,tabNames:a,selectedTab:this.state.selectedTab,setTab:this.setTab,table:r}),o.a.createElement("table",{className:this.props.tableClass},o.a.createElement(this.props.THead,{fields:s,table:this.props.table,field:this.state.field,order:this.state.order,sort:this.sort,selectedTab:this.state.selectedTab}),o.a.createElement(this.props.TBody,{fields:s,fieldsConfig:this.props.table.fields,rows:this.getRows()}),o.a.createElement(this.props.TFoot,{fields:s,fieldsConfig:this.props.table.fields,rows:this.state.data.footer,selectedTab:this.state.selectedTab})),this.props.showPagination&&o.a.createElement(this.props.Pagination,{pageList:this.props.table.pageList,total:this.state.data.total,page:this.state.page,pageTotal:this.state.pageTotal,jump:this.jump,setPageSize:this.setPageSize}))}handleFormSubmit(){this.props.form&&this.props.form.addEventListener("submit",t=>{t.preventDefault(),this.ajax(1)})}sort(t,e){var a=this.state.data.rows;a&&(this.state.field=t,this.state.order="desc"===this.state.order?"asc":"desc",this.props.fetchByPage?this.ajax():(this.doSort(a,t,this.state.order),this.setState({data:{rows:a,total:a.length,footer:this.state.data.footer}})))}sortOnLoad(t){if(t&&t.length){const{order:e,field:a}=this.state;if(!e||!a)return;this.doSort(t,a,e)}}doSort(t,e,a){t.sort((t,a)=>{const s=t[e],o=a[e];return s===o?0:s>o?1:-1}),"desc"===a&&t.reverse()}jump(t,e){let{page:a,pageTotal:s}=this.state;switch(t){case"end":a=s;break;case"prev":a--;break;case"next":a++;break;case"jump":a=+e||1;break;default:a=1}a>s?a=s:a<1&&(a=1),a!==this.state.page&&this.ajax(a)}setPageSize(t){this.props.fetchByPage?this.ajax(1,t):this.setState({rows:t,page:1,pageTotal:Math.ceil(this.state.data.total/t||1)})}setTab(t){const e=this.props.table.tabs[t].fields;this.setState({selectedTab:t,fields:e})}getParams(t,e){return{page:t||this.state.page,rows:e||this.state.rows,field:this.state.field,order:this.state.order}}ajax(t,e){if(!this.props.fetchByPage&&t)return void this.setState({page:t});const a=this.getParams(t,e);this.props.table.loadData&&this.props.table.loadData(a,t=>{const e={};t.total<1&&(e.loadingTip="没有数据可展示"),e.data=t,this.sortOnLoad(t.rows),this.setState({page:this.props.fetchByPage?a.page:1,data:t,pageTotal:Math.ceil(t.total/this.state.rows||1)})})}getRows(){const t=this.state.page,e=this.state.rows,a=this.state.data.rows;return this.props.fetchByPage?a:a.slice((t-1)*e,t*e)}}u={Tabs:r,THead:i,TBody:n,TFoot:d,Pagination:m,containerClass:"naked",tabClass:"nt-nav",tableClass:"nt-table",loadingTip:"Loading ...",tabNames:null,selectedTab:0,form:null,fetchByPage:!1,showPagination:!0,data:{total:0,rows:[]},order:null,field:null,loadData:null},(b="defaultProps")in(c=g)?Object.defineProperty(c,b,{value:u,enumerable:!0,configurable:!0,writable:!0}):c[b]=u;var f=g;const T={fields:{name:{label:"名称",tooltip:"名称名称<span style='color:crimson'>名称名称</span>",format:(t,e,a)=>['<span style="color:#',Math.floor(16777215*Math.random()).toString(16),'">',t,"</span>"].join("")},age:{label:"年龄",sortable:!0},height:{label:"体重",sortable:!0}},tabs:[{label:"tab1",fields:["name","age","height"]},{label:"tab2",fields:["name","height"]}],pageList:[5,7]};e.default=class extends o.a.Component{render(){return o.a.createElement(f,{data:function(t){const e=[];for(let a=t=t||~~(100*Math.random());a>0;a--)e.push({name:"id_"+Math.random(),age:~~(100*Math.random()),height:(100*Math.random()).toFixed(2)});return{total:t,rows:e}}(15),table:T,containerClass:"naked container"})}}},734:function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return r});var s=a(0),o=a.n(s);function r(t,e,a){return t.map((t,s)=>o.a.createElement("tr",{key:s},e.map((e,s)=>{var r=t["_"+e];if(null==r){r=t[e];var i=a[e].format;i&&(r=i(r,e,t)),t["_"+e]=r||""}return o.a.createElement("td",{key:s,dangerouslySetInnerHTML:{__html:r}})})))}},750:function(t,e,a){}}]);
//# sourceMappingURL=15.7d3e544d07515ea9c098.chunk.js.map
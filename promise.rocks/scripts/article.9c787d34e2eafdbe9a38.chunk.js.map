{"version":3,"sources":["webpack:///./app/components/views/Article.js","webpack:///./app/components/containers/ArticleContainer.js","webpack:///./app/components/widgets/Spinner.js"],"names":["Article","md","showEdit","counter","className","style","position","margin","id","dangerouslySetInnerHTML","__html","md_render","render","content","display","to","parallax","title","document","querySelector","setProperty","body","scrollTop","documentElement","handleScroll","requestAnimationFrame","ArticleContainer","React","Component","componentDidMount","this","props","getMarkdown","match","params","getCounter","window","addEventListener","componentWillUnmount","removeEventListener","componentWillReceiveProps","nextProps","nextState","componentDidUpdate","transform","Spinner","propTypes","PropTypes","shape","string","modified","instanceOf","Date","isRequired","bool","number","func","mapDispatchToProps","connect","store","markdownState","owner","user","name","textAlign","marginTop"],"mappings":"6IAOe,SAASA,GAAQ,GAACC,EAAD,SAAKC,EAAL,QAAeC,IAE7C,OAAO,0BAAMC,UAAU,aACrB,6BAASA,UAAU,iBACjB,yBAAKC,MAAO,CAACC,SAAU,SAAUC,OAAQ,UAAWC,GAAG,MAClDC,wBAAyB,CAACC,OAAQC,IAAUC,OAAOX,EAAGY,SAAW,OACtE,yBAAKR,MAAO,CAACS,QAASZ,EAAW,QAAU,SACzC,kBAAC,OAAD,CAAMa,GAAI,UAAYd,EAAGO,GAAIJ,UAAU,qCACnB,0BAAMA,UAAU,QACZ,uBAAGA,UAAU,gBAEnC,0C,8CCVV,MAGMY,EAAW,KACf,MAAMC,EAAQC,SAASC,cAAc,WACrCF,GAASA,EAAMZ,MAAMe,YAAY,mBALrB,IAK0CF,SAASG,KAAKC,WAAaJ,SAASK,gBAAgBD,aAGtGE,EAAe,KACnBC,sBAAsBT,IAMxB,MAAMU,UAAyBC,IAAMC,UAEnCC,oBACEC,KAAKC,MAAMC,YAAYF,KAAKC,MAAME,MAAMC,OAAO1B,IAAI,GACnDsB,KAAKC,MAAMI,WAAWL,KAAKC,MAAME,MAAMC,OAAO1B,IAC9C4B,OAAOC,iBAAiB,SAAUb,GAGpCc,uBACEF,OAAOG,oBAAoB,SAAUf,GAGvCgB,0BAA0BC,EAAWC,GAE/BZ,KAAKC,MAAME,MAAMC,OAAO1B,KAAOiC,EAAUR,MAAMC,OAAO1B,KACxDsB,KAAKC,MAAMC,YAAYS,EAAUR,MAAMC,OAAO1B,IAAI,GAClDsB,KAAKC,MAAMI,WAAWL,KAAKC,MAAME,MAAMC,OAAO1B,KAIlDmC,qBACEzB,SAASD,MAAQa,KAAKC,MAAM9B,GAAGgB,MAC/B,MAAMA,EAAQC,SAASC,cAAc,WAChCF,IAGLA,EAAMZ,MAAM,eAAiB,YAC7BY,EAAMZ,MAAMuC,UAAY,qDAG1BhC,SACE,MAAM,GAACX,GAAM6B,KAAKC,MAElB,OAAK9B,EAAGO,GAGD,kBAACR,EAAY8B,KAAKC,OAFhB,kBAACc,EAAA,EAAD,OAMbnB,EAAiBoB,UAAY,CAC3B7C,GAAI8C,IAAUC,MAAM,CAChBxC,GAAIyC,SACJhC,MAAOgC,SACPpC,QAASoC,SACTC,SAAUH,IAAUI,WAAWC,QAEjCC,WACFnD,SAAU6C,IAAUO,KAAKD,WACzBlD,QAAS4C,IAAUQ,OAAOF,WAC1BrB,YAAawB,OAAKH,WAClBlB,WAAYqB,OAAKH,YAInB,MASMI,EAAqB,CACzBzB,gBACAG,gBAGauB,4BAdSC,IACtB,MAAOC,eAAe,GAAC3D,GAAjB,QAAsBE,GAAWwD,EACvC,MAAO,CACL1D,KACAC,SAAUD,EAAG4D,QAAUF,EAAMG,KAAKtD,GAClCL,QAASA,EAAQF,EAAGO,KAAO,IASSiD,EAAzBC,CAA6ChC,I,wuBCtF7C,MAAEqC,OAAO,eAAgB1D,QAAQ,MAEvC,kBAAC,IAAD,CAASA,MAAK,GAAG2D,UAAW,SAAUC,UAAW,OAAU5D,GAAQ0D,KAAMA","file":"scripts/article.9c787d34e2eafdbe9a38.chunk.js","sourcesContent":["import React from \"react\"\nimport {Link} from \"react-router-dom\"\nimport md_render from \"../../lib/md\"\n\n/**\n * 用来渲染markdown详情\n */\nexport default function Article({md, showEdit, counter}) {\n\n  return <main className=\"container\">\n    <section className=\"markdown-body\">\n      <div style={{position: 'static', margin: '0 auto'}} id=\"out\"\n           dangerouslySetInnerHTML={{__html: md_render.render(md.content || '')}}/>\n      <div style={{display: showEdit ? 'block' : 'none'}}>\n        <Link to={'/write/' + md.id} className=\"button is-primary is-pulled-right\">\n                            <span className=\"icon\">\n                                <i className=\"fa fa-edit\"/>\n                            </span>\n          <span>Edit</span>\n        </Link>\n      </div>\n    </section>\n  </main>\n}\n","import React from \"react\"\nimport {connect} from \"react-redux\"\nimport Article from \"../views/Article\"\nimport {getMarkdown} from \"../../api/markdownApi\"\nimport {getCounter} from \"../../actions/counterApiInvoker\"\nimport Spinner from \"../widgets/Spinner\"\nimport PropTypes, {string, func, date} from 'prop-types'\n\nconst speed = 0.2;\n\n\nconst parallax = () => {\n  const title = document.querySelector('#out>h1');\n  title && title.style.setProperty(\"--scrollparallax\", (document.body.scrollTop || document.documentElement.scrollTop) * speed)\n};\n\nconst handleScroll = () => {\n  requestAnimationFrame(parallax);\n};\n\n/**\n * 文章详情\n */\nclass ArticleContainer extends React.Component {\n\n  componentDidMount() {\n    this.props.getMarkdown(this.props.match.params.id, false);\n    this.props.getCounter(this.props.match.params.id);\n    window.addEventListener('scroll', handleScroll);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', handleScroll);\n  }\n\n  componentWillReceiveProps(nextProps, nextState) {\n    // 从文章1切换到文章2，变化的只是id\n    if (this.props.match.params.id !== nextProps.match.params.id) {\n      this.props.getMarkdown(nextProps.match.params.id, false);\n      this.props.getCounter(this.props.match.params.id);\n    }\n  }\n\n  componentDidUpdate() {\n    document.title = this.props.md.title;\n    const title = document.querySelector('#out>h1');\n    if (!title) {\n      return;\n    }\n    title.style['will-change'] = 'transform';\n    title.style.transform = 'translateY( calc( var(--scrollparallax) * 1px ) )';\n  }\n\n  render() {\n    const {md} = this.props;\n\n    if (!md.id) {\n      return <Spinner/>\n    }\n    return <Article {...this.props}/>\n  }\n}\n\nArticleContainer.propTypes = {\n  md: PropTypes.shape({\n      id: string,\n      title: string,\n      content: string,\n      modified: PropTypes.instanceOf(Date)\n    },\n  ).isRequired,\n  showEdit: PropTypes.bool.isRequired,\n  counter: PropTypes.number.isRequired,\n  getMarkdown: func.isRequired,\n  getCounter: func.isRequired\n};\n\n\nconst mapStateToProps = store => {\n  const {markdownState: {md}, counter} = store;\n  return {\n    md,\n    showEdit: md.owner === store.user.id,\n    counter: counter[md.id] || 1\n  }\n};\n\nconst mapDispatchToProps = {\n  getMarkdown,\n  getCounter\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ArticleContainer);\n\n","import React from \"react\"\nimport Spinner from \"react-spinkit\"\n\n/**\n * 加载条\n */\nexport default ({name = 'three-bounce', style = {}}) => {\n\n  return <Spinner style={{textAlign: 'center', marginTop: '20%', ...style}} name={name}/>\n}\n"],"sourceRoot":""}
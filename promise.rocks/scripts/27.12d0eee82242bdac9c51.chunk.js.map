{"version":3,"sources":["webpack:///./app/lib/chart/js/utils/dom.js","webpack:///./app/lib/chart/js/utils/draw-utils.js","webpack:///./app/lib/chart/js/utils/draw.js","webpack:///./app/lib/chart/js/utils/animate.js","webpack:///./app/lib/chart/js/utils/animation.js","webpack:///./app/lib/chart/js/utils/intervals.js","webpack:///./app/lib/chart/js/utils/helpers.js","webpack:///./app/lib/chart/js/objects/SvgTip.js","webpack:///./app/lib/chart/js/utils/colors.js","webpack:///./app/lib/chart/js/charts/BaseChart.js","webpack:///./app/lib/chart/js/charts/AxisChart.js","webpack:///./app/lib/chart/js/charts/LineChart.js","webpack:///./app/lib/chart/js/charts/PieChart.js","webpack:///./app/lib/chart/js/utils/date-utils.js","webpack:///./app/lib/chart/js/charts.js","webpack:///./app/lib/chart/js/charts/BarChart.js","webpack:///./app/lib/chart/js/charts/ScatterChart.js","webpack:///./app/lib/chart/js/charts/PercentageChart.js","webpack:///./app/lib/chart/js/charts/Heatmap.js","webpack:///./app/components/containers/dynamic/stock/StockChart.js"],"names":["$","expr","con","document","querySelector","offset","element","rect","getBoundingClientRect","top","documentElement","scrollTop","body","left","scrollLeft","getBarHeightAndYAttr","yTop","zeroLine","totalHeight","height","y","draw_$","createSVG","tag","o","createElementNS","i","val","appendChild","ref","parentNode","insertBefore","Object","keys","map","prop","style","setAttribute","setGradientStop","gradElem","color","opacity","inside","stop-opacity","makeSVGGroup","parent","className","transform","makePath","pathStr","stroke","fill","d","styles","makeGradient","svgDefElem","lighter","gradientId","gradientDef","id","x1","x2","y1","y2","renderVerticalGradient","opacities","makeHeatSquare","x","size","data","args","width","key","makeXLine","textStartAt","point","labelClass","axisLineClass","xPos","line","text","dy","innerHTML","xLine","makeYLine","startAt","textEndAt","yPos","darker","lineType","yLine","stroke-opacity","create","createElement","bind","event","callback","split","forEach","addEventListener","unbind","removeEventListener","fire","target","type","properties","evt","createEvent","j","initEvent","dispatchEvent","UnitRenderer","draw_UnitRenderer","avgUnitWidth","this","prototype","bar","index","datasetIndex","noOfDatasets","totalWidth","spaceWidth","currentX","data-point-index","dot","cx","cy","r","radius","Animator","animate_Animator","barObj","start","dotObj","path","pathComponents","animPath","unit","object","push","regionPath","regStartPt","regEndPt","animRegion","EASING","ease","linear","easein","easeout","easeinout","animation_transform","webkitTransform","msTransform","mozTransform","oTransform","runSVGAnimation","svgContainer","elements","newElements","animElements","animElement","newElement","obj","props","dur","easingType","oldValues","cloneNode","attributeName","animateElement","currentValue","getAttribute","value","animAttr","from","to","begin","values","keySplines","keyTimes","calcMode","animateSVG","replaceChild","array","animSvg","normalize","isNaN","mantissa","exponent","sig","isFinite","Math","abs","exp","floor","log10","pow","getIntervals","maxValue","minValue","normalMaxValue","normalMinValue","intervals","max","min","upperBound","ceil","lowerBound","range","noOfParts","partSize","getRangeIntervals","toFixed","getMaxCheckpoint","distribution","filter","length","floatTwo","parseFloat","arraysEqual","arr1","arr2","areEqual","getStringWidth","string","charWidth","SvgTip_SvgTip","constructor","colors","title_name","title_value","list_values","title_value_first","setup","make_tooltip","refresh","calc_position","container","hide_tip","title","data_point_list","set","li","border-top","offsetWidth","offsetHeight","max_left","pointer","pointer_offset","set_values","show_tip","PRESET_COLOR_MAP","light-blue","blue","violet","red","orange","yellow","green","light-green","purple","magenta","black","grey","light-grey","dark-grey","DEFAULT_COLORS","limitColor","getColor","ALL_CHART_TYPES","COMPATIBLE_CHARTS","pie","scatter","percentage","heatmap","COLOR_COMPATIBLE_CHARTS","BaseChart_BaseChart","subtitle","summary","is_navigable","has_legend","raw_chart_args","arguments","specific_values","current_index","setColors","set_margins","get_different_chart","includes","console","error","use_color","Chart","undefined","list","labels","datasets","base_height","translate_x","translate_y","validate_and_prepare_data","bind_window_events","window","destroy","init","setup_base_values","set_width","setup_container","setup_components","setup_values","setup_utils","make_graph_components","show_custom_summary","show_summary","setup_navigation","special_values_width","padding","str_width","base_width","getComputedStyle","paddingLeft","paddingRight","clientWidth","chart_wrapper","stats_wrapper","make_chart_area","make_draw_area","svg","svg_defs","draw_area","tip","bind_tooltip","stats","el","make_overlay","bind_overlay","e","bottom","innerHeight","clientHeight","right","innerWidth","keyCode","on_left_arrow","on_right_arrow","on_up_arrow","on_down_arrow","on_enter_key","bind_units","get_data_point","data_point","data_key","slice","label","update_current_data_point","parseInt","makeDrawAreaComponent","AxisChart_AxisChart","super","is_series","format_tooltip_y","format_tooltip_x","zero_line","setup_x","setup_y","set_avg_unit_width_and_x_offset","x_axis_positions","x_old_axis_positions","x_offset","avg_unit_width","y_axis_values","y_old_axis_values","get_all_y_values","y_sums","concat","withMinimum","getPositiveFirstIntervals","absMinValue","intervalSize","unshift","pseudoMaxValue","pseudoMinValue","reverse","calcIntervals","y_pts","value_range","multiplier","old_multiplier","interval","interval_height","zero_index","indexOf","old_zero_line","setup_marker_components","setup_aggregation_components","setup_graph_components","y_axis_group","x_axis_group","specific_y_group","sum_group","average_group","svg_units_groups","make_y_axis","make_x_axis","draw_graph","make_y_specifics","animate","start_at","text_start_at","axis_line_class","x_axis_mode","make_anim_x_axis","allowed_space","allowed_letters","textContent","space_taken","skips","make_anim_y_axis","make_anim_y_specifics","text_end_at","get_y_axis_line_props","specific","y_axis_mode","hasOwnProperty","draw_new_graph_and_animate","svg_units","make_path","y_tops","make_new_units","calc_y_dependencies","Array","setTimeout","update_values","make_new_units_for_dataset","x_values","y_values","dataset_index","no_of_datasets","units_group","units_array","unit_args","unit_renderer","data_unit","toUpperCase","line_type","relX","pageX","pageY","map_tooltip_x_position_and_show","y_min_tops","titles","y_format","x_val","show_sums","updating","sum_units","hide_sums","show_averages","old_specific_values","sum","average","auto","hide_averages","indices_to_remove","splice","new_y","new_x","elements_to_animate","old_x_values","old_y_axis_tops","old_y_values","no_of_extra_pts","animator","animate_graphs","run_animation","add_data_point","y_point","x_point","data_set","remove_data_point","anim_svg","removeChild","old_x","old_y","calc_old_and_new_postions","animate_path","animate_units","newPathStr","join","last_old_x_pos","last_old_y_pos","last_new_x_pos","last_new_y_pos","filler_x","filler_y","old_pos","new_pos","old_vals","new_vals","last_line_pos","make_new_axis_anim_lines","substring","x_line","add_and_animate_y_line","add_and_animate_line","group","superimposed_positions","superimposed_values","no_of_extras","filler_vals","filler_pos","extra_values","extra_positions","filler","new_props","old_props","axis_label_class","y_line","all_values","y_top","LineChart_LineChart","show_dots","region_fill","getPrototypeOf","dot_radius","heatline","setup_path_groups","paths_groups","make_paths","x_positions","y_positions","points_str","gradient_id","fill_region_for_dataset","ANGLE_RATIO","PI","FULL_ANGLE","PieChart_PieChart","hoverRadio","max_slices","max_legend_points","isAnimate","startAngle","clockWise","mouseMove","mouseLeave","centerX","centerY","slice_totals","all_totals","total","totals","sort","a","b","sum_of_others","legend_totals","[object Object]","angle","sin","cos","makeArcPath","startPosition","endPosition","grand_total","reduce","prevSlicesProperties","slicesProperties","slices","curAngle","originDiffAngle","diffAngle","endAngle","getPositionByAngle","prevProperty","curStart","curEnd","curPath","transition","calTranslateByAngle","property","position","hoverSlice","flag","amt","col","usePound","num","g","toString","lightenDarkenColor","g_off","formatted_labels","percent","prevIndex","curActiveSliceIndex","prevAcitve","curActiveSlice","treatAsUtc","dateStr","result","Date","setMinutes","getMinutes","getTimezoneOffset","getDdMmYyyy","date","dd","getDate","mm","getMonth","getFullYear","getWeeksBetween","startDateStr","endDateStr","getDaysBetween","addDays","numberOfDays","setDate","chartTypes","overlay","update_overlay","svg_unit","attributes","attr","specified","name","nodeValue","marginTop","marginBottom","paddingTop","chart_div","chart","percentage_bar","background","p_off","domain","subdomain","discrete_domains","count_label","legend_colors","today","validate_colors","distribution_size","valid","test","isValidColor","warn","setFullYear","first_week_start","toDateString","last_week_start","getDay","no_of_cols","domain_label_group","data_groups","data_values","distributionSize","dataMaxValue","distributionStep","checkpoint","calcDistribution","month_names","render_all_weeks_and_store_x_values","no_of_weeks","current_week_sunday","week_col","current_month","months","month_weeks","month_start_points","data_group","month_change","day","get_week_squares_group","render_month_labels","current_date","today_time","getTime","week_col_change","square_side","data_value","color_index","current_timestamp","timestamp","round","dataAttr","data-date","data-value","data-day","heatSquare","next_date","shift","pop","month_name","call","querySelectorAll","display","count","date_parts","month","update","chartType","options","getChartByType","__webpack_exports__","react_default","Component","caption","fields","polished","p","v","propTitle","propFormat","state","entries","componentDidMount","_chart","_objectSpread","$chart","componentWillUnmount","render"],"mappings":"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","file":"scripts/27.12d0eee82242bdac9c51.chunk.js","sourcesContent":["export function $(expr, con) {\n\treturn typeof expr === \"string\"? (con || document).querySelector(expr) : expr || null;\n}\n\nexport function findNodeIndex(node)\n{\n\tvar i = 0;\n\twhile (node.previousSibling) {\n\t\tnode = node.previousSibling;\n\t\ti++;\n\t}\n\treturn i;\n}\n\n$.create = (tag, o) => {\n\tvar element = document.createElement(tag);\n\n\tfor (var i in o) {\n\t\tvar val = o[i];\n\n\t\tif (i === \"inside\") {\n\t\t\t$(val).appendChild(element);\n\t\t}\n\t\telse if (i === \"around\") {\n\t\t\tvar ref = $(val);\n\t\t\tref.parentNode.insertBefore(element, ref);\n\t\t\telement.appendChild(ref);\n\n\t\t} else if (i === \"styles\") {\n\t\t\tif(typeof val === \"object\") {\n\t\t\t\tObject.keys(val).map(prop => {\n\t\t\t\t\telement.style[prop] = val[prop];\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (i in element ) {\n\t\t\telement[i] = val;\n\t\t}\n\t\telse {\n\t\t\telement.setAttribute(i, val);\n\t\t}\n\t}\n\n\treturn element;\n};\n\nexport function offset(element) {\n\tlet rect = element.getBoundingClientRect();\n\treturn {\n\t\t// https://stackoverflow.com/a/7436602/6495043\n\t\t// rect.top varies with scroll, so we add whatever has been\n\t\t// scrolled to it to get absolute distance from actual page top\n\t\ttop: rect.top + (document.documentElement.scrollTop || document.body.scrollTop),\n\t\tleft: rect.left + (document.documentElement.scrollLeft || document.body.scrollLeft)\n\t};\n}\n\nexport function isElementInViewport(el) {\n\t// Although straightforward: https://stackoverflow.com/a/7557433/6495043\n\tvar rect = el.getBoundingClientRect();\n\n\treturn (\n\t\trect.top >= 0 &&\n        rect.left >= 0 &&\n        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) && /*or $(window).height() */\n        rect.right <= (window.innerWidth || document.documentElement.clientWidth) /*or $(window).width() */\n\t);\n}\n\nexport function getElementContentWidth(element) {\n\tvar styles = window.getComputedStyle(element);\n\tvar padding = parseFloat(styles.paddingLeft) +\n\t\tparseFloat(styles.paddingRight);\n\n\treturn element.clientWidth - padding;\n}\n\n$.bind = (element, o) => {\n\tif (element) {\n\t\tfor (var event in o) {\n\t\t\tvar callback = o[event];\n\n\t\t\tevent.split(/\\s+/).forEach(function (event) {\n\t\t\t\telement.addEventListener(event, callback);\n\t\t\t});\n\t\t}\n\t}\n};\n\n$.unbind = (element, o) => {\n\tif (element) {\n\t\tfor (var event in o) {\n\t\t\tvar callback = o[event];\n\n\t\t\tevent.split(/\\s+/).forEach(function(event) {\n\t\t\t\telement.removeEventListener(event, callback);\n\t\t\t});\n\t\t}\n\t}\n};\n\n$.fire = (target, type, properties) => {\n\tvar evt = document.createEvent(\"HTMLEvents\");\n\n\tevt.initEvent(type, true, true );\n\n\tfor (var j in properties) {\n\t\tevt[j] = properties[j];\n\t}\n\n\treturn target.dispatchEvent(evt);\n};\n","export function getBarHeightAndYAttr(yTop, zeroLine, totalHeight) {\n\tlet height, y;\n\tif (yTop <= zeroLine) {\n\t\theight = zeroLine - yTop;\n\t\ty = yTop;\n\n\t\t// In case of invisible bars\n\t\tif(height === 0) {\n\t\t\theight = totalHeight * 0.01;\n\t\t\ty -= height;\n\t\t}\n\t} else {\n\t\theight = yTop - zeroLine;\n\t\ty = zeroLine;\n\n\t\t// In case of invisible bars\n\t\tif(height === 0) {\n\t\t\theight = totalHeight * 0.01;\n\t\t}\n\t}\n\n\treturn [height, y];\n}\n","import { getBarHeightAndYAttr } from './draw-utils';\n\n// Constants used\n\nfunction $(expr, con) {\n\treturn typeof expr === \"string\"? (con || document).querySelector(expr) : expr || null;\n}\n\nfunction createSVG(tag, o) {\n\tvar element = document.createElementNS(\"http://www.w3.org/2000/svg\", tag);\n\n\tfor (var i in o) {\n\t\tvar val = o[i];\n\n\t\tif (i === \"inside\") {\n\t\t\t$(val).appendChild(element);\n\t\t}\n\t\telse if (i === \"around\") {\n\t\t\tvar ref = $(val);\n\t\t\tref.parentNode.insertBefore(element, ref);\n\t\t\telement.appendChild(ref);\n\n\t\t} else if (i === \"styles\") {\n\t\t\tif(typeof val === \"object\") {\n\t\t\t\tObject.keys(val).map(prop => {\n\t\t\t\t\telement.style[prop] = val[prop];\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif(i === \"className\") { i = \"class\"; }\n\t\t\tif(i === \"innerHTML\") {\n\t\t\t\telement['textContent'] = val;\n\t\t\t} else {\n\t\t\t\telement.setAttribute(i, val);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn element;\n}\n\nfunction renderVerticalGradient(svgDefElem, gradientId) {\n\treturn createSVG('linearGradient', {\n\t\tinside: svgDefElem,\n\t\tid: gradientId,\n\t\tx1: 0,\n\t\tx2: 0,\n\t\ty1: 0,\n\t\ty2: 1\n\t});\n}\n\nfunction setGradientStop(gradElem, offset, color, opacity) {\n\treturn createSVG('stop', {\n\t\t'inside': gradElem,\n\t\t'style': `stop-color: ${color}`,\n\t\t'offset': offset,\n\t\t'stop-opacity': opacity\n\t});\n}\n\nexport function makeSVGContainer(parent, className, width, height) {\n\treturn createSVG('svg', {\n\t\tclassName: className,\n\t\tinside: parent,\n\t\twidth: width,\n\t\theight: height\n\t});\n}\n\nexport function makeSVGDefs(svgContainer) {\n\treturn createSVG('defs', {\n\t\tinside: svgContainer,\n\t});\n}\n\nexport function makeSVGGroup(parent, className, transform='') {\n\treturn createSVG('g', {\n\t\tclassName: className,\n\t\tinside: parent,\n\t\ttransform: transform\n\t});\n}\n\nexport function makePath(pathStr, className='', stroke='none', fill='none') {\n\treturn createSVG('path', {\n\t\tclassName: className,\n\t\td: pathStr,\n\t\tstyles: {\n\t\t\tstroke: stroke,\n\t\t\tfill: fill\n\t\t}\n\t});\n}\n\nexport function makeGradient(svgDefElem, color, lighter = false) {\n\tlet gradientId ='path-fill-gradient' + '-' + color;\n\tlet gradientDef = renderVerticalGradient(svgDefElem, gradientId);\n\tlet opacities = [1, 0.6, 0.2];\n\tif(lighter) {\n\t\topacities = [0.4, 0.2, 0];\n\t}\n\n\tsetGradientStop(gradientDef, \"0%\", color, opacities[0]);\n\tsetGradientStop(gradientDef, \"50%\", color, opacities[1]);\n\tsetGradientStop(gradientDef, \"100%\", color, opacities[2]);\n\n\treturn gradientId;\n}\n\nexport function makeHeatSquare(className, x, y, size, fill='none', data={}) {\n\tlet args = {\n\t\tclassName: className,\n\t\tx: x,\n\t\ty: y,\n\t\twidth: size,\n\t\theight: size,\n\t\tfill: fill\n\t};\n\n\tObject.keys(data).map(key => {\n\t\targs[key] = data[key];\n\t});\n\n\treturn createSVG(\"rect\", args);\n}\n\nexport function makeText(className, x, y, content) {\n\treturn createSVG('text', {\n\t\tclassName: className,\n\t\tx: x,\n\t\ty: y,\n\t\tdy: '.32em',\n\t\tinnerHTML: content\n\t});\n}\n\nexport function makeXLine(height, textStartAt, point, labelClass, axisLineClass, xPos) {\n\tlet line = createSVG('line', {\n\t\tx1: 0,\n\t\tx2: 0,\n\t\ty1: 0,\n\t\ty2: height\n\t});\n\n\tlet text = createSVG('text', {\n\t\tclassName: labelClass,\n\t\tx: 0,\n\t\ty: textStartAt,\n\t\tdy: '.71em',\n\t\tinnerHTML: point\n\t});\n\n\tlet xLine = createSVG('g', {\n\t\tclassName: `tick ${axisLineClass}`,\n\t\ttransform: `translate(${ xPos }, 0)`\n\t});\n\n\txLine.appendChild(line);\n\txLine.appendChild(text);\n\n\treturn xLine;\n}\n\nexport function makeYLine(startAt, width, textEndAt, point, labelClass, axisLineClass, yPos, darker=false, lineType=\"\") {\n\tlet line = createSVG('line', {\n\t\tclassName: lineType === \"dashed\" ? \"dashed\": \"\",\n\t\tx1: startAt,\n\t\tx2: width,\n\t\ty1: 0,\n\t\ty2: 0\n\t});\n\n\tlet text = createSVG('text', {\n\t\tclassName: labelClass,\n\t\tx: textEndAt,\n\t\ty: 0,\n\t\tdy: '.32em',\n\t\tinnerHTML: point+\"\"\n\t});\n\n\tlet yLine = createSVG('g', {\n\t\tclassName: `tick ${axisLineClass}`,\n\t\ttransform: `translate(0, ${yPos})`,\n\t\t'stroke-opacity': 1\n\t});\n\n\tif(darker) {\n\t\tline.style.stroke = \"rgba(27, 31, 35, 0.6)\";\n\t}\n\n\tyLine.appendChild(line);\n\tyLine.appendChild(text);\n\n\treturn yLine;\n}\n\nexport var UnitRenderer = (function() {\n\tvar UnitRenderer = function(totalHeight, zeroLine, avgUnitWidth) {\n\t\tthis.totalHeight = totalHeight;\n\t\tthis.zeroLine = zeroLine;\n\t\tthis.avgUnitWidth = avgUnitWidth;\n\t};\n\n\tUnitRenderer.prototype = {\n\t\tbar: function (x, yTop, args, color, index, datasetIndex, noOfDatasets) {\n\t\t\tlet totalWidth = this.avgUnitWidth - args.spaceWidth;\n\t\t\tlet startX = x - totalWidth/2;\n\n\t\t\tlet width = totalWidth / noOfDatasets;\n\t\t\tlet currentX = startX + width * datasetIndex;\n\n\t\t\tlet [height, y] = getBarHeightAndYAttr(yTop, this.zeroLine, this.totalHeight);\n\n\t\t\treturn createSVG('rect', {\n\t\t\t\tclassName: `bar mini`,\n\t\t\t\tstyle: `fill: ${color}`,\n\t\t\t\t'data-point-index': index,\n\t\t\t\tx: currentX,\n\t\t\t\ty: y,\n\t\t\t\twidth: width,\n\t\t\t\theight: height\n\t\t\t});\n\t\t},\n\n\t\tdot: function(x, y, args, color, index) {\n\t\t\treturn createSVG('circle', {\n\t\t\t\tstyle: `fill: ${color}`,\n\t\t\t\t'data-point-index': index,\n\t\t\t\tcx: x,\n\t\t\t\tcy: y,\n\t\t\t\tr: args.radius\n\t\t\t});\n\t\t}\n\t};\n\n\treturn UnitRenderer;\n})();\n","import { getBarHeightAndYAttr } from './draw-utils';\n\nexport function getAnimXLine() {}\n\nexport function getAnimYLine() {}\n\nexport var Animator = (function() {\n\tvar Animator = function(totalHeight, totalWidth, zeroLine, avgUnitWidth) {\n\t\t// constants\n\t\tthis.totalHeight = totalHeight;\n\t\tthis.totalWidth = totalWidth;\n\n\t\t// changeables\n\t\tthis.avgUnitWidth = avgUnitWidth;\n\t\tthis.zeroLine = zeroLine;\n\t};\n\n\tAnimator.prototype = {\n\t\tbar: function(barObj, x, yTop, index, noOfDatasets) {\n\t\t\tlet start = x - this.avgUnitWidth/4;\n\t\t\tlet width = (this.avgUnitWidth/2)/noOfDatasets;\n\t\t\tlet [height, y] = getBarHeightAndYAttr(yTop, this.zeroLine, this.totalHeight);\n\n\t\t\tx = start + (width * index);\n\n\t\t\treturn [barObj, {width: width, height: height, x: x, y: y}, 350, \"easein\"];\n\t\t\t// bar.animate({height: args.newHeight, y: yTop}, 350, mina.easein);\n\t\t},\n\n\t\tdot: function(dotObj, x, yTop) {\n\t\t\treturn [dotObj, {cx: x, cy: yTop}, 350, \"easein\"];\n\t\t\t// dot.animate({cy: yTop}, 350, mina.easein);\n\t\t},\n\n\t\tpath: function(d, pathStr) {\n\t\t\tlet pathComponents = [];\n\t\t\tconst animPath = [{unit: d.path, object: d, key: 'path'}, {d:\"M\"+pathStr}, 350, \"easein\"];\n\t\t\tpathComponents.push(animPath);\n\n\t\t\tif(d.regionPath) {\n\t\t\t\tlet regStartPt = `0,${this.zeroLine}L`;\n\t\t\t\tlet regEndPt = `L${this.totalWidth}, ${this.zeroLine}`;\n\n\t\t\t\tconst animRegion = [\n\t\t\t\t\t{unit: d.regionPath, object: d, key: 'regionPath'},\n\t\t\t\t\t{d:\"M\" + regStartPt + pathStr + regEndPt},\n\t\t\t\t\t350,\n\t\t\t\t\t\"easein\"\n\t\t\t\t];\n\t\t\t\tpathComponents.push(animRegion);\n\t\t\t}\n\n\t\t\treturn pathComponents;\n\t\t},\n\t};\n\n\treturn Animator;\n})();\n","// Leveraging SMIL Animations\n\nconst EASING = {\n\tease: \"0.25 0.1 0.25 1\",\n\tlinear: \"0 0 1 1\",\n\t// easein: \"0.42 0 1 1\",\n\teasein: \"0.1 0.8 0.2 1\",\n\teaseout: \"0 0 0.58 1\",\n\teaseinout: \"0.42 0 0.58 1\"\n};\n\nfunction animateSVG(element, props, dur, easingType=\"linear\", type=undefined, oldValues={}) {\n\n\tlet animElement = element.cloneNode(true);\n\tlet newElement = element.cloneNode(true);\n\n\tfor(var attributeName in props) {\n\t\tlet animateElement;\n\t\tif(attributeName === 'transform') {\n\t\t\tanimateElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"animateTransform\");\n\t\t} else {\n\t\t\tanimateElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"animate\");\n\t\t}\n\t\tlet currentValue = oldValues[attributeName] || element.getAttribute(attributeName);\n\t\tlet value = props[attributeName];\n\n\t\tlet animAttr = {\n\t\t\tattributeName: attributeName,\n\t\t\tfrom: currentValue,\n\t\t\tto: value,\n\t\t\tbegin: \"0s\",\n\t\t\tdur: dur/1000 + \"s\",\n\t\t\tvalues: currentValue + \";\" + value,\n\t\t\tkeySplines: EASING[easingType],\n\t\t\tkeyTimes: \"0;1\",\n\t\t\tcalcMode: \"spline\",\n\t\t\tfill: 'freeze'\n\t\t};\n\n\t\tif(type) {\n\t\t\tanimAttr[\"type\"] = type;\n\t\t}\n\n\t\tfor (var i in animAttr) {\n\t\t\tanimateElement.setAttribute(i, animAttr[i]);\n\t\t}\n\n\t\tanimElement.appendChild(animateElement);\n\n\t\tif(type) {\n\t\t\tnewElement.setAttribute(attributeName, `translate(${value})`);\n\t\t} else {\n\t\t\tnewElement.setAttribute(attributeName, value);\n\t\t}\n\t}\n\n\treturn [animElement, newElement];\n}\n\nexport function transform(element, style) { // eslint-disable-line no-unused-vars\n\telement.style.transform = style;\n\telement.style.webkitTransform = style;\n\telement.style.msTransform = style;\n\telement.style.mozTransform = style;\n\telement.style.oTransform = style;\n}\n\nexport function runSVGAnimation(svgContainer, elements) {\n\tlet newElements = [];\n\tlet animElements = [];\n\n\telements.map(element => {\n\t\tlet obj = element[0];\n\t\tlet parent = obj.unit.parentNode;\n\n\t\tlet animElement, newElement;\n\n\t\telement[0] = obj.unit;\n\t\t[animElement, newElement] = animateSVG(...element);\n\n\t\tnewElements.push(newElement);\n\t\tanimElements.push([animElement, parent]);\n\n\t\tparent.replaceChild(animElement, obj.unit);\n\n\t\tif(obj.array) {\n\t\t\tobj.array[obj.index] = newElement;\n\t\t} else {\n\t\t\tobj.object[obj.key] = newElement;\n\t\t}\n\t});\n\n\tlet animSvg = svgContainer.cloneNode(true);\n\n\tanimElements.map((animElement, i) => {\n\t\tanimElement[1].replaceChild(newElements[i], animElement[0]);\n\t\telements[i][0] = newElements[i];\n\t});\n\n\treturn animSvg;\n}\n","function normalize(x) {\n\t// Calculates mantissa and exponent of a number\n\t// Returns normalized number and exponent\n\t// https://stackoverflow.com/q/9383593/6495043\n\n\tif(x===0) {\n\t\treturn [0, 0];\n\t}\n\tif(isNaN(x)) {\n\t\treturn {mantissa: -6755399441055744, exponent: 972};\n\t}\n\tvar sig = x > 0 ? 1 : -1;\n\tif(!isFinite(x)) {\n\t\treturn {mantissa: sig * 4503599627370496, exponent: 972};\n\t}\n\n\tx = Math.abs(x);\n\tvar exp = Math.floor(Math.log10(x));\n\tvar man = x/Math.pow(10, exp);\n\n\treturn [sig * man, exp];\n}\n\nfunction getRangeIntervals(max, min=0) {\n\tlet upperBound = Math.ceil(max);\n\tlet lowerBound = Math.floor(min);\n\tlet range = upperBound - lowerBound;\n\n\tlet noOfParts = range;\n\tlet partSize = 1;\n\n\t// To avoid too many partitions\n\tif(range > 5) {\n\t\tif(range % 2 !== 0) {\n\t\t\tupperBound++;\n\t\t\t// Recalc range\n\t\t\trange = upperBound - lowerBound;\n\t\t}\n\t\tnoOfParts = range/2;\n\t\tpartSize = 2;\n\t}\n\n\t// Special case: 1 and 2\n\tif(range <= 2) {\n\t\tnoOfParts = 4;\n\t\tpartSize = range/noOfParts;\n\t}\n\n\t// Special case: 0\n\tif(range === 0) {\n\t\tnoOfParts = 5;\n\t\tpartSize = 1;\n\t}\n\n\tlet intervals = [];\n\tfor(var i = 0; i <= noOfParts; i++){\n\t\tintervals.push(lowerBound + partSize * i);\n\t}\n\treturn intervals;\n}\n\nfunction getIntervals(maxValue, minValue=0) {\n\tlet [normalMaxValue, exponent] = normalize(maxValue);\n\tlet normalMinValue = minValue ? minValue/Math.pow(10, exponent): 0;\n\n\t// Allow only 7 significant digits\n\tnormalMaxValue = normalMaxValue.toFixed(6);\n\n\tlet intervals = getRangeIntervals(normalMaxValue, normalMinValue);\n\tintervals = intervals.map(value => value * Math.pow(10, exponent));\n\treturn intervals;\n}\n\nexport function calcIntervals(values, withMinimum=false) {\n\t//*** Where the magic happens ***\n\n\t// Calculates best-fit y intervals from given values\n\t// and returns the interval array\n\n\tlet maxValue = Math.max(...values);\n\tlet minValue = Math.min(...values);\n\n\t// Exponent to be used for pretty print\n\tlet exponent = 0, intervals = []; // eslint-disable-line no-unused-vars\n\n\tfunction getPositiveFirstIntervals(maxValue, absMinValue) {\n\t\tlet intervals = getIntervals(maxValue);\n\n\t\tlet intervalSize = intervals[1] - intervals[0];\n\n\t\t// Then unshift the negative values\n\t\tlet value = 0;\n\t\tfor(var i = 1; value < absMinValue; i++) {\n\t\t\tvalue += intervalSize;\n\t\t\tintervals.unshift((-1) * value);\n\t\t}\n\t\treturn intervals;\n\t}\n\n\t// CASE I: Both non-negative\n\n\tif(maxValue >= 0 && minValue >= 0) {\n\t\texponent = normalize(maxValue)[1];\n\t\tif(!withMinimum) {\n\t\t\tintervals = getIntervals(maxValue);\n\t\t} else {\n\t\t\tintervals = getIntervals(maxValue, minValue);\n\t\t}\n\t}\n\n\t// CASE II: Only minValue negative\n\n\telse if(maxValue > 0 && minValue < 0) {\n\t\t// `withMinimum` irrelevant in this case,\n\t\t// We'll be handling both sides of zero separately\n\t\t// (both starting from zero)\n\t\t// Because ceil() and floor() behave differently\n\t\t// in those two regions\n\n\t\tlet absMinValue = Math.abs(minValue);\n\n\t\tif(maxValue >= absMinValue) {\n\t\t\texponent = normalize(maxValue)[1];\n\t\t\tintervals = getPositiveFirstIntervals(maxValue, absMinValue);\n\t\t} else {\n\t\t\t// Mirror: maxValue => absMinValue, then change sign\n\t\t\texponent = normalize(absMinValue)[1];\n\t\t\tlet posIntervals = getPositiveFirstIntervals(absMinValue, maxValue);\n\t\t\tintervals = posIntervals.map(d => d * (-1));\n\t\t}\n\n\t}\n\n\t// CASE III: Both non-positive\n\n\telse if(maxValue <= 0 && minValue <= 0) {\n\t\t// Mirrored Case I:\n\t\t// Work with positives, then reverse the sign and array\n\n\t\tlet pseudoMaxValue = Math.abs(minValue);\n\t\tlet pseudoMinValue = Math.abs(maxValue);\n\n\t\texponent = normalize(pseudoMaxValue)[1];\n\t\tif(!withMinimum) {\n\t\t\tintervals = getIntervals(pseudoMaxValue);\n\t\t} else {\n\t\t\tintervals = getIntervals(pseudoMaxValue, pseudoMinValue);\n\t\t}\n\n\t\tintervals = intervals.reverse().map(d => d * (-1));\n\t}\n\n\treturn intervals;\n}\n\nexport function calcDistribution(values, distributionSize) {\n\t// Assume non-negative values,\n\t// implying distribution minimum at zero\n\n\tlet dataMaxValue = Math.max(...values);\n\n\tlet distributionStep = 1 / (distributionSize - 1);\n\tlet distribution = [];\n\n\tfor(var i = 0; i < distributionSize; i++) {\n\t\tlet checkpoint = dataMaxValue * (distributionStep * i);\n\t\tdistribution.push(checkpoint);\n\t}\n\n\treturn distribution;\n}\n\nexport function getMaxCheckpoint(value, distribution) {\n\treturn distribution.filter(d => d < value).length;\n}\n","/**\n * Returns the value of a number upto 2 decimal places.\n * @param {Number} d Any number\n */\nexport function floatTwo(d) {\n\treturn parseFloat(d.toFixed(2));\n}\n\n/**\n * Returns whether or not two given arrays are equal.\n * @param {Array} arr1 First array\n * @param {Array} arr2 Second array\n */\nexport function arraysEqual(arr1, arr2) {\n\tif(arr1.length !== arr2.length) return false;\n\tlet areEqual = true;\n\tarr1.map((d, i) => {\n\t\tif(arr2[i] !== d) areEqual = false;\n\t});\n\treturn areEqual;\n}\n\n/**\n * Shuffles array in place. ES6 version\n * @param {Array} array An array containing the items.\n */\nexport function shuffle(array) {\n\t// Awesomeness: https://bost.ocks.org/mike/shuffle/\n\t// https://stackoverflow.com/a/2450976/6495043\n\t// https://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array?noredirect=1&lq=1\n\n\tfor (let i = array.length - 1; i > 0; i--) {\n\t\tlet j = Math.floor(Math.random() * (i + 1));\n\t\t[array[i], array[j]] = [array[j], array[i]];\n\t}\n\n\treturn array;\n}\n\n/**\n * Returns pixel width of string.\n * @param {String} string\n * @param {Number} charWidth Width of single char in pixels\n */\nexport function getStringWidth(string, charWidth) {\n\treturn (string+\"\").length * charWidth;\n}\n","import { $ } from '../utils/dom';\n\nexport default class SvgTip {\n\tconstructor({\n\t\tparent = null,\n\t\tcolors = []\n\t}) {\n\t\tthis.parent = parent;\n\t\tthis.colors = colors;\n\t\tthis.title_name = '';\n\t\tthis.title_value = '';\n\t\tthis.list_values = [];\n\t\tthis.title_value_first = 0;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\n\t\tthis.top = 0;\n\t\tthis.left = 0;\n\n\t\tthis.setup();\n\t}\n\n\tsetup() {\n\t\tthis.make_tooltip();\n\t}\n\n\trefresh() {\n\t\tthis.fill();\n\t\tthis.calc_position();\n\t\t// this.show_tip();\n\t}\n\n\tmake_tooltip() {\n\t\tthis.container = $.create('div', {\n\t\t\tinside: this.parent,\n\t\t\tclassName: 'graph-svg-tip comparison',\n\t\t\tinnerHTML: `<span class=\"title\"></span>\n\t\t\t\t<ul class=\"data-point-list\"></ul>\n\t\t\t\t<div class=\"svg-pointer\"></div>`\n\t\t});\n\t\tthis.hide_tip();\n\n\t\tthis.title = this.container.querySelector('.title');\n\t\tthis.data_point_list = this.container.querySelector('.data-point-list');\n\n\t\tthis.parent.addEventListener('mouseleave', () => {\n\t\t\tthis.hide_tip();\n\t\t});\n\t}\n\n\tfill() {\n\t\tlet title;\n\t\tif(this.title_value_first) {\n\t\t\ttitle = `<strong>${this.title_value}</strong>${this.title_name}`;\n\t\t} else {\n\t\t\ttitle = `${this.title_name}<strong>${this.title_value}</strong>`;\n\t\t}\n\t\tthis.title.innerHTML = title;\n\t\tthis.data_point_list.innerHTML = '';\n\n\t\tthis.list_values.map((set, i) => {\n\t\t\tconst color = this.colors[i] || 'black';\n\n\t\t\tlet li = $.create('li', {\n\t\t\t\tstyles: {\n\t\t\t\t\t'border-top': `3px solid ${color}`\n\t\t\t\t},\n\t\t\t\tinnerHTML: `<strong style=\"display: block;\">${ set.value === 0 || set.value ? set.value : '' }</strong>\n\t\t\t\t\t${set.title ? set.title : '' }`\n\t\t\t});\n\n\t\t\tthis.data_point_list.appendChild(li);\n\t\t});\n\t}\n\n\tcalc_position() {\n\t\tlet width = this.container.offsetWidth;\n\n\t\tthis.top = this.y - this.container.offsetHeight;\n\t\tthis.left = this.x - width/2;\n\t\tlet max_left = this.parent.offsetWidth - width;\n\n\t\tlet pointer = this.container.querySelector('.svg-pointer');\n\n\t\tif(this.left < 0) {\n\t\t\tpointer.style.left = `calc(50% - ${-1 * this.left}px)`;\n\t\t\tthis.left = 0;\n\t\t} else if(this.left > max_left) {\n\t\t\tlet delta = this.left - max_left;\n\t\t\tlet pointer_offset = `calc(50% + ${delta}px)`;\n\t\t\tpointer.style.left = pointer_offset;\n\n\t\t\tthis.left = max_left;\n\t\t} else {\n\t\t\tpointer.style.left = `50%`;\n\t\t}\n\t}\n\n\tset_values(x, y, title_name = '', title_value = '', list_values = [], title_value_first = 0) {\n\t\tthis.title_name = title_name;\n\t\tthis.title_value = title_value;\n\t\tthis.list_values = list_values;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.title_value_first = title_value_first;\n\t\tthis.refresh();\n\t}\n\n\thide_tip() {\n\t\tthis.container.style.top = '0px';\n\t\tthis.container.style.left = '0px';\n\t\tthis.container.style.opacity = '0';\n\t}\n\n\tshow_tip() {\n\t\tthis.container.style.top = this.top + 'px';\n\t\tthis.container.style.left = this.left + 'px';\n\t\tthis.container.style.opacity = '1';\n\t}\n}\n","const PRESET_COLOR_MAP = {\n\t'light-blue': '#7cd6fd',\n\t'blue': '#5e64ff',\n\t'violet': '#743ee2',\n\t'red': '#ff5858',\n\t'orange': '#ffa00a',\n\t'yellow': '#feef72',\n\t'green': '#28a745',\n\t'light-green': '#98d85b',\n\t'purple': '#b554ff',\n\t'magenta': '#ffa3ef',\n\t'black': '#36114C',\n\t'grey': '#bdd3e6',\n\t'light-grey': '#f0f4f7',\n\t'dark-grey': '#b8c2cc'\n};\n\nexport const DEFAULT_COLORS = ['light-blue', 'blue', 'violet', 'red', 'orange',\n\t'yellow', 'green', 'light-green', 'purple', 'magenta'];\n\nfunction limitColor(r){\n\tif (r > 255) return 255;\n\telse if (r < 0) return 0;\n\treturn r;\n}\n\nexport function lightenDarkenColor(color, amt) {\n\tlet col = getColor(color);\n\tlet usePound = false;\n\tif (col[0] == \"#\") {\n\t\tcol = col.slice(1);\n\t\tusePound = true;\n\t}\n\tlet num = parseInt(col,16);\n\tlet r = limitColor((num >> 16) + amt);\n\tlet b = limitColor(((num >> 8) & 0x00FF) + amt);\n\tlet g = limitColor((num & 0x0000FF) + amt);\n\treturn (usePound?\"#\":\"\") + (g | (b << 8) | (r << 16)).toString(16);\n}\n\nexport function isValidColor(string) {\n\t// https://stackoverflow.com/a/8027444/6495043\n\treturn /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(string);\n}\n\nexport const getColor = (color) => {\n\treturn PRESET_COLOR_MAP[color] || color;\n};\n","import SvgTip from '../objects/SvgTip';\nimport { $, isElementInViewport, getElementContentWidth } from '../utils/dom';\nimport { makeSVGContainer, makeSVGDefs, makeSVGGroup } from '../utils/draw';\nimport { getStringWidth } from '../utils/helpers';\nimport { getColor, DEFAULT_COLORS } from '../utils/colors';\nimport Chart from '../charts';\n\nconst ALL_CHART_TYPES = ['line', 'scatter', 'bar', 'percentage', 'heatmap', 'pie'];\n\nconst COMPATIBLE_CHARTS = {\n\tbar: ['line', 'scatter', 'percentage', 'pie'],\n\tline: ['scatter', 'bar', 'percentage', 'pie'],\n\tpie: ['line', 'scatter', 'percentage', 'bar'],\n\tscatter: ['line', 'bar', 'percentage', 'pie'],\n\tpercentage: ['bar', 'line', 'scatter', 'pie'],\n\theatmap: []\n};\n\n// TODO: Needs structure as per only labels/datasets\nconst COLOR_COMPATIBLE_CHARTS = {\n\tbar: ['line', 'scatter'],\n\tline: ['scatter', 'bar'],\n\tpie: ['percentage'],\n\tscatter: ['line', 'bar'],\n\tpercentage: ['pie'],\n\theatmap: []\n};\n\nexport default class BaseChart {\n\tconstructor({\n\t\theight = 240,\n\n\t\ttitle = '',\n\t\tsubtitle = '',\n\t\tcolors = [],\n\t\tsummary = [],\n\n\t\tis_navigable = 0,\n\t\thas_legend = 0,\n\n\t\ttype = '',\n\n\t\tparent,\n\t\tdata\n\t}) {\n    this.refresh = this.refresh.bind(this);\n\t\tthis.raw_chart_args = arguments[0];\n\n\t\tthis.parent = typeof parent === 'string' ? document.querySelector(parent) : parent;\n\t\tthis.title = title;\n\t\tthis.subtitle = subtitle;\n\n\t\tthis.data = data;\n\n\t\tthis.specific_values = data.specific_values || [];\n\t\tthis.summary = summary;\n\n\t\tthis.is_navigable = is_navigable;\n\t\tif(this.is_navigable) {\n\t\t\tthis.current_index = 0;\n\t\t}\n\t\tthis.has_legend = has_legend;\n\n\t\tthis.setColors(colors, type);\n\t\tthis.set_margins(height);\n\t}\n\n\tget_different_chart(type) {\n\t\tif(type === this.type) return;\n\n\t\tif(!ALL_CHART_TYPES.includes(type)) {\n\t\t\tconsole.error(`'${type}' is not a valid chart type.`);\n\t\t}\n\n\t\tif(!COMPATIBLE_CHARTS[this.type].includes(type)) {\n\t\t\tconsole.error(`'${this.type}' chart cannot be converted to a '${type}' chart.`);\n\t\t}\n\n\t\t// whether the new chart can use the existing colors\n\t\tconst use_color = COLOR_COMPATIBLE_CHARTS[this.type].includes(type);\n\n\t\t// Okay, this is anticlimactic\n\t\t// this function will need to actually be 'change_chart_type(type)'\n\t\t// that will update only the required elements, but for now ...\n\t\treturn new Chart({\n\t\t\tparent: this.raw_chart_args.parent,\n\t\t\ttitle: this.title,\n\t\t\tdata: this.raw_chart_args.data,\n\t\t\ttype: type,\n\t\t\theight: this.raw_chart_args.height,\n\t\t\tcolors: use_color ? this.colors : undefined\n\t\t});\n\t}\n\n\tsetColors(colors, type) {\n\t\tthis.colors = colors;\n\n\t\t// TODO: Needs structure as per only labels/datasets\n\t\tconst list = type === 'percentage' || type === 'pie'\n\t\t\t? this.data.labels\n\t\t\t: this.data.datasets;\n\n\t\tif(!this.colors || (list && this.colors.length < list.length)) {\n\t\t\tthis.colors = DEFAULT_COLORS;\n\t\t}\n\n\t\tthis.colors = this.colors.map(color => getColor(color));\n\t}\n\n\tset_margins(height) {\n\t\tthis.base_height = height;\n\t\tthis.height = height - 40;\n\t\tthis.translate_x = 60;\n\t\tthis.translate_y = 10;\n\t}\n\n\tsetup() {\n\t\tif(!this.parent) {\n\t\t\tconsole.error(\"No parent element to render on was provided.\");\n\t\t\treturn;\n\t\t}\n\t\tif(this.validate_and_prepare_data()) {\n\t\t\tthis.bind_window_events();\n\t\t\tthis.refresh(true);\n\t\t}\n\t}\n\n\tvalidate_and_prepare_data() {\n\t\treturn true;\n\t}\n\n\tbind_window_events() {\n\t\twindow.addEventListener('resize', this.refresh);\n\t\twindow.addEventListener('orientationchange', this.refresh);\n\t}\n\n  destroy() {\n    window.removeEventListener('resize', this.refresh);\n    window.removeEventListener('orientationchange', this.refresh);\n  }\n\n\trefresh(init=false) {\n\t\tthis.setup_base_values();\n\t\tthis.set_width();\n\n\t\tthis.setup_container();\n\t\tthis.setup_components();\n\n\t\tthis.setup_values();\n\t\tthis.setup_utils();\n\n\t\tthis.make_graph_components(init);\n\t\tthis.make_tooltip();\n\n\t\tif(this.summary.length > 0) {\n\t\t\tthis.show_custom_summary();\n\t\t} else {\n\t\t\tthis.show_summary();\n\t\t}\n\n\t\tif(this.is_navigable) {\n\t\t\tthis.setup_navigation(init);\n\t\t}\n\t}\n\n\tset_width() {\n\t\tlet special_values_width = 0;\n\t\tlet char_width = 8;\n\t\tthis.specific_values.map(val => {\n\t\t\tlet str_width = getStringWidth((val.title + \"\"), char_width);\n\t\t\tif(str_width > special_values_width) {\n\t\t\t\tspecial_values_width = str_width - 40;\n\t\t\t}\n\t\t});\n\t\tthis.base_width = getElementContentWidth(this.parent) - special_values_width;\n\t\tthis.width = this.base_width - this.translate_x * 2;\n\t}\n\n\tsetup_base_values() {}\n\n\tsetup_container() {\n\t\tthis.container = $.create('div', {\n\t\t\tclassName: 'chart-container',\n\t\t\tinnerHTML: `<h6 class=\"title\">${this.title}</h6>\n\t\t\t\t<h6 class=\"sub-title uppercase\">${this.subtitle}</h6>\n\t\t\t\t<div class=\"frappe-chart graphics\"></div>\n\t\t\t\t<div class=\"graph-stats-container\"></div>`\n\t\t});\n\n\t\t// Chart needs a dedicated parent element\n\t\tthis.parent.innerHTML = '';\n\t\tthis.parent.appendChild(this.container);\n\n\t\tthis.chart_wrapper = this.container.querySelector('.frappe-chart');\n\t\tthis.stats_wrapper = this.container.querySelector('.graph-stats-container');\n\n\t\tthis.make_chart_area();\n\t\tthis.make_draw_area();\n\t}\n\n\tmake_chart_area() {\n\t\tthis.svg = makeSVGContainer(\n\t\t\tthis.chart_wrapper,\n\t\t\t'chart',\n\t\t\tthis.base_width,\n\t\t\tthis.base_height\n\t\t);\n\t\tthis.svg_defs = makeSVGDefs(this.svg);\n\t\treturn this.svg;\n\t}\n\n\tmake_draw_area() {\n\t\tthis.draw_area = makeSVGGroup(\n\t\t\tthis.svg,\n\t\t\tthis.type + '-chart',\n\t\t\t`translate(${this.translate_x}, ${this.translate_y})`\n\t\t);\n\t}\n\n\tsetup_components() { }\n\n\tmake_tooltip() {\n\t\tthis.tip = new SvgTip({\n\t\t\tparent: this.chart_wrapper,\n\t\t\tcolors: this.colors\n\t\t});\n\t\tthis.bind_tooltip();\n\t}\n\n\n\tshow_summary() {}\n\tshow_custom_summary() {\n\t\tthis.summary.map(d => {\n\t\t\tlet stats = $.create('div', {\n\t\t\t\tclassName: 'stats',\n\t\t\t\tinnerHTML: `<span class=\"indicator\">\n\t\t\t\t\t<i style=\"background:${d.color}\"></i>\n\t\t\t\t\t${d.title}: ${d.value}\n\t\t\t\t</span>`\n\t\t\t});\n\t\t\tthis.stats_wrapper.appendChild(stats);\n\t\t});\n\t}\n\n\tsetup_navigation(init=false) {\n\t\tthis.make_overlay();\n\n\t\tif(init) {\n\t\t\tthis.bind_overlay();\n\n\t\t\tdocument.addEventListener('keydown', (e) => {\n\t\t\t\tif(isElementInViewport(this.chart_wrapper)) {\n\t\t\t\t\te = e || window.event;\n\n\t\t\t\t\tif (e.keyCode == '37') {\n\t\t\t\t\t\tthis.on_left_arrow();\n\t\t\t\t\t} else if (e.keyCode == '39') {\n\t\t\t\t\t\tthis.on_right_arrow();\n\t\t\t\t\t} else if (e.keyCode == '38') {\n\t\t\t\t\t\tthis.on_up_arrow();\n\t\t\t\t\t} else if (e.keyCode == '40') {\n\t\t\t\t\t\tthis.on_down_arrow();\n\t\t\t\t\t} else if (e.keyCode == '13') {\n\t\t\t\t\t\tthis.on_enter_key();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tmake_overlay() {}\n\tbind_overlay() {}\n\tbind_units() {}\n\n\ton_left_arrow() {}\n\ton_right_arrow() {}\n\ton_up_arrow() {}\n\ton_down_arrow() {}\n\ton_enter_key() {}\n\n\tget_data_point(index=this.current_index) {\n\t\t// check for length\n\t\tlet data_point = {\n\t\t\tindex: index\n\t\t};\n\t\tlet y = this.y[0];\n\t\t['svg_units', 'y_tops', 'values'].map(key => {\n\t\t\tlet data_key = key.slice(0, key.length-1);\n\t\t\tdata_point[data_key] = y[key][index];\n\t\t});\n\t\tdata_point.label = this.x[index];\n\t\treturn data_point;\n\t}\n\n\tupdate_current_data_point(index) {\n\t\tindex = parseInt(index);\n\t\tif(index < 0) index = 0;\n\t\tif(index >= this.x.length) index = this.x.length - 1;\n\t\tif(index === this.current_index) return;\n\t\tthis.current_index = index;\n\t\t$.fire(this.parent, \"data-select\", this.get_data_point());\n\t}\n\n\t// Objects\n\tsetup_utils() { }\n\n\tmakeDrawAreaComponent(className, transform='') {\n\t\treturn makeSVGGroup(this.draw_area, className, transform);\n\t}\n}\n","import { offset } from '../utils/dom';\nimport { UnitRenderer, makeXLine, makeYLine } from '../utils/draw';\nimport { Animator } from '../utils/animate';\nimport { runSVGAnimation } from '../utils/animation';\nimport { calcIntervals } from '../utils/intervals';\nimport { floatTwo, arraysEqual, getStringWidth } from '../utils/helpers';\nimport BaseChart from './BaseChart';\n\nexport default class AxisChart extends BaseChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\n\t\tthis.x = this.data.labels || [];\n\t\tthis.y = this.data.datasets || [];\n\n\t\tthis.is_series = args.is_series;\n\n\t\tthis.format_tooltip_y = args.format_tooltip_y;\n\t\tthis.format_tooltip_x = args.format_tooltip_x;\n\n\t\tthis.zero_line = this.height;\n\n\t\t// this.old_values = {};\n\t}\n\n\tvalidate_and_prepare_data() {\n\t\treturn true;\n\t}\n\n\tsetup_values() {\n\t\tthis.data.datasets.map(d => {\n\t\t\td.values = d.values.map(val => (!isNaN(val) ? val : 0));\n\t\t});\n\t\tthis.setup_x();\n\t\tthis.setup_y();\n\t}\n\n\tsetup_x() {\n\t\tthis.set_avg_unit_width_and_x_offset();\n\n\t\tif(this.x_axis_positions) {\n\t\t\tthis.x_old_axis_positions =  this.x_axis_positions.slice();\n\t\t}\n\t\tthis.x_axis_positions = this.x.map((d, i) =>\n\t\t\tfloatTwo(this.x_offset + i * this.avg_unit_width));\n\n\t\tif(!this.x_old_axis_positions) {\n\t\t\tthis.x_old_axis_positions = this.x_axis_positions.slice();\n\t\t}\n\t}\n\n\tsetup_y() {\n\t\tif(this.y_axis_values) {\n\t\t\tthis.y_old_axis_values =  this.y_axis_values.slice();\n\t\t}\n\n\t\tlet values = this.get_all_y_values();\n\n\t\tif(this.y_sums && this.y_sums.length > 0) {\n\t\t\tvalues = values.concat(this.y_sums);\n\t\t}\n\n\t\tthis.y_axis_values = calcIntervals(values, this.type === 'line');\n\n\t\tif(!this.y_old_axis_values) {\n\t\t\tthis.y_old_axis_values = this.y_axis_values.slice();\n\t\t}\n\n\t\tconst y_pts = this.y_axis_values;\n\t\tconst value_range = y_pts[y_pts.length-1] - y_pts[0];\n\n\t\tif(this.multiplier) this.old_multiplier = this.multiplier;\n\t\tthis.multiplier = this.height / value_range;\n\t\tif(!this.old_multiplier) this.old_multiplier = this.multiplier;\n\n\t\tconst interval = y_pts[1] - y_pts[0];\n\t\tconst interval_height = interval * this.multiplier;\n\n\t\tlet zero_index;\n\n\t\tif(y_pts.indexOf(0) >= 0) {\n\t\t\t// the range has a given zero\n\t\t\t// zero-line on the chart\n\t\t\tzero_index = y_pts.indexOf(0);\n\t\t} else if(y_pts[0] > 0) {\n\t\t\t// Minimum value is positive\n\t\t\t// zero-line is off the chart: below\n\t\t\tlet min = y_pts[0];\n\t\t\tzero_index = (-1) * min / interval;\n\t\t} else {\n\t\t\t// Maximum value is negative\n\t\t\t// zero-line is off the chart: above\n\t\t\tlet max = y_pts[y_pts.length - 1];\n\t\t\tzero_index = (-1) * max / interval + (y_pts.length - 1);\n\t\t}\n\n\t\tif(this.zero_line) this.old_zero_line = this.zero_line;\n\t\tthis.zero_line = this.height - (zero_index * interval_height);\n\t\tif(!this.old_zero_line) this.old_zero_line = this.zero_line;\n\t}\n\n\tsetup_components() {\n\t\tsuper.setup_components();\n\t\tthis.setup_marker_components();\n\t\tthis.setup_aggregation_components();\n\t\tthis.setup_graph_components();\n\t}\n\n\tsetup_marker_components() {\n\t\tthis.y_axis_group = this.makeDrawAreaComponent('y axis');\n\t\tthis.x_axis_group = this.makeDrawAreaComponent('x axis');\n\t\tthis.specific_y_group = this.makeDrawAreaComponent('specific axis');\n\t}\n\n\tsetup_aggregation_components() {\n\t\tthis.sum_group = this.makeDrawAreaComponent('data-points');\n\t\tthis.average_group = this.makeDrawAreaComponent('chart-area');\n\t}\n\n\tsetup_graph_components() {\n\t\tthis.svg_units_groups = [];\n\t\tthis.y.map((d, i) => {\n\t\t\tthis.svg_units_groups[i] = this.makeDrawAreaComponent(\n\t\t\t\t'data-points data-points-' + i);\n\t\t});\n\t}\n\n\tmake_graph_components(init=false) {\n\t\tthis.make_y_axis();\n\t\tthis.make_x_axis();\n\t\tthis.draw_graph(init);\n\t\tthis.make_y_specifics();\n\t}\n\n\t// make VERTICAL lines for x values\n\tmake_x_axis(animate=false) {\n\t\tlet char_width = 8;\n\t\tlet start_at, height, text_start_at, axis_line_class = '';\n\t\tif(this.x_axis_mode === 'span') {\t\t// long spanning lines\n\t\t\tstart_at = -7;\n\t\t\theight = this.height + 15;\n\t\t\ttext_start_at = this.height + 25;\n\t\t} else if(this.x_axis_mode === 'tick'){\t// short label lines\n\t\t\tstart_at = this.height;\n\t\t\theight = 6;\n\t\t\ttext_start_at = 9;\n\t\t\taxis_line_class = 'x-axis-label';\n\t\t}\n\n\t\tthis.x_axis_group.setAttribute('transform', `translate(0,${start_at})`);\n\n\t\tif(animate) {\n\t\t\tthis.make_anim_x_axis(height, text_start_at, axis_line_class);\n\t\t\treturn;\n\t\t}\n\n\t\tlet allowed_space = this.avg_unit_width * 1.5;\n\t\tlet allowed_letters = allowed_space / 8;\n\n\t\tthis.x_axis_group.textContent = '';\n\t\tthis.x.map((point, i) => {\n\t\t\tlet space_taken = getStringWidth(point, char_width) + 2;\n\t\t\tif(space_taken > allowed_space) {\n\t\t\t\tif(this.is_series) {\n\t\t\t\t\t// Skip some axis lines if X axis is a series\n\t\t\t\t\tlet skips = 1;\n\t\t\t\t\twhile((space_taken/skips)*2 > allowed_space) {\n\t\t\t\t\t\tskips++;\n\t\t\t\t\t}\n\t\t\t\t\tif(i % skips !== 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpoint = point.slice(0, allowed_letters-3) + \" ...\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.x_axis_group.appendChild(\n\t\t\t\tmakeXLine(\n\t\t\t\t\theight,\n\t\t\t\t\ttext_start_at,\n\t\t\t\t\tpoint,\n\t\t\t\t\t'x-value-text',\n\t\t\t\t\taxis_line_class,\n\t\t\t\t\tthis.x_axis_positions[i]\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\n\t// make HORIZONTAL lines for y values\n\tmake_y_axis(animate=false) {\n\t\tif(animate) {\n\t\t\tthis.make_anim_y_axis();\n\t\t\tthis.make_anim_y_specifics();\n\t\t\treturn;\n\t\t}\n\n\t\tlet [width, text_end_at, axis_line_class, start_at] = this.get_y_axis_line_props();\n\n\t\tthis.y_axis_group.textContent = '';\n\t\tthis.y_axis_values.map((value, i) => {\n\t\t\tthis.y_axis_group.appendChild(\n\t\t\t\tmakeYLine(\n\t\t\t\t\tstart_at,\n\t\t\t\t\twidth,\n\t\t\t\t\ttext_end_at,\n\t\t\t\t\tvalue,\n\t\t\t\t\t'y-value-text',\n\t\t\t\t\taxis_line_class,\n\t\t\t\t\tthis.zero_line - value * this.multiplier,\n\t\t\t\t\t(value === 0 && i !== 0) // Non-first Zero line\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\n\tget_y_axis_line_props(specific=false) {\n\t\tif(specific) {\n\t\t\treturn[this.width, this.width + 5, 'specific-value', 0];\n\t\t}\n\t\tlet width, text_end_at = -9, axis_line_class = '', start_at = 0;\n\t\tif(this.y_axis_mode === 'span') {\t\t// long spanning lines\n\t\t\twidth = this.width + 6;\n\t\t\tstart_at = -6;\n\t\t} else if(this.y_axis_mode === 'tick'){\t// short label lines\n\t\t\twidth = -6;\n\t\t\taxis_line_class = 'y-axis-label';\n\t\t}\n\n\t\treturn [width, text_end_at, axis_line_class, start_at];\n\t}\n\n\tdraw_graph(init=false) {\n\t\tif(this.raw_chart_args.hasOwnProperty(\"init\") && !this.raw_chart_args.init) {\n\t\t\tthis.y.map((d, i) => {\n\t\t\t\td.svg_units = [];\n\t\t\t\tthis.make_path && this.make_path(d, i, this.x_axis_positions, d.y_tops, this.colors[i]);\n\t\t\t\tthis.make_new_units(d, i);\n\t\t\t\tthis.calc_y_dependencies();\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif(init) {\n\t\t\tthis.draw_new_graph_and_animate();\n\t\t\treturn;\n\t\t}\n\t\tthis.y.map((d, i) => {\n\t\t\td.svg_units = [];\n\t\t\tthis.make_path && this.make_path(d, i, this.x_axis_positions, d.y_tops, this.colors[i]);\n\t\t\tthis.make_new_units(d, i);\n\t\t});\n\t}\n\n\tdraw_new_graph_and_animate() {\n\t\tlet data = [];\n\t\tthis.y.map((d, i) => {\n\t\t\t// Anim: Don't draw initial values, store them and update later\n\t\t\td.y_tops = new Array(d.values.length).fill(this.zero_line); // no value\n\t\t\tdata.push({values: d.values});\n\t\t\td.svg_units = [];\n\n\t\t\tthis.make_path && this.make_path(d, i, this.x_axis_positions, d.y_tops, this.colors[i]);\n\t\t\tthis.make_new_units(d, i);\n\t\t});\n\n\t\tsetTimeout(() => {\n\t\t\tthis.update_values(data);\n\t\t}, 350);\n\t}\n\n\tsetup_navigation(init) {\n\t\tif(init) {\n\t\t\t// Hack: defer nav till initial update_values\n\t\t\tsetTimeout(() => {\n\t\t\t\tsuper.setup_navigation(init);\n\t\t\t}, 500);\n\t\t} else {\n\t\t\tsuper.setup_navigation(init);\n\t\t}\n\t}\n\n\tmake_new_units(d, i) {\n\t\tthis.make_new_units_for_dataset(\n\t\t\tthis.x_axis_positions,\n\t\t\td.y_tops,\n\t\t\tthis.colors[i],\n\t\t\ti,\n\t\t\tthis.y.length\n\t\t);\n\t}\n\n\tmake_new_units_for_dataset(x_values, y_values, color, dataset_index,\n\t\tno_of_datasets, units_group, units_array, unit) {\n\n\t\tif(!units_group) units_group = this.svg_units_groups[dataset_index];\n\t\tif(!units_array) units_array = this.y[dataset_index].svg_units;\n\t\tif(!unit) unit = this.unit_args;\n\n\t\tunits_group.textContent = '';\n\t\tunits_array.length = 0;\n\n\t\tlet unit_renderer = new UnitRenderer(this.height, this.zero_line, this.avg_unit_width);\n\n\t\ty_values.map((y, i) => {\n\t\t\tlet data_unit = unit_renderer[unit.type](\n\t\t\t\tx_values[i],\n\t\t\t\ty,\n\t\t\t\tunit.args,\n\t\t\t\tcolor,\n\t\t\t\ti,\n\t\t\t\tdataset_index,\n\t\t\t\tno_of_datasets\n\t\t\t);\n\t\t\tunits_group.appendChild(data_unit);\n\t\t\tunits_array.push(data_unit);\n\t\t});\n\n\t\tif(this.is_navigable) {\n\t\t\tthis.bind_units(units_array);\n\t\t}\n\t}\n\n\tmake_y_specifics() {\n\t\tthis.specific_y_group.textContent = '';\n\t\tthis.specific_values.map(d => {\n\t\t\tthis.specific_y_group.appendChild(\n\t\t\t\tmakeYLine(\n\t\t\t\t\t0,\n\t\t\t\t\tthis.width,\n\t\t\t\t\tthis.width + 5,\n\t\t\t\t\td.title.toUpperCase(),\n\t\t\t\t\t'specific-value',\n\t\t\t\t\t'specific-value',\n\t\t\t\t\tthis.zero_line - d.value * this.multiplier,\n\t\t\t\t\tfalse,\n\t\t\t\t\td.line_type\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\t}\n\n\tbind_tooltip() {\n\t\t// TODO: could be in tooltip itself, as it is a given functionality for its parent\n\t\tthis.chart_wrapper.addEventListener('mousemove', (e) => {\n\t\t\tlet o = offset(this.chart_wrapper);\n\t\t\tlet relX = e.pageX - o.left - this.translate_x;\n\t\t\tlet relY = e.pageY - o.top - this.translate_y;\n\n\t\t\tif(relY < this.height + this.translate_y * 2) {\n\t\t\t\tthis.map_tooltip_x_position_and_show(relX);\n\t\t\t} else {\n\t\t\t\tthis.tip.hide_tip();\n\t\t\t}\n\t\t});\n\t}\n\n\tmap_tooltip_x_position_and_show(relX) {\n\t\tif(!this.y_min_tops) return;\n\n\t\tlet titles = this.x;\n\t\tif(this.format_tooltip_x && this.format_tooltip_x(this.x[0])) {\n\t\t\ttitles = this.x.map(d=>this.format_tooltip_x(d));\n\t\t}\n\n\t\tlet y_format = this.format_tooltip_y && this.format_tooltip_y(this.y[0].values[0]);\n\n\t\tfor(var i=this.x_axis_positions.length - 1; i >= 0 ; i--) {\n\t\t\tlet x_val = this.x_axis_positions[i];\n\t\t\t// let delta = i === 0 ? this.avg_unit_width : x_val - this.x_axis_positions[i-1];\n\t\t\tif(relX > x_val - this.avg_unit_width/2) {\n\t\t\t\tlet x = x_val + this.translate_x;\n\t\t\t\tlet y = this.y_min_tops[i] + this.translate_y;\n\n\t\t\t\tlet title = titles[i];\n\t\t\t\tlet values = this.y.map((set, j) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttitle: set.title,\n\t\t\t\t\t\tvalue: y_format ? this.format_tooltip_y(set.values[i]) : set.values[i],\n\t\t\t\t\t\tcolor: this.colors[j],\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\tthis.tip.set_values(x, y, title, '', values);\n\t\t\t\tthis.tip.show_tip();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// API\n\tshow_sums() {\n\t\tthis.updating = true;\n\n\t\tthis.y_sums = new Array(this.x_axis_positions.length).fill(0);\n\t\tthis.y.map(d => {\n\t\t\td.values.map( (value, i) => {\n\t\t\t\tthis.y_sums[i] += value;\n\t\t\t});\n\t\t});\n\n\t\t// Remake y axis, animate\n\t\tthis.update_values();\n\n\t\t// Then make sum units, don't animate\n\t\tthis.sum_units = [];\n\n\t\tthis.make_new_units_for_dataset(\n\t\t\tthis.x_axis_positions,\n\t\t\tthis.y_sums.map( val => floatTwo(this.zero_line - val * this.multiplier)),\n\t\t\t'#f0f4f7',\n\t\t\t0,\n\t\t\t1,\n\t\t\tthis.sum_group,\n\t\t\tthis.sum_units\n\t\t);\n\n\t\t// this.make_path && this.make_path(d, i, old_x, old_y, this.colors[i]);\n\n\t\tthis.updating = false;\n\t}\n\n\thide_sums() {\n\t\tif(this.updating) return;\n\t\tthis.y_sums = [];\n\t\tthis.sum_group.textContent = '';\n\t\tthis.sum_units = [];\n\t\tthis.update_values();\n\t}\n\n\tshow_averages() {\n\t\tthis.old_specific_values = this.specific_values.slice();\n\t\tthis.y.map((d, i) => {\n\t\t\tlet sum = 0;\n\t\t\td.values.map(e => {sum+=e;});\n\t\t\tlet average = sum/d.values.length;\n\n\t\t\tthis.specific_values.push({\n\t\t\t\ttitle: \"AVG\" + \" \" + (i+1),\n\t\t\t\tline_type: \"dashed\",\n\t\t\t\tvalue: average,\n\t\t\t\tauto: 1\n\t\t\t});\n\t\t});\n\n\t\tthis.update_values();\n\t}\n\n\thide_averages() {\n\t\tthis.old_specific_values = this.specific_values.slice();\n\n\t\tlet indices_to_remove = [];\n\t\tthis.specific_values.map((d, i) => {\n\t\t\tif(d.auto) indices_to_remove.unshift(i);\n\t\t});\n\n\t\tindices_to_remove.map(index => {\n\t\t\tthis.specific_values.splice(index, 1);\n\t\t});\n\n\t\tthis.update_values();\n\t}\n\n\tupdate_values(new_y, new_x) {\n\t\tif(!new_x) {\n\t\t\tnew_x = this.x;\n\t\t}\n\t\tthis.elements_to_animate = [];\n\t\tthis.updating = true;\n\n\t\tthis.old_x_values = this.x.slice();\n\t\tthis.old_y_axis_tops = this.y.map(d => d.y_tops.slice());\n\n\t\tthis.old_y_values = this.y.map(d => d.values);\n\n\t\tthis.no_of_extra_pts = new_x.length - this.x.length;\n\n\t\t// Just update values prop, setup_x/y() will do the rest\n\t\tif(new_y) this.y.map((d, i) => {d.values = new_y[i].values;});\n\t\tif(new_x) this.x = new_x;\n\n\t\tthis.setup_x();\n\t\tthis.setup_y();\n\n\t\t// Change in data, so calculate dependencies\n\t\tthis.calc_y_dependencies();\n\n\t\t// Got the values? Now begin drawing\n\t\tthis.animator = new Animator(this.height, this.width, this.zero_line, this.avg_unit_width);\n\n\t\t// Animate only if positions have changed\n\t\tif(!arraysEqual(this.x_old_axis_positions, this.x_axis_positions)) {\n\t\t\tthis.make_x_axis(true);\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(!this.updating) this.make_x_axis();\n\t\t\t}, 350);\n\t\t}\n\n\t\tif(!arraysEqual(this.y_old_axis_values, this.y_axis_values) ||\n\t\t\t(this.old_specific_values &&\n\t\t\t!arraysEqual(this.old_specific_values, this.specific_values))) {\n\n\t\t\tthis.make_y_axis(true);\n\t\t\tsetTimeout(() => {\n\t\t\t\tif(!this.updating) {\n\t\t\t\t\tthis.make_y_axis();\n\t\t\t\t\tthis.make_y_specifics();\n\t\t\t\t}\n\t\t\t}, 350);\n\t\t}\n\n\t\tthis.animate_graphs();\n\n\t\t// Trigger animation with the animatable elements in this.elements_to_animate\n\t\tthis.run_animation();\n\n\t\tthis.updating = false;\n\t}\n\n\tadd_data_point(y_point, x_point, index=this.x.length) {\n\t\tlet new_y = this.y.map(data_set => { return {values:data_set.values}; });\n\t\tnew_y.map((d, i) => { d.values.splice(index, 0, y_point[i]); });\n\t\tlet new_x = this.x.slice();\n\t\tnew_x.splice(index, 0, x_point);\n\n\t\tthis.update_values(new_y, new_x);\n\t}\n\n\tremove_data_point(index = this.x.length-1) {\n\t\tif(this.x.length < 3) return;\n\n\t\tlet new_y = this.y.map(data_set => { return {values:data_set.values}; });\n\t\tnew_y.map((d) => { d.values.splice(index, 1); });\n\t\tlet new_x = this.x.slice();\n\t\tnew_x.splice(index, 1);\n\n\t\tthis.update_values(new_y, new_x);\n\t}\n\n\trun_animation() {\n\t\tlet anim_svg = runSVGAnimation(this.svg, this.elements_to_animate);\n\n\t\tif(this.svg.parentNode == this.chart_wrapper) {\n\t\t\tthis.chart_wrapper.removeChild(this.svg);\n\t\t\tthis.chart_wrapper.appendChild(anim_svg);\n\n\t\t}\n\n\t\t// Replace the new svg (data has long been replaced)\n\t\tsetTimeout(() => {\n\t\t\tif(anim_svg.parentNode == this.chart_wrapper) {\n\t\t\t\tthis.chart_wrapper.removeChild(anim_svg);\n\t\t\t\tthis.chart_wrapper.appendChild(this.svg);\n\t\t\t}\n\t\t}, 250);\n\t}\n\n\tanimate_graphs() {\n\t\tthis.y.map((d, i) => {\n\t\t\t// Pre-prep, equilize no of positions between old and new\n\t\t\tlet [old_x, old_y, new_x, new_y] = this.calc_old_and_new_postions(d, i);\n\t\t\tif(this.no_of_extra_pts >= 0) {\n\t\t\t\tthis.make_path && this.make_path(d, i, old_x, old_y, this.colors[i]);\n\t\t\t\tthis.make_new_units_for_dataset(old_x, old_y, this.colors[i], i, this.y.length);\n\t\t\t}\n\t\t\td.path && this.animate_path(d, i, old_x, old_y, new_x, new_y);\n\t\t\tthis.animate_units(d, i, old_x, old_y, new_x, new_y);\n\t\t});\n\n\t\t// TODO: replace with real units\n\t\tsetTimeout(() => {\n\t\t\tthis.y.map((d, i) => {\n\t\t\t\tthis.make_path && this.make_path(d, i, this.x_axis_positions, d.y_tops, this.colors[i]);\n\t\t\t\tthis.make_new_units(d, i);\n\t\t\t});\n\t\t}, 400);\n\t}\n\n\tanimate_path(d, i, old_x, old_y, new_x, new_y) {\n\t\tconst newPointsList = new_y.map((y, i) => (new_x[i] + ',' + y));\n\t\tconst newPathStr = newPointsList.join(\"L\");\n\t\tthis.elements_to_animate = this.elements_to_animate\n\t\t\t.concat(this.animator['path'](d, newPathStr));\n\t}\n\n\tanimate_units(d, index, old_x, old_y, new_x, new_y) {\n\t\tlet type = this.unit_args.type;\n\n\t\td.svg_units.map((unit, i) => {\n\t\t\tif(new_x[i] === undefined || new_y[i] === undefined) return;\n\t\t\tthis.elements_to_animate.push(this.animator[type](\n\t\t\t\t{unit:unit, array:d.svg_units, index: i}, // unit, with info to replace where it came from in the data\n\t\t\t\tnew_x[i],\n\t\t\t\tnew_y[i],\n\t\t\t\tindex,\n\t\t\t\tthis.y.length\n\t\t\t));\n\t\t});\n\t}\n\n\tcalc_old_and_new_postions(d, i) {\n\t\tlet old_x = this.x_old_axis_positions.slice();\n\t\tlet new_x = this.x_axis_positions.slice();\n\n\t\tlet old_y = this.old_y_axis_tops[i].slice();\n\t\tlet new_y = d.y_tops.slice();\n\n\t\tconst last_old_x_pos = old_x[old_x.length - 1];\n\t\tconst last_old_y_pos = old_y[old_y.length - 1];\n\n\t\tconst last_new_x_pos = new_x[new_x.length - 1];\n\t\tconst last_new_y_pos = new_y[new_y.length - 1];\n\n\t\tif(this.no_of_extra_pts >= 0) {\n\t\t\t// First substitute current path with a squiggled one\n\t\t\t// (that looks the same but has more points at end),\n\t\t\t// then animate to stretch it later to new points\n\t\t\t// (new points already have more points)\n\n\t\t\t// Hence, the extra end points will correspond to current(old) positions\n\t\t\tlet filler_x = new Array(Math.abs(this.no_of_extra_pts)).fill(last_old_x_pos);\n\t\t\tlet filler_y = new Array(Math.abs(this.no_of_extra_pts)).fill(last_old_y_pos);\n\n\t\t\told_x = old_x.concat(filler_x);\n\t\t\told_y = old_y.concat(filler_y);\n\n\t\t} else {\n\t\t\t// Just modify the new points to have extra points\n\t\t\t// with the same position at end\n\t\t\tlet filler_x = new Array(Math.abs(this.no_of_extra_pts)).fill(last_new_x_pos);\n\t\t\tlet filler_y = new Array(Math.abs(this.no_of_extra_pts)).fill(last_new_y_pos);\n\n\t\t\tnew_x = new_x.concat(filler_x);\n\t\t\tnew_y = new_y.concat(filler_y);\n\t\t}\n\n\t\treturn [old_x, old_y, new_x, new_y];\n\t}\n\n\tmake_anim_x_axis(height, text_start_at, axis_line_class) {\n\t\t// Animate X AXIS to account for more or less axis lines\n\n\t\tconst old_pos = this.x_old_axis_positions;\n\t\tconst new_pos = this.x_axis_positions;\n\n\t\tconst old_vals = this.old_x_values;\n\t\tconst new_vals = this.x;\n\n\t\tconst last_line_pos = old_pos[old_pos.length - 1];\n\n\t\tlet add_and_animate_line = (value, old_pos, new_pos) => {\n\t\t\tif(typeof new_pos === 'string') {\n\t\t\t\tnew_pos = parseInt(new_pos.substring(0, new_pos.length-1));\n\t\t\t}\n\t\t\tconst x_line = makeXLine(\n\t\t\t\theight,\n\t\t\t\ttext_start_at,\n\t\t\t\tvalue, // new value\n\t\t\t\t'x-value-text',\n\t\t\t\taxis_line_class,\n\t\t\t\told_pos // old position\n\t\t\t);\n\t\t\tthis.x_axis_group.appendChild(x_line);\n\n\t\t\tthis.elements_to_animate && this.elements_to_animate.push([\n\t\t\t\t{unit: x_line, array: [0], index: 0},\n\t\t\t\t{transform: `${ new_pos }, 0`},\n\t\t\t\t350,\n\t\t\t\t\"easein\",\n\t\t\t\t\"translate\",\n\t\t\t\t{transform: `${ old_pos }, 0`}\n\t\t\t]);\n\t\t};\n\n\t\tthis.x_axis_group.textContent = '';\n\n\t\tthis.make_new_axis_anim_lines(\n\t\t\told_pos,\n\t\t\tnew_pos,\n\t\t\told_vals,\n\t\t\tnew_vals,\n\t\t\tlast_line_pos,\n\t\t\tadd_and_animate_line\n\t\t);\n\t}\n\n\tmake_anim_y_axis() {\n\t\t// Animate Y AXIS to account for more or less axis lines\n\n\t\tconst old_pos = this.y_old_axis_values.map(value =>\n\t\t\tthis.zero_line - value * this.multiplier);\n\t\tconst new_pos = this.y_axis_values.map(value =>\n\t\t\tthis.zero_line - value * this.multiplier);\n\n\t\tconst old_vals = this.y_old_axis_values;\n\t\tconst new_vals = this.y_axis_values;\n\n\t\tconst last_line_pos = old_pos[old_pos.length - 1];\n\n\t\tthis.y_axis_group.textContent = '';\n\n\t\tthis.make_new_axis_anim_lines(\n\t\t\told_pos,\n\t\t\tnew_pos,\n\t\t\told_vals,\n\t\t\tnew_vals,\n\t\t\tlast_line_pos,\n\t\t\tthis.add_and_animate_y_line.bind(this),\n\t\t\tthis.y_axis_group\n\t\t);\n\t}\n\n\tmake_anim_y_specifics() {\n\t\tthis.specific_y_group.textContent = '';\n\t\tthis.specific_values.map((d) => {\n\t\t\tthis.add_and_animate_y_line(\n\t\t\t\td.title,\n\t\t\t\tthis.old_zero_line - d.value * this.old_multiplier,\n\t\t\t\tthis.zero_line - d.value * this.multiplier,\n\t\t\t\t0,\n\t\t\t\tthis.specific_y_group,\n\t\t\t\td.line_type,\n\t\t\t\ttrue\n\t\t\t);\n\t\t});\n\t}\n\n\tmake_new_axis_anim_lines(old_pos, new_pos, old_vals, new_vals, last_line_pos, add_and_animate_line, group) {\n\t\tlet superimposed_positions, superimposed_values;\n\t\tlet no_of_extras = new_vals.length - old_vals.length;\n\t\tif(no_of_extras > 0) {\n\t\t\t// More axis are needed\n\t\t\t// First make only the superimposed (same position) ones\n\t\t\t// Add in the extras at the end later\n\t\t\tsuperimposed_positions = new_pos.slice(0, old_pos.length);\n\t\t\tsuperimposed_values = new_vals.slice(0, old_vals.length);\n\t\t} else {\n\t\t\t// Axis have to be reduced\n\t\t\t// Fake it by moving all current extra axis to the last position\n\t\t\t// You'll need filler positions and values in the new arrays\n\t\t\tconst filler_vals = new Array(Math.abs(no_of_extras)).fill(\"\");\n\t\t\tsuperimposed_values = new_vals.concat(filler_vals);\n\n\t\t\tconst filler_pos = new Array(Math.abs(no_of_extras)).fill(last_line_pos + \"F\");\n\t\t\tsuperimposed_positions = new_pos.concat(filler_pos);\n\t\t}\n\n\t\tsuperimposed_values.map((value, i) => {\n\t\t\tadd_and_animate_line(value, old_pos[i], superimposed_positions[i], i, group);\n\t\t});\n\n\t\tif(no_of_extras > 0) {\n\t\t\t// Add in extra axis in the end\n\t\t\t// and then animate to new positions\n\t\t\tconst extra_values = new_vals.slice(old_vals.length);\n\t\t\tconst extra_positions = new_pos.slice(old_pos.length);\n\n\t\t\textra_values.map((value, i) => {\n\t\t\t\tadd_and_animate_line(value, last_line_pos, extra_positions[i], i, group);\n\t\t\t});\n\t\t}\n\t}\n\n\tadd_and_animate_y_line(value, old_pos, new_pos, i, group, type, specific=false) {\n\t\tlet filler = false;\n\t\tif(typeof new_pos === 'string') {\n\t\t\tnew_pos = parseInt(new_pos.substring(0, new_pos.length-1));\n\t\t\tfiller = true;\n\t\t}\n\t\tlet new_props = {transform: `0, ${ new_pos }`};\n\t\tlet old_props = {transform: `0, ${ old_pos }`};\n\n\t\tif(filler) {\n\t\t\tnew_props['stroke-opacity'] = 0;\n\t\t\t// old_props['stroke-opacity'] = 1;\n\t\t}\n\n\t\tlet [width, text_end_at, axis_line_class, start_at] = this.get_y_axis_line_props(specific);\n\t\tlet axis_label_class = !specific ? 'y-value-text' : 'specific-value';\n\t\tvalue = !specific ? value : (value+\"\").toUpperCase();\n\t\tconst y_line = makeYLine(\n\t\t\tstart_at,\n\t\t\twidth,\n\t\t\ttext_end_at,\n\t\t\tvalue,\n\t\t\taxis_label_class,\n\t\t\taxis_line_class,\n\t\t\told_pos,  // old position\n\t\t\t(value === 0 && i !== 0), // Non-first Zero line\n\t\t\ttype\n\t\t);\n\n\t\tgroup.appendChild(y_line);\n\n\t\tthis.elements_to_animate && this.elements_to_animate.push([\n\t\t\t{unit: y_line, array: [0], index: 0},\n\t\t\tnew_props,\n\t\t\t350,\n\t\t\t\"easein\",\n\t\t\t\"translate\",\n\t\t\told_props\n\t\t]);\n\t}\n\n\tset_avg_unit_width_and_x_offset() {\n\t\t// Set the ... you get it\n\t\tthis.avg_unit_width = this.width/(this.x.length - 1);\n\t\tthis.x_offset = 0;\n\t}\n\n\tget_all_y_values() {\n\t\tlet all_values = [];\n\n\t\t// Add in all the y values in the datasets\n\t\tthis.y.map(d => {\n\t\t\tall_values = all_values.concat(d.values);\n\t\t});\n\n\t\t// Add in all the specific values\n\t\treturn all_values.concat(this.specific_values.map(d => d.value));\n\t}\n\n\tcalc_y_dependencies() {\n\t\tthis.y_min_tops = new Array(this.x_axis_positions.length).fill(9999);\n\t\tthis.y.map(d => {\n\t\t\td.y_tops = d.values.map( val => floatTwo(this.zero_line - val * this.multiplier));\n\t\t\td.y_tops.map( (y_top, i) => {\n\t\t\t\tif(y_top < this.y_min_tops[i]) {\n\t\t\t\t\tthis.y_min_tops[i] = y_top;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t// this.chart_wrapper.removeChild(this.tip.container);\n\t\t// this.make_tooltip();\n\t}\n}\n","import AxisChart from './AxisChart';\nimport { makeSVGGroup, makePath, makeGradient } from '../utils/draw';\n\nexport default class LineChart extends AxisChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\n\t\tthis.x_axis_mode = args.x_axis_mode || 'span';\n\t\tthis.y_axis_mode = args.y_axis_mode || 'span';\n\n\t\tif(args.hasOwnProperty('show_dots')) {\n\t\t\tthis.show_dots = args.show_dots;\n\t\t} else {\n\t\t\tthis.show_dots = 1;\n\t\t}\n\t\tthis.region_fill = args.region_fill;\n\n\t\tif(Object.getPrototypeOf(this) !== LineChart.prototype) {\n\t\t\treturn;\n\t\t}\n\t\tthis.dot_radius = args.dot_radius || 4;\n\t\tthis.heatline = args.heatline;\n\t\tthis.type = 'line';\n\n\t\tthis.setup();\n\t}\n\n\tsetup_graph_components() {\n\t\tthis.setup_path_groups();\n\t\tsuper.setup_graph_components();\n\t}\n\n\tsetup_path_groups() {\n\t\tthis.paths_groups = [];\n\t\tthis.y.map((d, i) => {\n\t\t\tthis.paths_groups[i] = makeSVGGroup(\n\t\t\t\tthis.draw_area,\n\t\t\t\t'path-group path-group-' + i\n\t\t\t);\n\t\t});\n\t}\n\n\tsetup_values() {\n\t\tsuper.setup_values();\n\t\tthis.unit_args = {\n\t\t\ttype: 'dot',\n\t\t\targs: { radius: this.dot_radius }\n\t\t};\n\t}\n\n\tmake_new_units_for_dataset(x_values, y_values, color, dataset_index,\n\t\tno_of_datasets, units_group, units_array, unit) {\n\t\tif(this.show_dots) {\n\t\t\tsuper.make_new_units_for_dataset(x_values, y_values, color, dataset_index,\n\t\t\t\tno_of_datasets, units_group, units_array, unit);\n\t\t}\n\t}\n\n\tmake_paths() {\n\t\tthis.y.map((d, i) => {\n\t\t\tthis.make_path(d, i, this.x_axis_positions, d.y_tops, d.color || this.colors[i]);\n\t\t});\n\t}\n\n\tmake_path(d, i, x_positions, y_positions, color) {\n\t\tlet points_list = y_positions.map((y, i) => (x_positions[i] + ',' + y));\n\t\tlet points_str = points_list.join(\"L\");\n\n\t\tthis.paths_groups[i].textContent = '';\n\n\t\td.path = makePath(\"M\"+points_str, 'line-graph-path', color);\n\t\tthis.paths_groups[i].appendChild(d.path);\n\n\t\tif(this.heatline) {\n\t\t\tlet gradient_id = makeGradient(this.svg_defs, color);\n\t\t\td.path.style.stroke = `url(#${gradient_id})`;\n\t\t}\n\n\t\tif(this.region_fill) {\n\t\t\tthis.fill_region_for_dataset(d, i, color, points_str);\n\t\t}\n\t}\n\n\tfill_region_for_dataset(d, i, color, points_str) {\n\t\tlet gradient_id = makeGradient(this.svg_defs, color, true);\n\t\tlet pathStr = \"M\" + `0,${this.zero_line}L` + points_str + `L${this.width},${this.zero_line}`;\n\n\t\td.regionPath = makePath(pathStr, `region-fill`, 'none', `url(#${gradient_id})`);\n\t\tthis.paths_groups[i].appendChild(d.regionPath);\n\t}\n}\n","import BaseChart from './BaseChart';\nimport { $, offset } from '../utils/dom';\nimport { makePath } from '../utils/draw';\nimport { lightenDarkenColor } from '../utils/colors';\nimport { runSVGAnimation, transform } from '../utils/animation';\nconst ANGLE_RATIO = Math.PI / 180;\nconst FULL_ANGLE = 360;\n\nexport default class PieChart extends BaseChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\t\tthis.type = 'pie';\n\t\tthis.elements_to_animate = null;\n\t\tthis.hoverRadio = args.hoverRadio || 0.1;\n\t\tthis.max_slices = 10;\n\t\tthis.max_legend_points = 6;\n\t\tthis.isAnimate = false;\n\t\tthis.startAngle = args.startAngle || 0;\n\t\tthis.clockWise = args.clockWise || false;\n\t\tthis.mouseMove = this.mouseMove.bind(this);\n\t\tthis.mouseLeave = this.mouseLeave.bind(this);\n\t\tthis.setup();\n\t}\n\tsetup_values() {\n\t\tthis.centerX = this.width / 2;\n\t\tthis.centerY = this.height / 2;\n\t\tthis.radius = (this.height > this.width ? this.centerX : this.centerY);\n\t\tthis.slice_totals = [];\n\t\tlet all_totals = this.data.labels.map((d, i) => {\n\t\t\tlet total = 0;\n\t\t\tthis.data.datasets.map(e => {\n\t\t\t\ttotal += e.values[i];\n\t\t\t});\n\t\t\treturn [total, d];\n\t\t}).filter(d => { return d[0] > 0; }); // keep only positive results\n\n\t\tlet totals = all_totals;\n\n\t\tif(all_totals.length > this.max_slices) {\n\t\t\tall_totals.sort((a, b) => { return b[0] - a[0]; });\n\n\t\t\ttotals = all_totals.slice(0, this.max_slices-1);\n\t\t\tlet others = all_totals.slice(this.max_slices-1);\n\n\t\t\tlet sum_of_others = 0;\n\t\t\tothers.map(d => {sum_of_others += d[0];});\n\n\t\t\ttotals.push([sum_of_others, 'Rest']);\n\n\t\t\tthis.colors[this.max_slices-1] = 'grey';\n\t\t}\n\n\t\tthis.labels = [];\n\t\ttotals.map(d => {\n\t\t\tthis.slice_totals.push(d[0]);\n\t\t\tthis.labels.push(d[1]);\n\t\t});\n\n\t\tthis.legend_totals = this.slice_totals.slice(0, this.max_legend_points);\n\t}\n\n\tstatic getPositionByAngle(angle,radius){\n\t\treturn {\n\t\t\tx:Math.sin(angle * ANGLE_RATIO) * radius,\n\t\t\ty:Math.cos(angle * ANGLE_RATIO) * radius,\n\t\t};\n\t}\n\tmakeArcPath(startPosition,endPosition){\n\t\tconst{centerX,centerY,radius,clockWise} = this;\n\t\treturn `M${centerX} ${centerY} L${centerX+startPosition.x} ${centerY+startPosition.y} A ${radius} ${radius} 0 0 ${clockWise ? 1 : 0} ${centerX+endPosition.x} ${centerY+endPosition.y} z`;\n\t}\n\tmake_graph_components(init){\n\t\tconst{radius,clockWise} = this;\n\t\tthis.grand_total = this.slice_totals.reduce((a, b) => a + b, 0);\n\t\tconst prevSlicesProperties = this.slicesProperties || [];\n\t\tthis.slices = [];\n\t\tthis.elements_to_animate = [];\n\t\tthis.slicesProperties = [];\n\t\tlet curAngle = 180 - this.startAngle;\n\t\tthis.slice_totals.map((total, i) => {\n\t\t\tconst startAngle = curAngle;\n\t\t\tconst originDiffAngle = (total / this.grand_total) * FULL_ANGLE;\n\t\t\tconst diffAngle = clockWise ? -originDiffAngle : originDiffAngle;\n\t\t\tconst endAngle = curAngle = curAngle + diffAngle;\n\t\t\tconst startPosition = PieChart.getPositionByAngle(startAngle,radius);\n\t\t\tconst endPosition = PieChart.getPositionByAngle(endAngle,radius);\n\t\t\tconst prevProperty = init && prevSlicesProperties[i];\n\t\t\tlet curStart,curEnd;\n\t\t\tif(init){\n\t\t\t\tcurStart = prevProperty?prevProperty.startPosition : startPosition;\n\t\t\t\tcurEnd = prevProperty? prevProperty.endPosition : startPosition;\n\t\t\t}else{\n\t\t\t\tcurStart = startPosition;\n\t\t\t\tcurEnd = endPosition;\n\t\t\t}\n\t\t\tconst curPath = this.makeArcPath(curStart,curEnd);\n\t\t\tlet slice = makePath(curPath, 'pie-path', 'none', this.colors[i]);\n\t\t\tslice.style.transition = 'transform .3s;';\n\t\t\tthis.draw_area.appendChild(slice);\n\n\t\t\tthis.slices.push(slice);\n\t\t\tthis.slicesProperties.push({\n\t\t\t\tstartPosition,\n\t\t\t\tendPosition,\n\t\t\t\tvalue: total,\n\t\t\t\ttotal: this.grand_total,\n\t\t\t\tstartAngle,\n\t\t\t\tendAngle,\n\t\t\t\tangle:diffAngle\n\t\t\t});\n\t\t\tif(init){\n\t\t\t\tthis.elements_to_animate.push([{unit: slice, array: this.slices, index: this.slices.length - 1},\n\t\t\t\t\t{d:this.makeArcPath(startPosition,endPosition)},\n\t\t\t\t\t650, \"easein\",null,{\n\t\t\t\t\t\td:curPath\n\t\t\t\t\t}]);\n\t\t\t}\n\n\t\t});\n\t\tif(init){\n\t\t\tthis.run_animation();\n\t\t}\n\t}\n\trun_animation() {\n\t\t// if(this.isAnimate) return ;\n\t\t// this.isAnimate = true;\n\t\tif(!this.elements_to_animate || this.elements_to_animate.length === 0) return;\n\t\tlet anim_svg = runSVGAnimation(this.svg, this.elements_to_animate);\n\n\t\tif(this.svg.parentNode == this.chart_wrapper) {\n\t\t\tthis.chart_wrapper.removeChild(this.svg);\n\t\t\tthis.chart_wrapper.appendChild(anim_svg);\n\n\t\t}\n\n\t\t// Replace the new svg (data has long been replaced)\n\t\tsetTimeout(() => {\n\t\t\t// this.isAnimate = false;\n\t\t\tif(anim_svg.parentNode == this.chart_wrapper) {\n\t\t\t\tthis.chart_wrapper.removeChild(anim_svg);\n\t\t\t\tthis.chart_wrapper.appendChild(this.svg);\n\t\t\t}\n\t\t}, 650);\n\t}\n\n\tcalTranslateByAngle(property){\n\t\tconst{radius,hoverRadio} = this;\n\t\tconst position = PieChart.getPositionByAngle(property.startAngle+(property.angle / 2),radius);\n\t\treturn `translate3d(${(position.x) * hoverRadio}px,${(position.y) * hoverRadio}px,0)`;\n\t}\n\thoverSlice(path,i,flag,e){\n\t\tif(!path) return;\n\t\tconst color = this.colors[i];\n\t\tif(flag){\n\t\t\ttransform(path,this.calTranslateByAngle(this.slicesProperties[i]));\n\t\t\tpath.style.fill = lightenDarkenColor(color,50);\n\t\t\tlet g_off = offset(this.svg);\n\t\t\tlet x = e.pageX - g_off.left + 10;\n\t\t\tlet y = e.pageY - g_off.top - 10;\n\t\t\tlet title = (this.formatted_labels && this.formatted_labels.length>0\n\t\t\t\t? this.formatted_labels[i] : this.labels[i]) + ': ';\n\t\t\tlet percent = (this.slice_totals[i]*100/this.grand_total).toFixed(1);\n\t\t\tthis.tip.set_values(x, y, title, percent + \"%\");\n\t\t\tthis.tip.show_tip();\n\t\t}else{\n\t\t\ttransform(path,'translate3d(0,0,0)');\n\t\t\tthis.tip.hide_tip();\n\t\t\tpath.style.fill = color;\n\t\t}\n\t}\n\n\tmouseMove(e){\n\t\tconst target = e.target;\n\t\tlet prevIndex = this.curActiveSliceIndex;\n\t\tlet prevAcitve = this.curActiveSlice;\n\t\tfor(let i = 0; i < this.slices.length; i++){\n\t\t\tif(target === this.slices[i]){\n\t\t\t\tthis.hoverSlice(prevAcitve,prevIndex,false);\n\t\t\t\tthis.curActiveSlice = target;\n\t\t\t\tthis.curActiveSliceIndex = i;\n\t\t\t\tthis.hoverSlice(target,i,true,e);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tmouseLeave(){\n\t\tthis.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,false);\n\t}\n\tbind_tooltip() {\n\t\tthis.draw_area.addEventListener('mousemove',this.mouseMove);\n\t\tthis.draw_area.addEventListener('mouseleave',this.mouseLeave);\n\t}\n\n\tshow_summary() {\n\t\tlet x_values = this.formatted_labels && this.formatted_labels.length > 0\n\t\t\t? this.formatted_labels : this.labels;\n\t\tthis.legend_totals.map((d, i) => {\n\t\t\tconst color = this.colors[i];\n\n\t\t\tif(d) {\n\t\t\t\tlet stats = $.create('div', {\n\t\t\t\t\tclassName: 'stats',\n\t\t\t\t\tinside: this.stats_wrapper\n\t\t\t\t});\n\t\t\t\tstats.innerHTML = `<span class=\"indicator\">\n\t\t\t\t\t<i style=\"background-color:${color};\"></i>\n\t\t\t\t\t<span class=\"text-muted\">${x_values[i]}:</span>\n\t\t\t\t\t${d}\n\t\t\t\t</span>`;\n\t\t\t}\n\t\t});\n\t}\n}\n","// Playing around with dates\n\n// https://stackoverflow.com/a/11252167/6495043\nfunction treatAsUtc(dateStr) {\n\tlet result = new Date(dateStr);\n\tresult.setMinutes(result.getMinutes() - result.getTimezoneOffset());\n\treturn result;\n}\n\nexport function getDdMmYyyy(date) {\n\tlet dd = date.getDate();\n\tlet mm = date.getMonth() + 1; // getMonth() is zero-based\n\treturn [\n\t\t(dd>9 ? '' : '0') + dd,\n\t\t(mm>9 ? '' : '0') + mm,\n\t\tdate.getFullYear()\n\t].join('-');\n}\n\nexport function getWeeksBetween(startDateStr, endDateStr) {\n\treturn Math.ceil(getDaysBetween(startDateStr, endDateStr) / 7);\n}\n\nexport function getDaysBetween(startDateStr, endDateStr) {\n\tlet millisecondsPerDay = 24 * 60 * 60 * 1000;\n\treturn (treatAsUtc(endDateStr) - treatAsUtc(startDateStr)) / millisecondsPerDay;\n}\n\n// mutates\nexport function addDays(date, numberOfDays) {\n\tdate.setDate(date.getDate() + numberOfDays);\n}\n\n// export function getMonthName() {}\n","import '../scss/charts.scss';\n\nimport BarChart from './charts/BarChart';\nimport LineChart from './charts/LineChart';\nimport ScatterChart from './charts/ScatterChart';\nimport PercentageChart from './charts/PercentageChart';\nimport PieChart from './charts/PieChart';\nimport Heatmap from './charts/Heatmap';\n\n// if (ENV !== 'production') {\n// \t// Enable LiveReload\n// \tdocument.write(\n// \t\t'<script src=\"http://' + (location.host || 'localhost').split(':')[0] +\n// \t\t':35729/livereload.js?snipver=1\"></' + 'script>'\n// \t);\n// }\n\nconst chartTypes = {\n\tline: LineChart,\n\tbar: BarChart,\n\tscatter: ScatterChart,\n\tpercentage: PercentageChart,\n\theatmap: Heatmap,\n\tpie: PieChart\n};\n\nfunction getChartByType(chartType = 'line', options) {\n\tif (!chartTypes[chartType]) {\n\t\treturn new LineChart(options);\n\t}\n\n\treturn new chartTypes[chartType](options);\n}\n\nexport default class Chart {\n\tconstructor(args) {\n\t\treturn getChartByType(args.type, arguments[0]);\n\t}\n}\n","import AxisChart from './AxisChart';\n\nexport default class BarChart extends AxisChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\n\t\tthis.type = 'bar';\n\t\tthis.x_axis_mode = args.x_axis_mode || 'tick';\n\t\tthis.y_axis_mode = args.y_axis_mode || 'span';\n\t\tthis.setup();\n\t}\n\n\tsetup_values() {\n\t\tsuper.setup_values();\n\t\tthis.x_offset = this.avg_unit_width;\n\t\tthis.unit_args = {\n\t\t\ttype: 'bar',\n\t\t\targs: {\n\t\t\t\tspaceWidth: this.avg_unit_width/2,\n\t\t\t}\n\t\t};\n\t}\n\n\tmake_overlay() {\n\t\t// Just make one out of the first element\n\t\tlet index = this.x.length - 1;\n\t\tlet unit = this.y[0].svg_units[index];\n\t\tthis.update_current_data_point(index);\n\n\t\tif(this.overlay) {\n\t\t\tthis.overlay.parentNode.removeChild(this.overlay);\n\t\t}\n\t\tthis.overlay = unit.cloneNode();\n\t\tthis.overlay.style.fill = '#000000';\n\t\tthis.overlay.style.opacity = '0.4';\n\t\tthis.draw_area.appendChild(this.overlay);\n\t}\n\n\tbind_overlay() {\n\t\t// on event, update overlay\n\t\tthis.parent.addEventListener('data-select', (e) => {\n\t\t\tthis.update_overlay(e.svg_unit);\n\t\t});\n\t}\n\n\tbind_units(units_array) {\n\t\tunits_array.map(unit => {\n\t\t\tunit.addEventListener('click', () => {\n\t\t\t\tlet index = unit.getAttribute('data-point-index');\n\t\t\t\tthis.update_current_data_point(index);\n\t\t\t});\n\t\t});\n\t}\n\n\tupdate_overlay(unit) {\n\t\tlet attributes = [];\n\t\tObject.keys(unit.attributes).map(index => {\n\t\t\tattributes.push(unit.attributes[index]);\n\t\t});\n\n\t\tattributes.filter(attr => attr.specified).map(attr => {\n\t\t\tthis.overlay.setAttribute(attr.name, attr.nodeValue);\n\t\t});\n\n\t\tthis.overlay.style.fill = '#000000';\n\t\tthis.overlay.style.opacity = '0.4';\n\t}\n\n\ton_left_arrow() {\n\t\tthis.update_current_data_point(this.current_index - 1);\n\t}\n\n\ton_right_arrow() {\n\t\tthis.update_current_data_point(this.current_index + 1);\n\t}\n\n\tset_avg_unit_width_and_x_offset() {\n\t\tthis.avg_unit_width = this.width/(this.x.length + 1);\n\t\tthis.x_offset = this.avg_unit_width;\n\t}\n}\n","import LineChart from './LineChart';\n\nexport default class ScatterChart extends LineChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\n\t\tthis.type = 'scatter';\n\n\t\tif(!args.dot_radius) {\n\t\t\tthis.dot_radius = 8;\n\t\t} else {\n\t\t\tthis.dot_radius = args.dot_radius;\n\t\t}\n\n\t\tthis.setup();\n\t}\n\n\tsetup_graph_components() {\n\t\tthis.setup_path_groups();\n\t\tsuper.setup_graph_components();\n\t}\n\n\tsetup_path_groups() {}\n\n\tsetup_values() {\n\t\tsuper.setup_values();\n\t\tthis.unit_args = {\n\t\t\ttype: 'dot',\n\t\t\targs: { radius: this.dot_radius }\n\t\t};\n\t}\n\n\tmake_paths() {}\n\tmake_path() {}\n}\n","import BaseChart from './BaseChart';\nimport { $, offset } from '../utils/dom';\n\nexport default class PercentageChart extends BaseChart {\n\tconstructor(args) {\n\t\tsuper(args);\n\t\tthis.type = 'percentage';\n\n\t\tthis.max_slices = 10;\n\t\tthis.max_legend_points = 6;\n\n\t\tthis.setup();\n\t}\n\n\tmake_chart_area() {\n\t\tthis.chart_wrapper.className += ' ' + 'graph-focus-margin';\n\t\tthis.chart_wrapper.style.marginTop = '45px';\n\n\t\tthis.stats_wrapper.className += ' ' + 'graph-focus-margin';\n\t\tthis.stats_wrapper.style.marginBottom = '30px';\n\t\tthis.stats_wrapper.style.paddingTop = '0px';\n\t}\n\n\tmake_draw_area() {\n\t\tthis.chart_div = $.create('div', {\n\t\t\tclassName: 'div',\n\t\t\tinside: this.chart_wrapper\n\t\t});\n\n\t\tthis.chart = $.create('div', {\n\t\t\tclassName: 'progress-chart',\n\t\t\tinside: this.chart_div\n\t\t});\n\t}\n\n\tsetup_components() {\n\t\tthis.percentage_bar = $.create('div', {\n\t\t\tclassName: 'progress',\n\t\t\tinside: this.chart\n\t\t});\n\t}\n\n\tsetup_values() {\n\t\tthis.slice_totals = [];\n\t\tlet all_totals = this.data.labels.map((d, i) => {\n\t\t\tlet total = 0;\n\t\t\tthis.data.datasets.map(e => {\n\t\t\t\ttotal += e.values[i];\n\t\t\t});\n\t\t\treturn [total, d];\n\t\t}).filter(d => { return d[0] > 0; }); // keep only positive results\n\n\t\tlet totals = all_totals;\n\n\t\tif(all_totals.length > this.max_slices) {\n\t\t\tall_totals.sort((a, b) => { return b[0] - a[0]; });\n\n\t\t\ttotals = all_totals.slice(0, this.max_slices-1);\n\t\t\tlet others = all_totals.slice(this.max_slices-1);\n\n\t\t\tlet sum_of_others = 0;\n\t\t\tothers.map(d => {sum_of_others += d[0];});\n\n\t\t\ttotals.push([sum_of_others, 'Rest']);\n\n\t\t\tthis.colors[this.max_slices-1] = 'grey';\n\t\t}\n\n\t\tthis.labels = [];\n\t\ttotals.map(d => {\n\t\t\tthis.slice_totals.push(d[0]);\n\t\t\tthis.labels.push(d[1]);\n\t\t});\n\n\t\tthis.legend_totals = this.slice_totals.slice(0, this.max_legend_points);\n\t}\n\n\tmake_graph_components() {\n\t\tthis.grand_total = this.slice_totals.reduce((a, b) => a + b, 0);\n\t\tthis.slices = [];\n\t\tthis.slice_totals.map((total, i) => {\n\t\t\tlet slice = $.create('div', {\n\t\t\t\tclassName: `progress-bar`,\n\t\t\t\tinside: this.percentage_bar,\n\t\t\t\tstyles: {\n\t\t\t\t\tbackground: this.colors[i],\n\t\t\t\t\twidth: total*100/this.grand_total + \"%\"\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.slices.push(slice);\n\t\t});\n\t}\n\n\tbind_tooltip() {\n\t\tthis.slices.map((slice, i) => {\n\t\t\tslice.addEventListener('mouseenter', () => {\n\t\t\t\tlet g_off = offset(this.chart_wrapper), p_off = offset(slice);\n\n\t\t\t\tlet x = p_off.left - g_off.left + slice.offsetWidth/2;\n\t\t\t\tlet y = p_off.top - g_off.top - 6;\n\t\t\t\tlet title = (this.formatted_labels && this.formatted_labels.length>0\n\t\t\t\t\t? this.formatted_labels[i] : this.labels[i]) + ': ';\n\t\t\t\tlet percent = (this.slice_totals[i]*100/this.grand_total).toFixed(1);\n\n\t\t\t\tthis.tip.set_values(x, y, title, percent + \"%\");\n\t\t\t\tthis.tip.show_tip();\n\t\t\t});\n\t\t});\n\t}\n\n\tshow_summary() {\n\t\tlet x_values = this.formatted_labels && this.formatted_labels.length > 0\n\t\t\t? this.formatted_labels : this.labels;\n\t\tthis.legend_totals.map((d, i) => {\n\t\t\tif(d) {\n\t\t\t\tlet stats = $.create('div', {\n\t\t\t\t\tclassName: 'stats',\n\t\t\t\t\tinside: this.stats_wrapper\n\t\t\t\t});\n\t\t\t\tstats.innerHTML = `<span class=\"indicator\">\n\t\t\t\t\t<i style=\"background: ${this.colors[i]}\"></i>\n\t\t\t\t\t<span class=\"text-muted\">${x_values[i]}:</span>\n\t\t\t\t\t${d}\n\t\t\t\t</span>`;\n\t\t\t}\n\t\t});\n\t}\n}\n","import BaseChart from './BaseChart';\nimport { makeSVGGroup, makeHeatSquare, makeText } from '../utils/draw';\nimport { addDays, getDdMmYyyy, getWeeksBetween } from '../utils/date-utils';\nimport { calcDistribution, getMaxCheckpoint } from '../utils/intervals';\nimport { isValidColor } from '../utils/colors';\n\nexport default class Heatmap extends BaseChart {\n\tconstructor({\n\t\tstart = '',\n\t\tdomain = '',\n\t\tsubdomain = '',\n\t\tdata = {},\n\t\tdiscrete_domains = 0,\n\t\tcount_label = '',\n\t\tlegend_colors = []\n\t}) {\n\t\tsuper(arguments[0]);\n\n\t\tthis.type = 'heatmap';\n\n\t\tthis.domain = domain;\n\t\tthis.subdomain = subdomain;\n\t\tthis.data = data;\n\t\tthis.discrete_domains = discrete_domains;\n\t\tthis.count_label = count_label;\n\n\t\tlet today = new Date();\n\t\tthis.start = start || addDays(today, 365);\n\n\t\tlegend_colors = legend_colors.slice(0, 5);\n\t\tthis.legend_colors = this.validate_colors(legend_colors)\n\t\t\t? legend_colors\n\t\t\t: ['#ebedf0', '#c6e48b', '#7bc96f', '#239a3b', '#196127'];\n\n\t\t// Fixed 5-color theme,\n\t\t// More colors are difficult to parse visually\n\t\tthis.distribution_size = 5;\n\n\t\tthis.translate_x = 0;\n\t\tthis.setup();\n\t}\n\n\tvalidate_colors(colors) {\n\t\tif(colors.length < 5) return 0;\n\n\t\tlet valid = 1;\n\t\tcolors.forEach(function(string) {\n\t\t\tif(!isValidColor(string)) {\n\t\t\t\tvalid = 0;\n\t\t\t\tconsole.warn('\"' + string + '\" is not a valid color.');\n\t\t\t}\n\t\t}, this);\n\n\t\treturn valid;\n\t}\n\n\tsetup_base_values() {\n\t\tthis.today = new Date();\n\n\t\tif(!this.start) {\n\t\t\tthis.start = new Date();\n\t\t\tthis.start.setFullYear( this.start.getFullYear() - 1 );\n\t\t}\n\t\tthis.first_week_start = new Date(this.start.toDateString());\n\t\tthis.last_week_start = new Date(this.today.toDateString());\n\t\tif(this.first_week_start.getDay() !== 7) {\n\t\t\taddDays(this.first_week_start, (-1) * this.first_week_start.getDay());\n\t\t}\n\t\tif(this.last_week_start.getDay() !== 7) {\n\t\t\taddDays(this.last_week_start, (-1) * this.last_week_start.getDay());\n\t\t}\n\t\tthis.no_of_cols = getWeeksBetween(this.first_week_start + '', this.last_week_start + '') + 1;\n\t}\n\n\tset_width() {\n\t\tthis.base_width = (this.no_of_cols + 3) * 12 ;\n\n\t\tif(this.discrete_domains) {\n\t\t\tthis.base_width += (12 * 12);\n\t\t}\n\t}\n\n\tsetup_components() {\n\t\tthis.domain_label_group = this.makeDrawAreaComponent(\n\t\t\t'domain-label-group chart-label');\n\n\t\tthis.data_groups = this.makeDrawAreaComponent(\n\t\t\t'data-groups',\n\t\t\t`translate(0, 20)`\n\t\t);\n\t}\n\n\tsetup_values() {\n\t\tthis.domain_label_group.textContent = '';\n\t\tthis.data_groups.textContent = '';\n\n\t\tlet data_values = Object.keys(this.data).map(key => this.data[key]);\n\t\tthis.distribution = calcDistribution(data_values, this.distribution_size);\n\n\t\tthis.month_names = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n\t\t\t\"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\n\t\t];\n\n\t\tthis.render_all_weeks_and_store_x_values(this.no_of_cols);\n\t}\n\n\trender_all_weeks_and_store_x_values(no_of_weeks) {\n\t\tlet current_week_sunday = new Date(this.first_week_start);\n\t\tthis.week_col = 0;\n\t\tthis.current_month = current_week_sunday.getMonth();\n\n\t\tthis.months = [this.current_month + ''];\n\t\tthis.month_weeks = {}, this.month_start_points = [];\n\t\tthis.month_weeks[this.current_month] = 0;\n\t\tthis.month_start_points.push(13);\n\n\t\tfor(var i = 0; i < no_of_weeks; i++) {\n\t\t\tlet data_group, month_change = 0;\n\t\t\tlet day = new Date(current_week_sunday);\n\n\t\t\t[data_group, month_change] = this.get_week_squares_group(day, this.week_col);\n\t\t\tthis.data_groups.appendChild(data_group);\n\t\t\tthis.week_col += 1 + parseInt(this.discrete_domains && month_change);\n\t\t\tthis.month_weeks[this.current_month]++;\n\t\t\tif(month_change) {\n\t\t\t\tthis.current_month = (this.current_month + 1) % 12;\n\t\t\t\tthis.months.push(this.current_month + '');\n\t\t\t\tthis.month_weeks[this.current_month] = 1;\n\t\t\t}\n\t\t\taddDays(current_week_sunday, 7);\n\t\t}\n\t\tthis.render_month_labels();\n\t}\n\n\tget_week_squares_group(current_date, index) {\n\t\tconst no_of_weekdays = 7;\n\t\tconst square_side = 10;\n\t\tconst cell_padding = 2;\n\t\tconst step = 1;\n\t\tconst today_time = this.today.getTime();\n\n\t\tlet month_change = 0;\n\t\tlet week_col_change = 0;\n\n\t\tlet data_group = makeSVGGroup(this.data_groups, 'data-group');\n\n\t\tfor(var y = 0, i = 0; i < no_of_weekdays; i += step, y += (square_side + cell_padding)) {\n\t\t\tlet data_value = 0;\n\t\t\tlet color_index = 0;\n\n\t\t\tlet current_timestamp = current_date.getTime()/1000;\n\t\t\tlet timestamp = Math.floor(current_timestamp - (current_timestamp % 86400)).toFixed(1);\n\n\t\t\tif(this.data[timestamp]) {\n\t\t\t\tdata_value = this.data[timestamp];\n\t\t\t}\n\n\t\t\tif(this.data[Math.round(timestamp)]) {\n\t\t\t\tdata_value = this.data[Math.round(timestamp)];\n\t\t\t}\n\n\t\t\tif(data_value) {\n\t\t\t\tcolor_index = getMaxCheckpoint(data_value, this.distribution);\n\t\t\t}\n\n\t\t\tlet x = 13 + (index + week_col_change) * 12;\n\n\t\t\tlet dataAttr = {\n\t\t\t\t'data-date': getDdMmYyyy(current_date),\n\t\t\t\t'data-value': data_value,\n\t\t\t\t'data-day': current_date.getDay()\n\t\t\t};\n\t\t\tlet heatSquare = makeHeatSquare('day', x, y, square_side,\n\t\t\t\tthis.legend_colors[color_index], dataAttr);\n\n\t\t\tdata_group.appendChild(heatSquare);\n\n\t\t\tlet next_date = new Date(current_date);\n\t\t\taddDays(next_date, 1);\n\t\t\tif(next_date.getTime() > today_time) break;\n\n\n\t\t\tif(next_date.getMonth() - current_date.getMonth()) {\n\t\t\t\tmonth_change = 1;\n\t\t\t\tif(this.discrete_domains) {\n\t\t\t\t\tweek_col_change = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.month_start_points.push(13 + (index + week_col_change) * 12);\n\t\t\t}\n\t\t\tcurrent_date = next_date;\n\t\t}\n\n\t\treturn [data_group, month_change];\n\t}\n\n\trender_month_labels() {\n\t\t// this.first_month_label = 1;\n\t\t// if (this.first_week_start.getDate() > 8) {\n\t\t// \tthis.first_month_label = 0;\n\t\t// }\n\t\t// this.last_month_label = 1;\n\n\t\t// let first_month = this.months.shift();\n\t\t// let first_month_start = this.month_start_points.shift();\n\t\t// render first month if\n\n\t\t// let last_month = this.months.pop();\n\t\t// let last_month_start = this.month_start_points.pop();\n\t\t// render last month if\n\n\t\tthis.months.shift();\n\t\tthis.month_start_points.shift();\n\t\tthis.months.pop();\n\t\tthis.month_start_points.pop();\n\n\t\tthis.month_start_points.map((start, i) => {\n\t\t\tlet month_name =  this.month_names[this.months[i]].substring(0, 3);\n\t\t\tlet text = makeText('y-value-text', start+12, 10, month_name);\n\t\t\tthis.domain_label_group.appendChild(text);\n\t\t});\n\t}\n\n\tmake_graph_components() {\n\t\tArray.prototype.slice.call(\n\t\t\tthis.container.querySelectorAll('.graph-stats-container, .sub-title, .title')\n\t\t).map(d => {\n\t\t\td.style.display = 'None';\n\t\t});\n\t\tthis.chart_wrapper.style.marginTop = '0px';\n\t\tthis.chart_wrapper.style.paddingTop = '0px';\n\t}\n\n\tbind_tooltip() {\n\t\tArray.prototype.slice.call(\n\t\t\tdocument.querySelectorAll(\".data-group .day\")\n\t\t).map(el => {\n\t\t\tel.addEventListener('mouseenter', (e) => {\n\t\t\t\tlet count = e.target.getAttribute('data-value');\n\t\t\t\tlet date_parts = e.target.getAttribute('data-date').split('-');\n\n\t\t\t\tlet month = this.month_names[parseInt(date_parts[1])-1].substring(0, 3);\n\n\t\t\t\tlet g_off = this.chart_wrapper.getBoundingClientRect(), p_off = e.target.getBoundingClientRect();\n\n\t\t\t\tlet width = parseInt(e.target.getAttribute('width'));\n\t\t\t\tlet x = p_off.left - g_off.left + (width+2)/2;\n\t\t\t\tlet y = p_off.top - g_off.top - (width+2)/2;\n\t\t\t\tlet value = count + ' ' + this.count_label;\n\t\t\t\tlet name = ' on ' + month + ' ' + date_parts[0] + ', ' + date_parts[2];\n\n\t\t\t\tthis.tip.set_values(x, y, name, value, [], 1);\n\t\t\t\tthis.tip.show_tip();\n\t\t\t});\n\t\t});\n\t}\n\n\tupdate(data) {\n\t\tthis.data = data;\n\t\tthis.setup_values();\n\t\tthis.bind_tooltip();\n\t}\n}\n","import React from \"react\"\n// import Chart from \"frappe-charts/dist/frappe-charts.min.esm\"\nimport Chart from 'app/lib/chart/js/charts'\n\nclass Comp extends React.Component {\n  constructor(props) {\n    super(props);\n    const {caption, fields, data, colors} = props;\n\n\n    const polished = data.reduce((p, v) => {\n\n      p.labels.push(v.date);\n      fields.forEach(({prop, propTitle, propFormat}) => {\n        const values = p.datasets[propTitle] = p.datasets[propTitle] || [];\n        values.push(propFormat(v[prop]));\n      });\n      return p;\n\n    }, {labels: [], datasets: {}});\n\n    this.state = {\n      title: caption,\n      colors,\n      data: {\n\n        labels: polished.labels,\n\n        datasets: Object.entries(polished.datasets).reduce((p, [title, values]) => {\n          p.push({\n            title,\n            values\n          });\n          return p;\n        }, [])\n      }\n    };\n  }\n\n  componentDidMount() {\n    this._chart = new Chart({\n      parent: this.$chart, // or a DOM element\n      ...this.state,\n      type: 'bar',\n      height: 250,\n\n      format_tooltip_x: d => (d + '').toUpperCase(),\n      format_tooltip_y: d => d + ''\n    });\n  }\n\n  componentWillUnmount() {\n    this._chart.destroy();\n  }\n\n\n  render() {\n    return <div ref={el => this.$chart = el}>\n\n    </div>\n  }\n}\n\n\nexport default Comp\n"],"sourceRoot":""}